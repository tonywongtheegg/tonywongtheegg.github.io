(function(){var ai=this,ac=ai._,ae={},ar=Array.prototype,ab=Object.prototype,an=Function.prototype,aw=ar.push,ah=ar.slice,au=ar.concat,ak=ab.toString,aq=ab.hasOwnProperty,ad=ar.forEach,ag=ar.map,ao=ar.reduce,aa=ar.reduceRight,at=ar.filter,ap=ar.every,aj=ar.some,X=ar.indexOf,av=ar.lastIndexOf,Y=Array.isArray,ax=Object.keys,am=an.bind,Z=function(a){return a instanceof Z?a:this instanceof Z?(this._wrapped=a,void 0):new Z(a);};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=Z),exports._=Z):ai._=Z,Z.VERSION="1.4.4";var W=Z.each=Z.forEach=function(h,f,g){if(null!=h){if(ad&&h.forEach===ad){h.forEach(f,g);}else{if(h.length===+h.length){for(var c=0,d=h.length;d>c;c++){if(f.call(g,h[c],c,h)===ae){return;}}}else{for(var b in h){if(Z.has(h,b)&&f.call(g,h[b],b,h)===ae){return;}}}}}};Z.map=Z.collect=function(d,a,b){var c=[];return null==d?c:ag&&d.map===ag?d.map(a,b):(W(d,function(g,e,f){c[c.length]=a.call(b,g,e,f);}),c);};var H="Reduce of empty array with no initial value";Z.reduce=Z.foldl=Z.inject=function(f,b,c,d){var a=arguments.length>2;if(null==f&&(f=[]),ao&&f.reduce===ao){return d&&(b=Z.bind(b,d)),a?f.reduce(b,c):f.reduce(b);}if(W(f,function(h,g,e){a?c=b.call(d,c,h,g,e):(c=h,a=!0);}),!a){throw new TypeError(H);}return c;},Z.reduceRight=Z.foldr=function(j,f,g,h){var c=arguments.length>2;if(null==j&&(j=[]),aa&&j.reduceRight===aa){return h&&(f=Z.bind(f,h)),c?j.reduceRight(f,g):j.reduceRight(f);}var d=j.length;if(d!==+d){var b=Z.keys(j);d=b.length;}if(W(j,function(e,i,a){i=b?b[--d]:--d,c?g=f.call(h,g,j[i],i,a):(g=j[i],c=!0);}),!c){throw new TypeError(H);}return g;},Z.find=Z.detect=function(d,a,b){var c;return Q(d,function(g,e,f){return a.call(b,g,e,f)?(c=g,!0):void 0;}),c;},Z.filter=Z.select=function(d,a,b){var c=[];return null==d?c:at&&d.filter===at?d.filter(a,b):(W(d,function(g,e,f){a.call(b,g,e,f)&&(c[c.length]=g);}),c);},Z.reject=function(c,a,b){return Z.filter(c,function(g,f,d){return !a.call(b,g,f,d);},b);},Z.every=Z.all=function(d,b,c){b||(b=Z.identity);var a=!0;return null==d?a:ap&&d.every===ap?d.every(b,c):(W(d,function(g,f,e){return(a=a&&b.call(c,g,f,e))?void 0:ae;}),!!a);};var Q=Z.some=Z.any=function(d,b,c){b||(b=Z.identity);var a=!1;return null==d?a:aj&&d.some===aj?d.some(b,c):(W(d,function(g,f,e){return a||(a=b.call(c,g,f,e))?ae:void 0;}),!!a);};Z.contains=Z.include=function(b,a){return null==b?!1:X&&b.indexOf===X?b.indexOf(a)!=-1:Q(b,function(c){return c===a;});},Z.invoke=function(d,a){var b=ah.call(arguments,2),c=Z.isFunction(a);return Z.map(d,function(e){return(c?a:e[a]).apply(e,b);});},Z.pluck=function(b,a){return Z.map(b,function(c){return c[a];});},Z.where=function(c,a,b){return Z.isEmpty(a)?b?null:[]:Z[b?"find":"filter"](c,function(e){for(var d in a){if(a[d]!==e[d]){return !1;}}return !0;});},Z.findWhere=function(b,a){return Z.where(b,a,!0);},Z.max=function(d,a,b){if(!a&&Z.isArray(d)&&d[0]===+d[0]&&65535>d.length){return Math.max.apply(Math,d);}if(!a&&Z.isEmpty(d)){return -1/0;}var c={computed:-1/0,value:-1/0};return W(d,function(h,f,g){var e=a?a.call(b,h,f,g):h;e>=c.computed&&(c={value:h,computed:e});}),c.value;},Z.min=function(d,a,b){if(!a&&Z.isArray(d)&&d[0]===+d[0]&&65535>d.length){return Math.min.apply(Math,d);}if(!a&&Z.isEmpty(d)){return 1/0;}var c={computed:1/0,value:1/0};return W(d,function(h,f,g){var e=a?a.call(b,h,f,g):h;c.computed>e&&(c={value:h,computed:e});}),c.value;},Z.shuffle=function(d){var a,b=0,c=[];return W(d,function(e){a=Z.random(b++),c[b-1]=c[a],c[a]=e;}),c;};var al=function(a){return Z.isFunction(a)?a:function(b){return b[a];};};Z.sortBy=function(d,a,b){var c=al(a);return Z.pluck(Z.map(d,function(g,f,e){return{value:g,index:f,criteria:c.call(b,g,f,e)};}).sort(function(i,f){var g=i.criteria,h=f.criteria;if(g!==h){if(g>h||g===void 0){return 1;}if(h>g||h===void 0){return -1;}}return i.index<f.index?-1:1;}),"value");};var P=function(g,c,d,f){var a={},b=al(c||Z.identity);return W(g,function(h,e){var i=b.call(d,h,e,g);f(a,i,h);}),a;};Z.groupBy=function(c,a,b){return P(c,a,b,function(f,d,e){(Z.has(f,d)?f[d]:f[d]=[]).push(e);});},Z.countBy=function(c,a,b){return P(c,a,b,function(e,d){Z.has(e,d)||(e[d]=0),e[d]++;});},Z.sortedIndex=function(k,f,g,h){g=null==g?Z.identity:al(g);for(var c=g.call(h,f),d=0,b=k.length;b>d;){var j=d+b>>>1;c>g.call(h,k[j])?d=j+1:b=j;}return d;},Z.toArray=function(a){return a?Z.isArray(a)?ah.call(a):a.length===+a.length?Z.map(a,Z.identity):Z.values(a):[];},Z.size=function(a){return null==a?0:a.length===+a.length?a.length:Z.keys(a).length;},Z.first=Z.head=Z.take=function(c,a,b){return null==c?void 0:null==a||b?c[0]:ah.call(c,0,a);},Z.initial=function(c,a,b){return ah.call(c,0,c.length-(null==a||b?1:a));},Z.last=function(c,a,b){return null==c?void 0:null==a||b?c[c.length-1]:ah.call(c,Math.max(c.length-a,0));},Z.rest=Z.tail=Z.drop=function(c,a,b){return ah.call(c,null==a||b?1:a);},Z.compact=function(a){return Z.filter(a,Z.identity);};var G=function(c,a,b){return W(c,function(d){Z.isArray(d)?a?aw.apply(b,d):G(d,a,b):b.push(d);}),b;};Z.flatten=function(b,a){return G(b,a,[]);},Z.without=function(a){return Z.difference(a,ah.call(arguments,1));},Z.uniq=Z.unique=function(j,f,g,h){Z.isFunction(f)&&(h=g,g=f,f=!1);var c=g?Z.map(j,g,h):j,d=[],b=[];return W(c,function(a,i){(f?i&&b[b.length-1]===a:Z.contains(b,a))||(b.push(a),d.push(j[i]));}),d;},Z.union=function(){return Z.uniq(au.apply(ar,arguments));},Z.intersection=function(b){var a=ah.call(arguments,1);return Z.filter(Z.uniq(b),function(c){return Z.every(a,function(d){return Z.indexOf(d,c)>=0;});});},Z.difference=function(b){var a=au.apply(ar,ah.call(arguments,1));return Z.filter(b,function(c){return !Z.contains(a,c);});},Z.zip=function(){for(var d=ah.call(arguments),a=Z.max(Z.pluck(d,"length")),b=Array(a),c=0;a>c;c++){b[c]=Z.pluck(d,""+c);}return b;},Z.object=function(f,b){if(null==f){return{};}for(var c={},d=0,a=f.length;a>d;d++){b?c[f[d]]=b[d]:c[f[d][0]]=f[d][1];}return c;},Z.indexOf=function(f,b,c){if(null==f){return -1;}var d=0,a=f.length;if(c){if("number"!=typeof c){return d=Z.sortedIndex(f,b),f[d]===b?d:-1;}d=0>c?Math.max(0,a+c):c;}if(X&&f.indexOf===X){return f.indexOf(b,c);}for(;a>d;d++){if(f[d]===b){return d;}}return -1;},Z.lastIndexOf=function(f,b,c){if(null==f){return -1;}var d=null!=c;if(av&&f.lastIndexOf===av){return d?f.lastIndexOf(b,c):f.lastIndexOf(b);}for(var a=d?c:f.length;a--;){if(f[a]===b){return a;}}return -1;},Z.range=function(g,c,d){1>=arguments.length&&(c=g||0,g=0),d=arguments[2]||1;for(var f=Math.max(Math.ceil((c-g)/d),0),a=0,b=Array(f);f>a;){b[a++]=g,g+=d;}return b;},Z.bind=function(c,a){if(c.bind===am&&am){return am.apply(c,ah.call(arguments,1));}var b=ah.call(arguments,2);return function(){return c.apply(a,b.concat(ah.call(arguments)));};},Z.partial=function(b){var a=ah.call(arguments,1);return function(){return b.apply(this,a.concat(ah.call(arguments)));};},Z.bindAll=function(b){var a=ah.call(arguments,1);return 0===a.length&&(a=Z.functions(b)),W(a,function(c){b[c]=Z.bind(b[c],b);}),b;},Z.memoize=function(c,a){var b={};return a||(a=Z.identity),function(){var d=a.apply(this,arguments);return Z.has(b,d)?b[d]:b[d]=c.apply(this,arguments);};},Z.delay=function(c,a){var b=ah.call(arguments,2);return setTimeout(function(){return c.apply(null,b);},a);},Z.defer=function(a){return Z.delay.apply(Z,[a,1].concat(ah.call(arguments,1)));},Z.throttle=function(k,f){var g,h,c,d,b=0,j=function(){b=new Date,c=null,d=k.apply(g,h);};return function(){var e=new Date,a=f-(e-b);return g=this,h=arguments,0>=a?(clearTimeout(c),c=null,b=e,d=k.apply(g,h)):c||(c=setTimeout(j,a)),d;};},Z.debounce=function(f,b,c){var d,a;return function(){var g=this,e=arguments,h=function(){d=null,c||(a=f.apply(g,e));},j=c&&!d;return clearTimeout(d),d=setTimeout(h,b),j&&(a=f.apply(g,e)),a;};},Z.once=function(c){var a,b=!1;return function(){return b?a:(b=!0,a=c.apply(this,arguments),c=null,a);};},Z.wrap=function(b,a){return function(){var c=[b];return aw.apply(c,arguments),a.apply(this,c);};},Z.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;
c>=0;c--){b=[a[c].apply(this,b)];}return b[0];};},Z.after=function(b,a){return 0>=b?a():function(){return 1>--b?a.apply(this,arguments):void 0;};},Z.keys=ax||function(c){if(c!==Object(c)){throw new TypeError("Invalid object");}var a=[];for(var b in c){Z.has(c,b)&&(a[a.length]=b);}return a;},Z.values=function(c){var a=[];for(var b in c){Z.has(c,b)&&a.push(c[b]);}return a;},Z.pairs=function(c){var a=[];for(var b in c){Z.has(c,b)&&a.push([b,c[b]]);}return a;},Z.invert=function(c){var a={};for(var b in c){Z.has(c,b)&&(a[c[b]]=b);}return a;},Z.functions=Z.methods=function(c){var a=[];for(var b in c){Z.isFunction(c[b])&&a.push(b);}return a.sort();},Z.extend=function(a){return W(ah.call(arguments,1),function(b){if(b){for(var c in b){a[c]=b[c];}}}),a;},Z.pick=function(c){var a={},b=au.apply(ar,ah.call(arguments,1));return W(b,function(d){d in c&&(a[d]=c[d]);}),a;},Z.omit=function(d){var b={},c=au.apply(ar,ah.call(arguments,1));for(var a in d){Z.contains(c,a)||(b[a]=d[a]);}return b;},Z.defaults=function(a){return W(ah.call(arguments,1),function(b){if(b){for(var c in b){null==a[c]&&(a[c]=b[c]);}}}),a;},Z.clone=function(a){return Z.isObject(a)?Z.isArray(a)?a.slice():Z.extend({},a):a;},Z.tap=function(b,a){return a(b),b;};var L=function(g,q,b,k){if(g===q){return 0!==g||1/g==1/q;}if(null==g||null==q){return g===q;}g instanceof Z&&(g=g._wrapped),q instanceof Z&&(q=q._wrapped);var p=ak.call(g);if(p!=ak.call(q)){return !1;}switch(p){case"[object String]":return g==q+"";case"[object Number]":return g!=+g?q!=+q:0==g?1/g==1/q:g==+q;case"[object Date]":case"[object Boolean]":return +g==+q;case"[object RegExp]":return g.source==q.source&&g.global==q.global&&g.multiline==q.multiline&&g.ignoreCase==q.ignoreCase;}if("object"!=typeof g||"object"!=typeof q){return !1;}for(var h=b.length;h--;){if(b[h]==g){return k[h]==q;}}b.push(g),k.push(q);var m=0,d=!0;if("[object Array]"==p){if(m=g.length,d=m==q.length){for(;m--&&(d=L(g[m],q[m],b,k));){}}}else{var l=g.constructor,j=q.constructor;if(l!==j&&!(Z.isFunction(l)&&l instanceof l&&Z.isFunction(j)&&j instanceof j)){return !1;}for(var v in g){if(Z.has(g,v)&&(m++,!(d=Z.has(q,v)&&L(g[v],q[v],b,k)))){break;}}if(d){for(v in q){if(Z.has(q,v)&&!m--){break;}}d=!m;}}return b.pop(),k.pop(),d;};Z.isEqual=function(b,a){return L(b,a,[],[]);},Z.isEmpty=function(b){if(null==b){return !0;}if(Z.isArray(b)||Z.isString(b)){return 0===b.length;}for(var a in b){if(Z.has(b,a)){return !1;}}return !0;},Z.isElement=function(a){return !(!a||1!==a.nodeType);},Z.isArray=Y||function(a){return"[object Array]"==ak.call(a);},Z.isObject=function(a){return a===Object(a);},W(["Arguments","Function","String","Number","Date","RegExp"],function(a){Z["is"+a]=function(b){return ak.call(b)=="[object "+a+"]";};}),Z.isArguments(arguments)||(Z.isArguments=function(a){return !(!a||!Z.has(a,"callee"));}),"function"!=typeof/./&&(Z.isFunction=function(a){return"function"==typeof a;}),Z.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a));},Z.isNaN=function(a){return Z.isNumber(a)&&a!=+a;},Z.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==ak.call(a);},Z.isNull=function(a){return null===a;},Z.isUndefined=function(a){return a===void 0;},Z.has=function(b,a){return aq.call(b,a);},Z.noConflict=function(){return ai._=ac,this;},Z.identity=function(a){return a;},Z.times=function(f,b,c){for(var d=Array(f),a=0;f>a;a++){d[a]=b.call(c,a);}return d;},Z.random=function(b,a){return null==a&&(a=b,b=0),b+Math.floor(Math.random()*(a-b+1));};var K={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};K.unescape=Z.invert(K.escape);var C={escape:RegExp("["+Z.keys(K.escape).join("")+"]","g"),unescape:RegExp("("+Z.keys(K.unescape).join("|")+")","g")};Z.each(["escape","unescape"],function(a){Z[a]=function(b){return null==b?"":(""+b).replace(C[a],function(c){return K[a][c];});};}),Z.result=function(c,a){if(null==c){return null;}var b=c[a];return Z.isFunction(b)?b.call(c):b;},Z.mixin=function(a){W(Z.functions(a),function(b){var c=Z[b]=a[b];Z.prototype[b]=function(){var d=[this._wrapped];return aw.apply(d,arguments),U.call(this,c.apply(Z,d));};});};var J=0;Z.uniqueId=function(b){var a=++J+"";return b?b+a:a;},Z.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var z=/(.)^/,af={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},V=/\\|'|\r|\n|\t|\u2028|\u2029/g;Z.template=function(f,m,b){var h;b=Z.defaults({},b,Z.templateSettings);var l=RegExp([(b.escape||z).source,(b.interpolate||z).source,(b.evaluate||z).source].join("|")+"|$","g"),g=0,k="__p+='";f.replace(l,function(c,i,n,a,p){return k+=f.slice(g,p).replace(V,function(e){return"\\"+af[e];}),i&&(k+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(k+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),a&&(k+="';\n"+a+"\n__p+='"),g=p+c.length,c;}),k+="';\n",b.variable||(k="with(obj||{}){\n"+k+"}\n"),k="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+k+"return __p;\n";try{h=Function(b.variable||"obj","_",k);}catch(d){throw d.source=k,d;}if(m){return h(m,Z);}var j=function(a){return h.call(this,a,Z);};return j.source="function("+(b.variable||"obj")+"){\n"+k+"}",j;},Z.chain=function(a){return Z(a).chain();};var U=function(a){return this._chain?Z(a).chain():a;};Z.mixin(Z),W(["pop","push","reverse","shift","sort","splice","unshift"],function(b){var a=ar[b];Z.prototype[b]=function(){var c=this._wrapped;return a.apply(c,arguments),"shift"!=b&&"splice"!=b||0!==c.length||delete c[0],U.call(this,c);};}),W(["concat","join","slice"],function(b){var a=ar[b];Z.prototype[b]=function(){return U.call(this,a.apply(this._wrapped,arguments));};}),Z.extend(Z.prototype,{chain:function(){return this._chain=!0,this;},value:function(){return this._wrapped;}});}).call(this);(function(a,b){if(typeof exports!=="undefined"){var c=require("underscore");b(a,exports,c);}else{a.Backbone=b(a,{},a._,(a.jQuery||a.Zepto||a.ender||a.$));}}(this,function(v,B,N,z){var D=v.Backbone;var g=[];var F=g.push;var o=g.slice;var u=g.splice;B.VERSION="1.1.2";B.$=z;B.noConflict=function(){v.Backbone=D;return this;};B.emulateHTTP=false;B.emulateJSON=false;var L=B.Events={on:function(O,R,Q){if(!y(this,"on",O,[R,Q])||!R){return this;}this._events||(this._events={});var P=this._events[O]||(this._events[O]=[]);P.push({callback:R,context:Q,ctx:Q||this});return this;},once:function(P,S,Q){if(!y(this,"once",P,[S,Q])||!S){return this;}var O=this;var R=N.once(function(){O.off(P,R);S.apply(this,arguments);});R._callback=S;return this.on(P,R,Q);},off:function(O,X,P){var V,W,Y,U,T,Q,S,R;if(!this._events||!y(this,"off",O,[X,P])){return this;}if(!O&&!X&&!P){this._events=void 0;return this;}U=O?[O]:N.keys(this._events);for(T=0,Q=U.length;T<Q;T++){O=U[T];if(Y=this._events[O]){this._events[O]=V=[];if(X||P){for(S=0,R=Y.length;S<R;S++){W=Y[S];if((X&&X!==W.callback&&X!==W.callback._callback)||(P&&P!==W.context)){V.push(W);}}}if(!V.length){delete this._events[O];}}}return this;},trigger:function(Q){if(!this._events){return this;}var P=o.call(arguments,1);if(!y(this,"trigger",Q,P)){return this;}var R=this._events[Q];var O=this._events.all;if(R){b(R,P);}if(O){b(O,arguments);}return this;},stopListening:function(R,P,T){var Q=this._listeningTo;if(!Q){return this;}var O=!P&&!T;if(!T&&typeof P==="object"){T=this;}if(R){(Q={})[R._listenId]=R;}for(var S in Q){R=Q[S];R.off(P,T,this);if(O||N.isEmpty(R._events)){delete this._listeningTo[S];}}return this;}};var x=/\s+/;var y=function(V,T,P,S){if(!P){return true;}if(typeof P==="object"){for(var R in P){V[T].apply(V,[R,P[R]].concat(S));}return false;}if(x.test(P)){var U=P.split(x);for(var Q=0,O=U.length;Q<O;Q++){V[T].apply(V,[U[Q]].concat(S));}return false;}return true;};var b=function(T,R){var U,S=-1,Q=T.length,P=R[0],O=R[1],V=R[2];switch(R.length){case 0:while(++S<Q){(U=T[S]).callback.call(U.ctx);}return;case 1:while(++S<Q){(U=T[S]).callback.call(U.ctx,P);}return;case 2:while(++S<Q){(U=T[S]).callback.call(U.ctx,P,O);}return;
case 3:while(++S<Q){(U=T[S]).callback.call(U.ctx,P,O,V);}return;default:while(++S<Q){(U=T[S]).callback.apply(U.ctx,R);}return;}};var E={listenTo:"on",listenToOnce:"once"};N.each(E,function(O,P){L[P]=function(S,Q,U){var R=this._listeningTo||(this._listeningTo={});var T=S._listenId||(S._listenId=N.uniqueId("l"));R[T]=S;if(!U&&typeof Q==="object"){U=this;}S[O](Q,U,this);return this;};});L.bind=L.on;L.unbind=L.off;N.extend(B,L);var G=B.Model=function(O,Q){var P=O||{};Q||(Q={});this.cid=N.uniqueId("c");this.attributes={};if(Q.collection){this.collection=Q.collection;}if(Q.parse){P=this.parse(P,Q)||{};}P=N.defaults({},P,N.result(this,"defaults"));this.set(P,Q);this.changed={};this.initialize.apply(this,arguments);};N.extend(G.prototype,L,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(O){return N.clone(this.attributes);},sync:function(){return B.sync.apply(this,arguments);},get:function(O){return this.attributes[O];},escape:function(O){return N.escape(this.get(O));},has:function(O){return this.get(O)!=null;},set:function(W,O,aa){var U,X,Y,V,T,Z,Q,S;if(W==null){return this;}if(typeof W==="object"){X=W;aa=O;}else{(X={})[W]=O;}aa||(aa={});if(!this._validate(X,aa)){return false;}Y=aa.unset;T=aa.silent;V=[];Z=this._changing;this._changing=true;if(!Z){this._previousAttributes=N.clone(this.attributes);this.changed={};}S=this.attributes,Q=this._previousAttributes;if(this.idAttribute in X){this.id=X[this.idAttribute];}for(U in X){O=X[U];if(!N.isEqual(S[U],O)){V.push(U);}if(!N.isEqual(Q[U],O)){this.changed[U]=O;}else{delete this.changed[U];}Y?delete S[U]:S[U]=O;}if(!T){if(V.length){this._pending=aa;}for(var R=0,P=V.length;R<P;R++){this.trigger("change:"+V[R],this,S[V[R]],aa);}}if(Z){return this;}if(!T){while(this._pending){aa=this._pending;this._pending=false;this.trigger("change",this,aa);}}this._pending=false;this._changing=false;return this;},unset:function(O,P){return this.set(O,void 0,N.extend({},P,{unset:true}));},clear:function(P){var O={};for(var Q in this.attributes){O[Q]=void 0;}return this.set(O,N.extend({},P,{unset:true}));},hasChanged:function(O){if(O==null){return !N.isEmpty(this.changed);}return N.has(this.changed,O);},changedAttributes:function(Q){if(!Q){return this.hasChanged()?N.clone(this.changed):false;}var S,R=false;var P=this._changing?this._previousAttributes:this.attributes;for(var O in Q){if(N.isEqual(P[O],(S=Q[O]))){continue;}(R||(R={}))[O]=S;}return R;},previous:function(O){if(O==null||!this._previousAttributes){return null;}return this._previousAttributes[O];},previousAttributes:function(){return N.clone(this._previousAttributes);},fetch:function(P){P=P?N.clone(P):{};if(P.parse===void 0){P.parse=true;}var O=this;var Q=P.success;P.success=function(R){if(!O.set(O.parse(R,P),P)){return false;}if(Q){Q(O,R,P);}O.trigger("sync",O,R,P);};J(this,P);return this.sync("read",this,P);},save:function(S,P,W){var T,O,V,Q=this.attributes;if(S==null||typeof S==="object"){T=S;W=P;}else{(T={})[S]=P;}W=N.extend({validate:true},W);if(T&&!W.wait){if(!this.set(T,W)){return false;}}else{if(!this._validate(T,W)){return false;}}if(T&&W.wait){this.attributes=N.extend({},Q,T);}if(W.parse===void 0){W.parse=true;}var R=this;var U=W.success;W.success=function(Y){R.attributes=Q;var X=R.parse(Y,W);if(W.wait){X=N.extend(T||{},X);}if(N.isObject(X)&&!R.set(X,W)){return false;}if(U){U(R,Y,W);}R.trigger("sync",R,Y,W);};J(this,W);O=this.isNew()?"create":(W.patch?"patch":"update");if(O==="patch"){W.attrs=T;}V=this.sync(O,this,W);if(T&&W.wait){this.attributes=Q;}return V;},destroy:function(P){P=P?N.clone(P):{};var O=this;var S=P.success;var Q=function(){O.trigger("destroy",O,O.collection,P);};P.success=function(T){if(P.wait||O.isNew()){Q();}if(S){S(O,T,P);}if(!O.isNew()){O.trigger("sync",O,T,P);}};if(this.isNew()){P.success();return false;}J(this,P);var R=this.sync("delete",this,P);if(!P.wait){Q();}return R;},url:function(){var O=N.result(this,"urlRoot")||N.result(this.collection,"url")||s();if(this.isNew()){return O;}return O.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id);},parse:function(P,O){return P;},clone:function(){return new this.constructor(this.attributes);},isNew:function(){return !this.has(this.idAttribute);},isValid:function(O){return this._validate({},N.extend(O||{},{validate:true}));},_validate:function(Q,P){if(!P.validate||!this.validate){return true;}Q=N.extend({},this.attributes,Q);var O=this.validationError=this.validate(Q,P)||null;if(!O){return true;}this.trigger("invalid",this,O,N.extend(P,{validationError:O}));return false;}});var a=["keys","values","pairs","invert","pick","omit"];N.each(a,function(O){G.prototype[O]=function(){var P=o.call(arguments);P.unshift(this.attributes);return N[O].apply(N,P);};});var c=B.Collection=function(P,O){O||(O={});if(O.model){this.model=O.model;}if(O.comparator!==void 0){this.comparator=O.comparator;}this._reset();this.initialize.apply(this,arguments);if(P){this.reset(P,N.extend({silent:true},O));}};var p={add:true,remove:true,merge:true};var M={add:true,remove:false};N.extend(c.prototype,L,{model:G,initialize:function(){},toJSON:function(O){return this.map(function(P){return P.toJSON(O);});},sync:function(){return B.sync.apply(this,arguments);},add:function(P,O){return this.set(P,N.extend({merge:false},O,M));},remove:function(U,R){var T=!N.isArray(U);U=T?[U]:N.clone(U);R||(R={});var S,O,Q,P;for(S=0,O=U.length;S<O;S++){P=U[S]=this.get(U[S]);if(!P){continue;}delete this._byId[P.id];delete this._byId[P.cid];Q=this.indexOf(P);this.models.splice(Q,1);this.length--;if(!R.silent){R.index=Q;P.trigger("remove",P,this,R);}this._removeReference(P,R);}return T?U[0]:U;},set:function(ah,P){P=N.defaults({},P,p);if(P.parse){ah=this.parse(ah,P);}var S=!N.isArray(ah);ah=S?(ah?[ah]:[]):N.clone(ah);var ad,ab,X,Q,Z,W,ag;var U=P.at;var af=this.model;var O=this.comparator&&(U==null)&&P.sort!==false;var ae=N.isString(this.comparator)?this.comparator:null;var aj=[],aa=[],Y={};var V=P.add,R=P.merge,ai=P.remove;var ac=!O&&V&&ai?[]:false;for(ad=0,ab=ah.length;ad<ab;ad++){Z=ah[ad]||{};if(Z instanceof G){X=Q=Z;}else{X=Z[af.prototype.idAttribute||"id"];}if(W=this.get(X)){if(ai){Y[W.cid]=true;}if(R){Z=Z===Q?Q.attributes:Z;if(P.parse){Z=W.parse(Z,P);}W.set(Z,P);if(O&&!ag&&W.hasChanged(ae)){ag=true;}}ah[ad]=W;}else{if(V){Q=ah[ad]=this._prepareModel(Z,P);if(!Q){continue;}aj.push(Q);this._addReference(Q,P);}}Q=W||Q;if(ac&&(Q.isNew()||!Y[Q.id])){ac.push(Q);}Y[Q.id]=true;}if(ai){for(ad=0,ab=this.length;ad<ab;++ad){if(!Y[(Q=this.models[ad]).cid]){aa.push(Q);}}if(aa.length){this.remove(aa,P);}}if(aj.length||(ac&&ac.length)){if(O){ag=true;}this.length+=aj.length;if(U!=null){for(ad=0,ab=aj.length;ad<ab;ad++){this.models.splice(U+ad,0,aj[ad]);}}else{if(ac){this.models.length=0;}var T=ac||aj;for(ad=0,ab=T.length;ad<ab;ad++){this.models.push(T[ad]);}}}if(ag){this.sort({silent:true});}if(!P.silent){for(ad=0,ab=aj.length;ad<ab;ad++){(Q=aj[ad]).trigger("add",Q,this,P);}if(ag||(ac&&ac.length)){this.trigger("sort",this,P);}}return S?ah[0]:ah;},reset:function(R,P){P||(P={});for(var Q=0,O=this.models.length;Q<O;Q++){this._removeReference(this.models[Q],P);}P.previousModels=this.models;this._reset();R=this.add(R,N.extend({silent:true},P));if(!P.silent){this.trigger("reset",this,P);}return R;},push:function(P,O){return this.add(P,N.extend({at:this.length},O));},pop:function(P){var O=this.at(this.length-1);this.remove(O,P);return O;},unshift:function(P,O){return this.add(P,N.extend({at:0},O));},shift:function(P){var O=this.at(0);this.remove(O,P);return O;},slice:function(){return o.apply(this.models,arguments);},get:function(O){if(O==null){return void 0;}return this._byId[O]||this._byId[O.id]||this._byId[O.cid];},at:function(O){return this.models[O];},where:function(O,P){if(N.isEmpty(O)){return P?void 0:[];}return this[P?"find":"filter"](function(Q){for(var R in O){if(O[R]!==Q.get(R)){return false;}}return true;});},findWhere:function(O){return this.where(O,true);},sort:function(O){if(!this.comparator){throw new Error("Cannot sort a set without a comparator");
}O||(O={});if(N.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this);}else{this.models.sort(N.bind(this.comparator,this));}if(!O.silent){this.trigger("sort",this,O);}return this;},pluck:function(O){return N.invoke(this.models,"get",O);},fetch:function(O){O=O?N.clone(O):{};if(O.parse===void 0){O.parse=true;}var Q=O.success;var P=this;O.success=function(R){var S=O.reset?"reset":"set";P[S](R,O);if(Q){Q(P,R,O);}P.trigger("sync",P,R,O);};J(this,O);return this.sync("read",this,O);},create:function(P,O){O=O?N.clone(O):{};if(!(P=this._prepareModel(P,O))){return false;}if(!O.wait){this.add(P,O);}var R=this;var Q=O.success;O.success=function(S,T){if(O.wait){R.add(S,O);}if(Q){Q(S,T,O);}};P.save(null,O);return P;},parse:function(P,O){return P;},clone:function(){return new this.constructor(this.models);},_reset:function(){this.length=0;this.models=[];this._byId={};},_prepareModel:function(Q,P){if(Q instanceof G){return Q;}P=P?N.clone(P):{};P.collection=this;var O=new this.model(Q,P);if(!O.validationError){return O;}this.trigger("invalid",this,O.validationError,P);return false;},_addReference:function(P,O){this._byId[P.cid]=P;if(P.id!=null){this._byId[P.id]=P;}if(!P.collection){P.collection=this;}P.on("all",this._onModelEvent,this);},_removeReference:function(P,O){if(this===P.collection){delete P.collection;}P.off("all",this._onModelEvent,this);},_onModelEvent:function(Q,P,R,O){if((Q==="add"||Q==="remove")&&R!==this){return;}if(Q==="destroy"){this.remove(P,O);}if(P&&Q==="change:"+P.idAttribute){delete this._byId[P.previous(P.idAttribute)];if(P.id!=null){this._byId[P.id]=P;}}this.trigger.apply(this,arguments);}});var A=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];N.each(A,function(O){c.prototype[O]=function(){var P=o.call(arguments);P.unshift(this.models);return N[O].apply(N,P);};});var l=["groupBy","countBy","sortBy","indexBy"];N.each(l,function(O){c.prototype[O]=function(R,P){var Q=N.isFunction(R)?R:function(S){return S.get(R);};return N[O](this.models,Q,P);};});var I=B.View=function(O){this.cid=N.uniqueId("view");O||(O={});N.extend(this,N.pick(O,e));this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents();};var w=/^(\S+)\s*(.*)$/;var e=["model","collection","el","id","attributes","className","tagName","events"];N.extend(I.prototype,L,{tagName:"div",$:function(O){return this.$el.find(O);},initialize:function(){},render:function(){return this;},remove:function(){this.$el.remove();this.stopListening();return this;},setElement:function(O,P){if(this.$el){this.undelegateEvents();}this.$el=O instanceof B.$?O:B.$(O);this.el=this.$el[0];if(P!==false){this.delegateEvents();}return this;},delegateEvents:function(S){if(!(S||(S=N.result(this,"events")))){return this;}this.undelegateEvents();for(var R in S){var T=S[R];if(!N.isFunction(T)){T=this[S[R]];}if(!T){continue;}var Q=R.match(w);var P=Q[1],O=Q[2];T=N.bind(T,this);P+=".delegateEvents"+this.cid;if(O===""){this.$el.on(P,T);}else{this.$el.on(P,O,T);}}return this;},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid);return this;},_ensureElement:function(){if(!this.el){var O=N.extend({},N.result(this,"attributes"));if(this.id){O.id=N.result(this,"id");}if(this.className){O["class"]=N.result(this,"className");}var P=B.$("<"+N.result(this,"tagName")+">").attr(O);this.setElement(P,false);}else{this.setElement(N.result(this,"el"),false);}}});B.sync=function(U,P,O){var R=k[U];N.defaults(O||(O={}),{emulateHTTP:B.emulateHTTP,emulateJSON:B.emulateJSON});var T={type:R,dataType:"json"};if(!O.url){T.url=N.result(P,"url")||s();}if(O.data==null&&P&&(U==="create"||U==="update"||U==="patch")){T.contentType="application/json";T.data=JSON.stringify(O.attrs||P.toJSON(O));}if(O.emulateJSON){T.contentType="application/x-www-form-urlencoded";T.data=T.data?{model:T.data}:{};}if(O.emulateHTTP&&(R==="PUT"||R==="DELETE"||R==="PATCH")){T.type="POST";if(O.emulateJSON){T.data._method=R;}var Q=O.beforeSend;O.beforeSend=function(V){V.setRequestHeader("X-HTTP-Method-Override",R);if(Q){return Q.apply(this,arguments);}};}if(T.type!=="GET"&&!O.emulateJSON){T.processData=false;}if(T.type==="PATCH"&&j){T.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP");};}var S=O.xhr=B.ajax(N.extend(T,O));P.trigger("request",P,S,O);return S;};var j=typeof window!=="undefined"&&!!window.ActiveXObject&&!(window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent);var k={"create":"POST","update":"PUT","patch":"PATCH","delete":"DELETE","read":"GET"};B.ajax=function(){return B.$.ajax.apply(B.$,arguments);};var q=B.Router=function(O){O||(O={});if(O.routes){this.routes=O.routes;}this._bindRoutes();this.initialize.apply(this,arguments);};var r=/\((.*?)\)/g;var t=/(\(\?)?:\w+/g;var d=/\*\w+/g;var h=/[\-{}\[\]+?.,\\\^$|#\s]/g;N.extend(q.prototype,L,{initialize:function(){},route:function(P,Q,R){if(!N.isRegExp(P)){P=this._routeToRegExp(P);}if(N.isFunction(Q)){R=Q;Q="";}if(!R){R=this[Q];}var O=this;B.history.route(P,function(T){var S=O._extractParameters(P,T);O.execute(R,S);O.trigger.apply(O,["route:"+Q].concat(S));O.trigger("route",Q,S);B.history.trigger("route",O,Q,S);});return this;},execute:function(P,O){if(P){P.apply(this,O);}},navigate:function(P,O){B.history.navigate(P,O);return this;},_bindRoutes:function(){if(!this.routes){return;}this.routes=N.result(this,"routes");var P,O=N.keys(this.routes);while((P=O.pop())!=null){this.route(P,this.routes[P]);}},_routeToRegExp:function(O){O=O.replace(h,"\\$&").replace(r,"(?:$1)?").replace(t,function(Q,P){return P?Q:"([^/?]+)";}).replace(d,"([^?]*?)");return new RegExp("^"+O+"(?:\\?([\\s\\S]*))?$");},_extractParameters:function(O,P){var Q=O.exec(P).slice(1);return N.map(Q,function(S,R){if(R===Q.length-1){return S||null;}return S?decodeURIComponent(S):null;});}});var i=B.History=function(){this.handlers=[];N.bindAll(this,"checkUrl");if(typeof window!=="undefined"){this.location=window.location;this.history=window.history;}};var C=/^[#\/]|\s+$/g;var f=/^\/+|\/+$/g;var K=/msie [\w.]+/;var n=/\/$/;var H=/#.*$/;i.started=false;N.extend(i.prototype,L,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root;},getHash:function(P){var O=(P||this).location.href.match(/#(.*)$/);return O?O[1]:"";},getFragment:function(Q,P){if(Q==null){if(this._hasPushState||!this._wantsHashChange||P){Q=decodeURI(this.location.pathname+this.location.search);var O=this.root.replace(n,"");if(!Q.indexOf(O)){Q=Q.slice(O.length);}}else{Q=this.getHash();}}return Q.replace(C,"");},start:function(Q){if(i.started){throw new Error("Backbone.history has already been started");}i.started=true;this.options=N.extend({root:"/"},this.options,Q);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var P=this.getFragment();var O=document.documentMode;var R=(K.exec(navigator.userAgent.toLowerCase())&&(!O||O<=7));this.root=("/"+this.root+"/").replace(f,"/");if(R&&this._wantsHashChange){var T=B.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=T.hide().appendTo("body")[0].contentWindow;this.navigate(P);}if(this._hasPushState){B.$(window).on("popstate",this.checkUrl);}else{if(this._wantsHashChange&&("onhashchange" in window)&&!R){B.$(window).on("hashchange",this.checkUrl);}else{if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval);}}}this.fragment=P;var S=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){this.fragment=this.getFragment(null,true);this.location.replace(this.root+"#"+this.fragment);return true;
}else{if(this._hasPushState&&this.atRoot()&&S.hash){this.fragment=this.getHash().replace(C,"");this.history.replaceState({},document.title,this.root+this.fragment);}}}if(!this.options.silent){return this.loadUrl();}},stop:function(){B.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl);if(this._checkUrlInterval){clearInterval(this._checkUrlInterval);}i.started=false;},route:function(O,P){this.handlers.unshift({route:O,callback:P});},checkUrl:function(P){var O=this.getFragment();if(O===this.fragment&&this.iframe){O=this.getFragment(this.getHash(this.iframe));}if(O===this.fragment){return false;}if(this.iframe){this.navigate(O);}this.loadUrl();},loadUrl:function(O){O=this.fragment=this.getFragment(O);return N.any(this.handlers,function(P){if(P.route.test(O)){P.callback(O);return true;}});},navigate:function(Q,P){if(!i.started){return false;}if(!P||P===true){P={trigger:!!P};}var O=this.root+(Q=this.getFragment(Q||""));Q=Q.replace(H,"");if(this.fragment===Q){return;}this.fragment=Q;if(Q===""&&O!=="/"){O=O.slice(0,-1);}if(this._hasPushState){this.history[P.replace?"replaceState":"pushState"]({},document.title,O);}else{if(this._wantsHashChange){this._updateHash(this.location,Q,P.replace);if(this.iframe&&(Q!==this.getFragment(this.getHash(this.iframe)))){if(!P.replace){this.iframe.document.open().close();}this._updateHash(this.iframe.location,Q,P.replace);}}else{return this.location.assign(O);}}if(P.trigger){return this.loadUrl(Q);}},_updateHash:function(O,Q,R){if(R){var P=O.href.replace(/(javascript:|#).*$/,"");O.replace(P+"#"+Q);}else{O.hash="#"+Q;}}});B.history=new i;var m=function(O,Q){var P=this;var S;if(O&&N.has(O,"constructor")){S=O.constructor;}else{S=function(){return P.apply(this,arguments);};}N.extend(S,P,Q);var R=function(){this.constructor=S;};R.prototype=P.prototype;S.prototype=new R;if(O){N.extend(S.prototype,O);}S.__super__=P.prototype;return S;};G.extend=c.extend=q.extend=I.extend=i.extend=m;var s=function(){throw new Error('A "url" property or function must be specified');};var J=function(Q,P){var O=P.error;P.error=function(R){if(O){O(Q,R,P);}Q.trigger("error",Q,R,P);};};return B;}));define("coupon-campaign-status",["jquery"],function(a){var b=(function(){var e=[],h=[],d=[],c="https://campaign-tracker.us-west-2.prod.expedia.com/coupons/getMultiple?ids=",g=function(i){var j=i.els;a.each(j,function(m,n){var l=new CouponsConstructor({el:n}),o=a(n).data("couponcampaignid");if(o>0){e.push(o);h.push(l);}});if(e.length>0){var k=e.join();c=c+k;f().then(function(){var m,l;if(d.length>0){for(m=0;m<h.length;m++){for(l=0;l<d.length;l++){if(h[m].campaignId==d[l].campaignId){h[m].status=d[l].status;h[m].url=d[l].url;}}h[m].renderMsg();}}});}},f=function(){var j=this,i=a.Deferred();a.ajax({url:c,dataType:"json",success:function(k){d=a.map(k,function(l){return{campaignId:l.CampaignId.toString(),status:l.campaign_json.CT_status,url:l.campaign_json.information_url};});i.resolve();}});return i.promise();};CouponsConstructor=function(i){this.el=i.el;this.couponCode=a(i.el).attr("data-couponcode");this.campaignId=a(i.el).attr("data-couponcampaignid");this.module=a(i.el).attr("data-module");this.termsEl=a(i.el).next();};CouponsConstructor.prototype.renderMsg=function(){var i=this,j;if(i.module==="hero"&&typeof i.status!="undefined"){j=heroCouponStatusMsgs[i.status.toLowerCase()];a(i.el).attr("data-ctstatus",i.status);if(i.status.toLowerCase()=="active"){j=j.replace("###",i.couponCode);}a(i.el).find("h1").append("<span> "+j+"</span>");}if(i.module==="deals"&&typeof i.status!="undefined"){j=dealsCouponStatusMsgs[i.status.toLowerCase()];a(i.el).attr("data-ctstatus",i.status);if(i.status.toLowerCase()=="active"){j=j.replace("###",i.couponCode);}a(i.el).append("<span> "+j+"</span>");}if(i.module==="coupons"&&typeof i.status!="undefined"){j=heroCouponStatusMsgs[i.status.toLowerCase()];a(i.el).attr("data-ctstatus",i.status);if(i.status.toLowerCase()=="active"){j=j.replace("###",i.couponCode);}a(i.el).append("<span> "+j+"</span>");a(i.termsEl).find("a").attr("href",i.url);}};return{init:g};}());return b;});(function(a,b){var c=a.GMT||{};a.GMT=b(a,c);define("GMT",[],function(){return a.GMT;});}(this,function(a,b){b.extend=_.extend;b.bindAll=_.bindAll;b.Events=Backbone.Events;b.templates={};b.partials={};b.loc=b.loc||{};b.history={enabled:true};b.eventsFlag=false;b.isPerformanceAvailable=(window.dctk&&window.dctk.logging&&window.dctk.logging.logTrxEvent&&window.performance&&window.performance.timing&&window.performance.timing.connectStart&&window.performance.timing.navigationStart);if(b.isPerformanceAvailable){b.performanceSetStartTime=function(){var e=new Date;function c(){return window.performance.now();}return function(){return(c()-(e.getTime()-window.performance.timing.connectStart))/1000;};};b.performanceGetTimeElapsed=new b.performanceSetStartTime();b.Events.on("GMT.performance.track.time.elapsed",function(){if(typeof arguments[0].log1!="undefined"&&typeof arguments[0].value!="undefined"){dctk.logging.logTrxEvent("GMT_performance",["clEventName01=time elapsed: "+arguments[0].log1,"clEventTime01="+arguments[0].value.toFixed(2)]);}});}b.init=function(c){if(b.isPerformanceAvailable){b.Events.trigger("GMT.performance.track.time.elapsed",{value:(typeof b.performanceGetTimeElapsed!="undefined")?b.performanceGetTimeElapsed():undefined,log1:"t0 -> GMT.init"});}try{b.extend(b,c);b.options=c.options;b.setDomc(function(){b.utils.overRideUITKDateSettings();b.compileTpls();b.bindEvents();if(b.history.enabled){b.history.init();}if(b.domc.countdowns.length>0){b.countdowns=[];for(var e=b.domc.countdowns.length-1;e>=0;e--){b.countdowns[e]=new b.Countdown({parentContext:b,el:$(b.domc.countdowns[e])});}}if(b.domc.dealsWrapper.length>0){b.deals=[];for(var e=b.domc.dealsWrapper.length-1;e>=0;e--){b.deals[e]=new b.Deals({parentContext:b,el:$(b.domc.dealsWrapper[e]),i:e});}}if(b.domc.promoBanner.length>0&&(b.domc.promoBanner.find(".tile-grid .tile").length>1||b.domc.promoBanner.find(".gmt-tile").length>1)){var g=b.domc.promoBanner.find(".tile-grid");if(g.length==0){g=b.domc.promoBanner.find(".gmt-tile-grid");}b.utils.equalHeightsOnPromoBanners(g);b.Events.on("windowResize",function(){b.utils.equalHeightsOnPromoBanners(g);});}if(b.domc.gmtWizard.length>0){b.wizard=b.wizard||{};b.wizard.instance=new GmtWizard();}var f=$(".coupons-status-msg-container");if(f.length>0){if(b.pageId==="seo-coupons"){require(["dynamic-coupons"],function(h){h.init({els:f});});}else{require(["coupon-campaign-status"],function(h){h.init({els:f});});}}});}catch(d){console.log("GMT - init says ",d);}};b.bindEvents=function(){var c,d;if(window.isMobilePhone){$(window).on("orientationchange",function(){var e=setTimeout(function(){b.Events.trigger("windowOrientationchange");clearTimeout(e);},400);});}else{$(window).on("resize",function(){var e=setTimeout(function(){b.Events.trigger("windowResize");clearTimeout(e);},400);});}$(window).on("scroll",function(){var e=setTimeout(function(){b.Events.trigger("windowScroll");clearTimeout(e);},10);});$(document).on("click touchend",".scroll-top",function(e){e.preventDefault();$(window).scrollTop(0);uitk.utils.focusElement($("#header-logo"));});};b.compileTpls=function(){var c=$(".gmt-view-tpl");if(c.length>0){$.each(c,function(e){var g=$(this),h=g.attr("id"),f=g.hasClass("partials"),d=$(this).html();if(f){b.partials[h]=Handlebars.compile(d);}else{b.templates[h]=Handlebars.compile(d);}});}else{return false;}};b.setDomc=function(c){b.domc={header:$("#WizardHero"),siteContent:$("#siteContent"),dealsWrapper:$(".gmt-deals-wrapper"),tabsContainer:$(".gmt-tabs-container"),stickyAnchor:$("#stickyAnchor"),countdowns:$(".countdown"),scrollToTop:$(".scroll-top"),promoBanner:$("#carousel-deals-wrapper"),gmtWizard:$("#gmtWizard #search-wizard")};if(typeof c==="function"){c();}};return b;}));GMT.extend(GMT,{Deals:function(a){var b=this;b.el=a.el;b.presentationType=GMT.domc.dealsWrapper.data("presentation-type");b.renderedModules=0;b.setCollections=[];b.setViews=[];b.historyFlag=false;
b.dealRequestTimes=[];if(GMT.isPerformanceAvailable){b.performanceGetTimeElapsed=new GMT.performanceSetStartTime();}b.init();define("GMT_Deals",[],function(){return b;});}});GMT.extend(GMT.Deals.prototype,{init:function(){var b=this;try{b.setDomc(function(){if(!GMT.eventsFlag){b.bindEvents();}if(!b.historyFlag&&GMT.history.enabled){b.historyRouteCallback();b.historyRouteUpdate();}GMT.Events.trigger("GMT.deals.init.queue",b);if(b.domc.modules.length>0){b.modules=[];for(var c=b.domc.modules.length-1;c>=0;c--){b.modules[c]=new b.Module({i:c,el:b.domc.modules[c],parentContext:b});}}});}catch(a){console.log("GMT.Deals - init says ",a);}},setDomc:function(b){var a=this;a.domc={};a.domc.lobTabsContainer=$("#offerTabs");a.domc.lobTabsList=a.domc.lobTabsContainer.children("ul");a.domc.lobTabs=a.domc.lobTabsList.children("li");a.preSelectedTab=a.domc.lobTabsList.find("li button.on").parent();a.preSelectedTabIndex=a.preSelectedTab.index();a.domc.tabAnchors=a.domc.lobTabsList.find("a");a.domc.modules=$(".gmt-deals-module",a.el);a.domc.loadMoreBtn=a.domc.modules.find("#loadMoreDeals");if(typeof b=="function"){b();}},reloadPage:function(){var a=setTimeout(function(){window.location.reload();clearTimout(a);},1500);},indentifyLastModule:function(b){var a=this;a.dealRequestTimes.push(b);if(a.dealRequestTimes.length==a.modules.length){a.modules[a.dealRequestTimes[a.dealRequestTimes.length-1]].isLast=true;}},bindEvents:function(){var b=this,a=1;GMT.Events.on("GMT.pt_tab.finalise",function(c){var d=b.activeModule,e;d.setDomc(function(){if(typeof d.collection==="object"&&d.collection.length===1&&typeof d.sorting.instance==="object"){d.sorting.instance.el.hide();}else{if(typeof d.sorting.instance==="object"){d.sorting.instance.el.show();}}if(d.pagination.enabled){d.domc.grid.addClass("hidden");e=$("#tab-"+d.i+"-page-"+d.activePage);if(e.length==0){$.each(d.domc.grid,function(g,f){if($(f).data("id")=="tab-"+d.i+"-page-"+d.activePage){e=$(f);}});}e.removeClass("hidden");if(d.queryScenario==="deal-finder"){d.domc.grid.removeClass("hidden");}}if(d.pagination.clicked){d.scrollToDeals();d.pagination.clicked=false;}});GMT.history.goNoGoForHistory(b,d);if(GMT.isPerformanceAvailable){GMT.Events.trigger("GMT.performance.track.time.elapsed",{value:(typeof GMT.performanceGetTimeElapsed!="undefined")?GMT.performanceGetTimeElapsed():undefined,log1:"t0 -> deals module ["+c.i+"]["+c.Lob+"] rendered"});}});GMT.Events.on("GMT.pt_carousel.finalise",function(c){c.domc.sliderGrpTitle.removeClass("hidden");c.setDomc(function(){if(c.domc.sliderTitle.length>0){var d=c.domc.sliderTitle.html();if(typeof c.lowestPrice!=="undefined"){d=d.replace("###",GMT.utils.formatPrice(c.lowestPrice)).replace("%%%",c.highestPercentageSaving+"%");}c.domc.sliderTitle.html("").html(d);c.domc.sliderTitleWrapper.show();}if(GMT.utils.isTestActive("25136")){$('[data-control="uitk-carousel"]').uitk_carousel();}c.domc.contentSlider.uitk_contentSlider();});if(GMT.isPerformanceAvailable){GMT.Events.trigger("GMT.performance.track.time.elapsed",{value:(typeof GMT.performanceGetTimeElapsed!="undefined")?GMT.performanceGetTimeElapsed():undefined,log1:"t0 -> deals module ["+c.i+"]["+c.Lob+"] rendered"});}});GMT.Events.on("GMT.pt_destination.finalise",function(c){var d=b.activeModule,e;d.setDomc(function(){if(d.pagination.enabled){d.domc.paginatedGroupedDealsWrapper.addClass("hidden");e=$("#tab-"+d.i+"-page-"+d.activePage);e.removeClass("hidden");d.scrollToDeals();}});if(GMT.isPerformanceAvailable){GMT.Events.trigger("GMT.performance.track.time.elapsed",{value:(typeof GMT.performanceGetTimeElapsed!="undefined")?GMT.performanceGetTimeElapsed():undefined,log1:"t0 -> deals module ["+c.i+"]["+c.Lob+"] rendered"});}});GMT.Events.on("GMT.pt_featured.finalise",function(c){c.domc.secTitle.removeClass("hidden");c.domc.secBtn.removeClass("hidden");c.el.find(".deal-card-set").uitk_flexCard();uitk.mediaquery.publishAgain();if(GMT.isPerformanceAvailable){GMT.Events.trigger("GMT.performance.track.time.elapsed",{value:(typeof GMT.performanceGetTimeElapsed!="undefined")?GMT.performanceGetTimeElapsed():undefined,log1:"t0 -> deals module ["+c.i+"]["+c.Lob+"] rendered"});}});GMT.Events.on("GMT.failedResponse",function(c){c.abortModule(c);});uitk.subscribe("tab.selected",function(c,e){var d=parseInt(e.children(".on").attr("id").match(/\d{1,}/g));if(typeof b.modules[d]=="object"){b.activeModule=b.modules[d];b.activeModule.renderModule=true;if(b.activeModule.resetAfterTabClick){GMT.Events.trigger("GMT.reload.selected.tab",b.activeModule);}else{if(b.activeModule.hasOwnProperty("view")&&typeof b.activeModule.view.render==="function"&&!b.activeModule.view.isRendered){b.activeModule.view.render();}else{GMT.Events.trigger("GMT.pt_tab.finalise",b.activeModule,b.activeModule.view);}}}if(typeof dctk!="undefined"&&dctk.hasOwnProperty("omtr")){dctk.trackAction(GMT.pageName+".Tab."+d,e[0],{});}else{if(typeof window.s_exp_trackClick!="undefined"){window.s_exp_trackClick(e[0],"a",GMT.pageName+".Tab."+d);}}});uitk.subscribe("pagination.pageChanged",function(g,c){if(typeof b.activeModule=="object"){var d=b.activeModule,f=$("#tab-"+d.i+"-page-"+c.pageNumber);if(f.length==0){$.each(d.domc.grid,function(h,e){if($(e).data("id")=="tab-"+d.i+"-page-"+c.pageNumber){f=$(e);}});}d.pagination.clicked=true;d.pagination.inProgress=true;if(f.length>0){if(d.presentationType==="pt_destination"){d.domc.paginatedGroupedDealsWrapper.addClass("hidden");}else{d.domc.grid.addClass("hidden");}f.removeClass("hidden");d.scrollToDeals();}else{d.activePage=c.pageNumber;d.updateQueryAndFetchDeals(d,{event:"pagination.pageChanged",pageNumber:c.pageNumber});}}});$("body").off("click","#loadMoreDeals").on("click","#loadMoreDeals",function(d){if(typeof b.activeModule=="object"){a++;var c=b.activeModule;c.pagination.inProgress=true;c.loaderAnim(c.el,"start");c.updateQueryAndFetchDeals(c,{event:"rfd.loadMore.click",pageNumber:a});}});$("body").on(uitk.clickEvent,"#wizard-footer a",function(c){var d=$(this).attr("href");uitk.utils.focusElement($(d));});GMT.Events.on("GMT.reload.selected.tab",function(c){if(!c.tabHasBeenReset){c.filtering.inProgress=true;c.updateQueryAndFetchDeals(c,{event:"GMT.reload.selected.tab"});c.tabHasBeenReset=true;c.filtering.defaultFiltering.destinationCity="";c.filtering.defaultFiltering.destinationCountry="";c.filtering.instance.render({data:c.filtering.instance.getDestinationsData,filterContainer:c.filtering.instance.el});}});GMT.Events.on("GMT.sorting.change",function(d){var e=b.activeModule,c;e.sorting.inProgress=true;if(typeof e=="object"){e.sorting.defaultSorting=d.defaultSorting;if(typeof e.filteredCollection=="object"&&e.filteredCollection.hasOwnProperty("length")){e.filteredCollection.changeSort();if(typeof e.filteredCollection.comparator=="function"){e.filteredCollection.sort();}c=new b.ModuleView({el:e.el,collection:e.filteredCollection,module:e});c.render();}else{if(e.sorting.mode==="cs"){e.collection.changeSort();if(typeof e.collection.comparator=="function"){e.collection.sort();}c=new b.ModuleView({el:e.el,collection:e.collection,module:e});c.render();}else{e.updateQueryAndFetchDeals(e,{event:"GMT.sorting.change"});}}}});GMT.Events.on("GMT.filtering.change",function(c){var d=b.activeModule;d.filterBy=c.filterBy;d.selectedFilterVal=c.selection,c.event="GMT.filtering.change";d.filtering.inProgress=true;if(typeof d=="object"){d.updateQueryAndFetchDeals(d,c);}});GMT.Events.on("windowScroll",function(){var d=$(window).scrollTop(),c=$(".site-content-wrap").eq(0).offset(),e=$("#toTop");if(d>c.top){e.show();}else{e.hide();}});GMT.Events.on("GMT.countdown.finished",function(d){var e=b.activeModule,i=$(d.countdown),h=i.attr("data-sale-ended-content"),g=i.attr("data-has-started"),f=e.domc.addOnContainer.children(".filter-container");if(g=="false"||(GMT.options.hasOwnProperty("isUseDealContentAfter")&&GMT.options.isUseDealContentAfter)){b.reloadPage();}else{if(h!==""&&$("#offerEndContent").length===0){h=unescape(h);var j='<div id="offerEndContent" class="col">'+h+"</div>";
$(j).appendTo($(".offerTabs"));}e.el.hide();if(e.domc.hasOwnProperty("ownTab")){e.domc.ownTab.hide();}f.hide();}});GMT.Events.on("GMT.filteringCS.done",function(d){var f=b.activeModule.el,e=b.activeModule;e.filtering.inProgress=true;e.filteredCollection=d.filteredCollection;var c=new b.ModuleView({el:f,collection:e.filteredCollection,module:e});c.render();});GMT.Events.on("GMT.filteringCS.change",function(q){try{var m,n=q.selection,o=q.filterBy,d=b.activeModule,p=b.activeModule.parsedData,j=b.activeModule.collection,l=b.activeModule.lob,f=b.activeModule.i,i=q.filterObj.config.filterOptions,c=q.el,h=q.filterObj,g={};g[o]=n;if(o=="country"||o=="destCountry"&&typeof i.city!="undefined"){if(n!="-1"){j.reset(p,{lob:l});m=h.filterCollection(g,j);if(m.length>0){GMT.Events.trigger("GMT.filteringCS.done",{el:d.el,obj:d,filteredCollection:m});}h.getCitiesOnChange(i,n,p);h.populateCityDropDown(i.city,h.uniqueCities,f);}else{j.reset(p,{lob:l});GMT.Events.trigger("GMT.filteringCS.done",{el:d.el,obj:d,filteredCollection:j});h.getDistinctDropDownVals(i.city,p);h.populateCityDropDown(i.city,h.uniqueDropDownVals,f);}if(typeof dctk!="undefined"&&dctk.hasOwnProperty("omtr")){dctk.trackAction(b.activeModule.dealsRfrr+".Deals.Filter.Country",c,{});}else{if(typeof window.s_exp_trackClick!="undefined"){window.s_exp_trackClick(c,"a",b.activeModule.dealsRfrr+".Deals.Filter.Country");}}}if(o=="city"||o=="destCity"){if(typeof i.country!="undefined"){if(n!="-1"){j.reset(p,{lob:l});m=h.filterCollection(g,j);if(m.length>0){GMT.Events.trigger("GMT.filteringCS.done",{el:d.el,obj:d,filteredCollection:m});}h.getCountryOnChange(i,n,p);h.selectCountry(i,f);h.getCitiesOnChange(i,h.uniqueCountry,p);h.populateCityDropDown(i.city,h.uniqueCities,f);h.selectCity(i,n,f);}else{j.reset(p,{lob:l});m=h.filterCollection(g,j);GMT.Events.trigger("GMT.filteringCS.done",{el:d.el,obj:d,filteredCollection:m});}}if(typeof i.originCity!="undefined"){if(n!="-1"){j.reset(p,{lob:l});m=h.filterCollection(g,j);if(m.length>0){GMT.Events.trigger("GMT.filteringCS.done",{el:d.el,obj:d,filteredCollection:m});}h.getDeparturesOnChange(i,n,p);h.populateDepDropDown(i.originCity,uniqueDepatures,f);if(typeof g.originCity!="undefined"){h.selectDeparture(i,g.originCity,f);}}else{j.reset(p,{lob:l});if(!$.isEmptyObject(g)){m=h.filterCollection(g,j);}h.getDistinctDropDownVals(i.originCity,p);h.populateDepDropDown(i.originCity,h.uniqueDropDownVals,f);if(typeof g.originCity!="undefined"){h.selectDeparture(i,g.originCity,f);}GMT.Events.trigger("GMT.filteringCS.done",{el:d.el,obj:d,filteredCollection:j});}}if(typeof dctk!="undefined"&&dctk.hasOwnProperty("omtr")){dctk.trackAction(d.dealsRfrr+".Deals.Filter.City",c,{});}else{if(typeof window.s_exp_trackClick!="undefined"){window.s_exp_trackClick(c,"a",d.dealsRfrr+".Deals.Filter.City");}}}if(o=="originCity"){if(n!="-1"){j.reset(p,{lob:l});m=h.filterCollection(g,j);if(m.length>0){GMT.Events.trigger("GMT.filteringCS.done",{el:d.el,obj:d,filteredCollection:m});}h.getCitiesOnChange(i,n,p);h.populateCityDropDown(i.city,h.uniqueCities,f);if(typeof g.destCity!="undefined"){h.selectCity(i,g.destCity,f);}}else{delete g.originCity;j.reset(p,{lob:l});if(!$.isEmptyObject(g)){m=h.filterCollection(g,j);}else{h.getDistinctDropDownVals(i.city,p);h.populateCityDropDown(i.city,h.uniqueDropDownVals,f);}GMT.Events.trigger("GMT.filteringCS.done",{el:d.el,obj:d,filteredCollection:j});if(typeof g.destCity!="undefined"){h.selectCity(i,g.destCity,f);}}if(typeof dctk!="undefined"&&dctk.hasOwnProperty("omtr")){dctk.trackAction(d.dealsRfrr+".Deals.Filter.Departure",c,{});}else{if(typeof window.s_exp_trackClick!="undefined"){window.s_exp_trackClick(c,"a",d.dealsRfrr+".Deals.Filter.Departure");}}}}catch(k){console.log(k);}});GMT.eventsFlag=true;},Module:function(a){var b=this,c=a.parentContext;b.i=a.i;b.el=$(a.el);if(b.el.is(":visible")){c.activeModule=b;}b.dealsModule=c;b.url=b.el.data("url");b.destinationUrl=typeof b.el.data("destination-url")!="undefined"?b.el.data("destination-url"):false;b.queryScenario=b.el.data("query-scenario");b.pageId=b.el.data("page-id");b.presentationType=b.dealsModule.presentationType;b.Lob=b.el.data("lob");b.lob=b.Lob.toLowerCase();b.locale=b.el.data("locale");b.preSelectedTabIndex=c.preSelectedTabIndex;b.preSelectedTab=c.preSelectedTab;b.isSelected=typeof b.el.data("selectedTab")==="number";b.selectedTabNumber=typeof b.el.data("selectedTab")==="number"?b.el.data("selectedTab"):undefined;b.resetAfterTabClick=(typeof b.el.data("resetaftertabclick")!="undefined"&&b.el.data("resetaftertabclick")==true);b.tabHasBeenReset=false;b.isCampaignManagerQuery=(b.queryScenario=="campaign-manager");b.isIncludeUnpriced=(b.isCampaignManagerQuery&&GMT.utils.getQueryParamValue(b.url,"includeUnpriced")=="true");if(b.presentationType==="uncat"||b.presentationType==="pt_tab"){b.renderModule=(b.isSelected||b.isSelected&&b.i===0||b.preSelectedTabIndex==-1&&b.i===0)?true:false;}b.secIndex=parseInt(b.el.data("sec-index"));b.subSecIndex=parseInt(b.el.data("subsec-index"));b.dealsRfrr=b.el.data("deals-rfrr");b.showFlightImage=(typeof b.el.data("show-flight-image")!="undefined")?b.el.data("show-flight-image"):false;b.groupBy=b.el.data("group-by");b.hotelPriceProp=b.el.data("hotel-price");b.showHotelPrice=b.el.data("show-hotel-price");b.hotelOfferMarker=b.el.data("hotel-offer-marker");b.useAveragePrice=b.el.data("use-average-price");b.minOfferThreshold=(b.el.data("min-offer-threshold-percentage")!=="")?b.el.data("min-offer-threshold-percentage"):0;b.isOsfilteringSortingSupported=(b.url.indexOf("/v2/")!=-1&&typeof b.destinationUrl=="string")?true:false;b.filtering={enabled:(function(){var e=b.el.data("show"+b.lob+"filters"),d=b.el.data("filters");if(e||d){return true;}else{return false;}})(),showHotelFilters:b.el.data("showhotelfilters"),showFlightFilters:b.el.data("showflightfilters"),showPackageFilters:b.el.data("showpackagefilters"),showThirdPartyPackageFilters:b.el.data("showthirdpartypackagefilters"),mode:(typeof b.el.data("filter-mode")!=="undefined"?b.el.data("filter-mode"):(typeof b.el.data("destination-url")!=="undefined"?"ss":"cs")),defaultFiltering:{dealFinderDeepLink:(typeof b.el.data("deal-finder-deep-link")!=="undefined"&&b.el.data("deal-finder-deep-link")===true)?true:false,destinationCity:b.el.data("filter-destination-city"),originCity:b.el.data("filter-origin-city"),destCountry:b.el.data("filter-destination-country")}};b.sorting={enabled:typeof b.el.data("default-sorting")!=="undefined"?true:false,defaultSorting:(typeof b.el.data("default-sorting")!=="undefined"&&b.el.data("default-sorting")!="none")?parseInt(b.el.data("default-sorting")):"none",sortDealsByPrice:GMT.options.sortDealsByPrice,sortByRecentActivity:(GMT.options.sortByRecentActivityAB||GMT.options.sortByRecentActivityPaceOption)?true:false,mode:(typeof b.el.data("sort-mode")!=="undefined"?b.el.data("sort-mode"):(typeof b.el.data("destination-url")!=="undefined"?"ss":"cs"))};b.pagination={enabled:typeof b.el.data("numoffers")==="number"?true:false,clicked:false,numberOfDealsPerPage:typeof b.el.data("numoffers")==="number"?b.el.data("numoffers"):45};b.activePage=1;b.setDomc(function(){b.init();});},ModuleCollection:Backbone.Collection.extend({initialize:function(b,a){if(typeof a.pagination=="object"){this.pagination=a.pagination;}this.module=a.module;this.module.dealsModule.setCollections.push(this);if(b[0].hasOwnProperty("originCity")&&b[0].originCity!=""){this.originCity=b[0].originCity;}GMT.Events.trigger("GMT.deals.module.collection.ready",this.module);},model:function(a,b){if(a.hasOwnProperty("groupBy")&&a.groupBy){GMT.extend(a,a.nested[0]);}switch(b.lob){case"hotel":return new GMTHotelModel(a,b);break;case"cruise":return new GMTCruiseModel(a,b);break;case"package":return new GMTPackageModel(a,b);break;case"flight":return new GMTFlightModel(a,b);break;case"car":return new GMTCarModel(a,b);break;case"flightcar":return new GMTFlightCarModel(a,b);break;case"hotelcar":return new GMTHotelCarModel(a,b);break;case"thirdpartypackage":return new GMTPackageModel(a,b);
break;case"lxactivities":return new GMTActivityModel(a,b);break;case"groupbydestination":return new GMTGroupedByDestinationModel(a,b);break;}}}),ModuleView:Backbone.View.extend({initialize:function(a){a.module?this.module=a.module:{};GMT.bindAll(this);this.module.dealsModule.setViews.push(this);GMT.Events.trigger("GMT.deals.module.view.ready",this.module);},template:function(a){if(this.module.lob=="thirdpartypackage"){return GMT.templates["package-tpl"](a);}else{return GMT.templates[this.module.lob+"-tpl"](a);}},render:function(){try{var k=this,c=k.collection,j=k.template,a=k.module,f=a.dealsModule,i=[],h="";if(typeof a.tabLob!="undefined"){var d=(a.tabLob.indexOf("Package")===-1?"icon-hotels":"icon-packages"),b=$("#tab-groupByDestination-tab-"+a.i+" .tab-label .icon");b.addClass(d);}if(c.length>0&&(typeof a.renderModule==="undefined"||typeof a.renderModule==="boolean"&&a.renderModule)){if(c.models.length>4&&((GMT.utils.isTestActive("10289")||GMT.utils.isTestActive("10486")||GMT.utils.isTestActive("11126"))||(GMT.siteid==="7"&&a.url.indexOf("showButtons=true")>0))){c.models.splice(4,c.models.length);}i.push(j(c));if(a.domc.grid.length>0){if(a.filtering.inProgress||a.sorting.inProgress){a.domc.paginatedDealsWrapper.html("");a.domc.paginatedDealsWrapper.html(i.join(""));k.isRendered=true;delete a.filtering.inProgress;delete a.sorting.inProgress;}else{if(a.pagination.inProgress){$(i.join("")).appendTo(a.domc.paginatedDealsWrapper);k.isRendered=true;delete a.pagination.inProgress;}else{h=$(i.join(""));h.find(".tile").appendTo(a.domc.grid);k.isRendered=true;}}}else{if(a.domc.hasOwnProperty("paginatedDealsWrapper")&&a.domc.paginatedDealsWrapper.length>0){$(i.join("")).appendTo(a.domc.paginatedDealsWrapper);k.isRendered=true;}else{$(i.join("")).appendTo(a.el);k.isRendered=true;}}a.loaderAnim(a.el,"stop");a.dealsModule.domc.loadMoreBtn.removeClass("hidden");if(a.isLast&&dctk.ewePerformance&&typeof dctk.ewePerformance.markPageUsable==="function"&&typeof dctk.ewePerformance.getPageUsableTime==="function"){if(dctk.ewePerformance.getPageUsableTime().length<1){dctk.ewePerformance.markPageUsable();}}GMT.Events.trigger("GMT."+f.presentationType+".finalise",a,k);}else{a.loaderAnim(a.el,"stop");if(GMT.utils.isTestActive("24736")){$(a.domc.secTitle).addClass("hidden");$(a.domc.secBtn).addClass("hidden");}}}catch(g){console.log("GMT.Deals.Module - render says ",g);}}}),historyRouteCallback:function(){var a=this;GMT.Events.on("GMT.history.route.callback",function(){var c=GMT.history.currentRoute,d=$(".offerTabs .tab"),b=d.length>0?(parseInt(d.find("button.on").parent().index())):0,g=d.length,e=(function(){if(GMT.utils.getQueryParamValue(c,"offertab")!==false){return parseInt(GMT.utils.getQueryParamValue(c,"offertab"));}else{if(GMT.utils.getQueryParamValue(window.location.href,"tab")!==false){return parseInt(GMT.utils.getQueryParamValue(window.location.href,"tab")-1);}else{return 0;}}})(),f=[];if(d.length>0&&e!="undefined"&&b!=e&&e<=g){f=$(".offerTabs .tab button").eq(e);if(f.is(":visible")&&f.length>0){f.trigger(uitk.clickEvent+".uitk_tabs");b=e;}}});a.historyRouteCallbackFlag=true;},historyRouteUpdate:function(){var b=this,a=GMT.history;GMT.Events.on("GMT.history.route.update",function(){uitk.subscribe("tab.selected",function(c,d){if(typeof a=="object"&&d.children(".on").attr("data-gmtdealstab")=="true"){if(d.index()>=0){a.previousRoute=window.location.hash;if(a.firstLoad){a.router.navigate("offertab="+(d.index())+"&page=1");}a.firstLoad=false;if(a.previousRoute!==""){a.router.navigate("offertab="+(d.index())+"&page=1");}a.currentRoute=window.location.hash;if(a.previousRoute===""&&a.currentRoute===""){a.firstLoad=true;}}}});});},processUad:function(){var b=[],c=GMT.uad,a=Backbone.Collection.extend({comparator:function(d){return(d.get("loggedDateObj").getTime())*-1;}});if(c.hasOwnProperty("searchedFlights")&&c.searchedFlights.length>0){$.each(c.searchedFlights,function(){this.product="searchedFlights";this.loggedDateObj=new Date(this.searchedDate);this.TLA=this.destinationTLA;this.city=this.destination.city;b.push(this);});}if(c.hasOwnProperty("searchedPackages")&&c.searchedPackages.length>0){$.each(c.searchedPackages,function(){this.product="searchedPackages";this.loggedDateObj=new Date(this.searchedDate);this.TLA=this.destinationTLA;this.city=this.destination.city;b.push(this);});}if(c.hasOwnProperty("viewedHotels")&&c.viewedHotels.length>0){$.each(c.viewedHotels,function(){this.product="viewedHotels";this.loggedDateObj=new Date(this.viewedDate);this.TLA="none";this.city=this.regionLongName;b.push(this);});}if(c.hasOwnProperty("viewedPackages")&&c.viewedPackages.length>0){$.each(c.viewedPackages,function(){this.product="viewedPackages";this.loggedDateObj=new Date(this.viewedDate);this.TLA=this.destinationTLA;this.city=this.destination.city;b.push(this);});}b=new a(b);b=b.sort();GMT.processedUad=b;}});GMT.extend(GMT.Deals.prototype.Module.prototype,{init:function(c){var b=this,f=b.dealsModule;try{GMT.bindAll(this);if((b.pageId=="seasonal"||b.pageId=="flashsale")&&b.Lob=="groupByDestination"&&GMT.userId!="-1"){b.url=b.url+"&enabledABs=travelerProfile";function a(h,m){var g=h.split("?");var j="";if(g.length>=2){var k=encodeURIComponent(m)+"=";var l=g[1].split(/[&;]/g);for(var e=l.length;e-->0;){if(l[e].lastIndexOf(k,0)!==-1){l.splice(e,1);}}j=g[0]+"?"+l.join("&");return j;}else{return j;}}b.url=b.url+"&expUserId="+GMT.userId;b.url=a(b.url,"destinationLimit");}b.fetch(b.url,b.fetchCallback);GMT.Events.trigger("GMT.deals.module.init.queue",b);}catch(d){console.log("GMT.Deals.Module - init says ",d);}},setDomc:function(c){var a=this,b=a.dealsModule;a.domc={grid:$(".gmt-tile-grid").length>0?$(a.el).find(".gmt-tile-grid"):$(a.el).find(".tile-grid"),gridTiles:$(".gmt-tile").length>0?$(a.el).find(".gmt-tile"):$(a.el).find(".tile"),gridTileContents:$(a.el).find(".tile-content"),gridTileFooters:$(a.el).find(".tile-footer"),loader:$(a.el).children(".loader"),offersWrapper:$("#offers-wrapper-"+a.i),addOnContainer:$("#addon-container-"+a.i)};switch(b.presentationType){case"pt_tab":a.domc.paginatedDealsWrapper=$("#paginated-deals-wrapper-"+a.i);a.domc.lobTabsContainer=$("#offerTabs");a.domc.lobTabsList=a.domc.lobTabsContainer.children("ul");a.domc.lobTabs=a.domc.lobTabsList.children("li");a.domc.ownTab=a.domc.lobTabs.eq(a.i);a.domc.tabAnchors=a.domc.lobTabsList.find("a");a.domc.ownTabAnchor=a.domc.tabAnchors.eq(a.i);a.domc.ownTabContent=$(a.domc.ownTabAnchor.data("href"));break;case"pt_carousel":a.domc.contentSlider=$(a.el).children(".content-slider");a.domc.contentSliderMask=$(a.el).find(".content-slider-mask");a.domc.sliderTitleWrapper=$("#promo-deals-module-"+a.secIndex+"-"+a.subSecIndex+"-title-wrapper");a.domc.sliderGrpTitle=$("#offer-grp-"+a.secIndex+"-title");a.domc.sliderTitle=$("#promo-deals-module-"+a.secIndex+"-"+a.subSecIndex+"-title");break;case"pt_destination":a.domc.paginatedDealsWrapper=$("#paginated-deals-wrapper-"+a.i);a.domc.paginatedGroupedDealsWrapper=$(".paginated-grouped-deals");break;case"pt_featured":a.domc.secTitle=$("#promo-deals-module-"+a.secIndex+"-title-wrapper");a.domc.secBtn=$("#dd-btn-"+a.secIndex);break;}if(typeof c=="function"){c();}},fetch:function(a,f){var b=this,e=b.dealsModule,c=new Date(),d=Math.round(c.getTime());if(GMT.abacus.hasOwnProperty("ab12993")&&GMT.abacus.ab12993==1&&b.lob=="package"){a=a+"&enabledABs=NonMandatoryDestinationForPkg";}if((b.lob=="hotel"||a.indexOf("Hotel")!==-1)&&(GMT.utils.isTestActive("14977")||GMT.utils.isTestActive("14978"))){a=a+"&hotelProvider=os-nova";}$.ajax({url:a,dataType:"jsonp",success:function(j,h,i){if(GMT.isPerformanceAvailable){b.dealsModule.indentifyLastModule(b.i);GMT.Events.trigger("GMT.performance.track.time.elapsed",{value:(typeof e.performanceGetTimeElapsed!="undefined")?e.performanceGetTimeElapsed():undefined,log1:"deals module ["+b.i+"]["+b.Lob+"] init -> deal request success"});}if(typeof window.dctk!="undefined"&&dctk.hasOwnProperty("logging")&&typeof dctk.logging.logTrxEvent=="function"){var g=new Date(),l=Math.round(g.getTime()),k=(l-d);
dctk.logging.logTrxEvent("GMT_GetOffersJsonAJaxSuccess",["clEventName01=GMT_GetOffersAjaxSuccess_Scenario_"+b.queryScenario,"clEventTime01="+k]);}f(j);},error:function(j,h,i){if(typeof window.dctk!="undefined"&&dctk.hasOwnProperty("logging")&&typeof dctk.logging.logMessage=="function"){var g=new Date(),l=Math.round(g.getTime()),k=(l-d);dctk.logging.logMessage("GMT_GetOffersAjaxError_Scenario_"+b.queryScenario,{status:h,error:i,fnTime:k});}GMT.Events.trigger("GMT.failedResponse",b);}});},fetchCallback:function(h){var b=this,j=b.dealsModule;adapterOutput=GMT.parseOSGetOffers(h,{showHotelPrice:b.showHotelPrice,hotelOfferMarker:b.hotelOfferMarker,showFlightImage:b.showFlightImage,useAveragePrice:b.useAveragePrice,minOfferThreshold:b.minOfferThreshold,queryScenario:b.queryScenario,dealsRfrr:(h.hasOwnProperty("offerPagination")&&h.offerPagination.hasOwnProperty("currentPage"))?b.dealsRfrr+"."+h.offerPagination.currentPage:b.dealsRfrr,secIndex:b.secIndex,subSecIndex:b.subSecIndex,isIncludeUnpriced:b.isIncludeUnpriced}),b.parsedData=response=(typeof adapterOutput.models==="object"?adapterOutput.models:[]);if(GMT.abacus.ab24809===1&&b.lob=="groupbydestination"){b.commonDestiantionsForAb24809=[];if(b.MODdeals){if(typeof adapterOutput.destinations==="object"){b.destinationsForAb24809=adapterOutput.destinations;if(b.destinationsForAb24809.all&&b.MODdeals.deals.destinations.all){b.commonDestiantionsForAb24809=_.intersection(b.destinationsForAb24809.all,b.MODdeals.deals.destinations.all);}}}if(window.dctk&&window.dctk.trackAction){var i=document.createElement("a");i.id="modcount";dctk.trackAction(b.dealsRfrr+".modcount."+b.commonDestiantionsForAb24809.length,i,{});}}try{b.view={};b.collection={};b.lowestPrice=adapterOutput.lowestPrice;b.highestPercentageSaving=adapterOutput.highestPercentageSaving;if(typeof adapterOutput.tabLob!="undefined"){b.tabLob=adapterOutput.tabLob;}function c(e){b.collection=new j.ModuleCollection(e,{lob:b.lob,pagination:b.pagination,module:b,silent:false});return b.collection;}function d(e){b.view=new j.ModuleView({el:b.el,collection:e,module:b});return b.view;}if(response.length>0){if(typeof b.groupBy!=="undefined"&&b.groupBy!==""){var a=[],g=_.groupBy(response,b.groupBy),m=0;for(var l in g){a=a.concat({destIndex:m,nested:g[l],groupBy:true});m++;}b.haveGroups=true;var f={};switch(b.lob){case"package":f=Backbone.Collection.extend({model:GMTPackageModel});break;case"flight":f=Backbone.Collection.extend({model:GMTFlightModel});break;case"hotel":f=Backbone.Collection.extend({model:GMTHotelModel});break;}GMTHotelModel.prototype.initialize=function(){this.nested=new f(this.get("nested"));this.haveGroups=b.haveGroups;this.groupBy=b.groupBy;this.destIndex=this.get("destIndex");GMT.bindAll(this);};d(c(a));}else{d(c(response));if(b.sorting.enabled&&typeof b.sorting.instance!=="object"){b.sorting.instance=new j.ModuleSorting({parentContext:b});if(b.sorting.mode==="cs"){b.collection.changeSort();}}else{if(b.sorting.sortByRecentActivity){j.processUad();b.collection.changeSort();}else{if(b.sorting.sortDealsByPrice){b.collection.changeSort();}}}if(b.filtering.enabled&&typeof b.filtering.instance!=="object"){if(b.filtering.mode==="ss"){b.filtering.instance=new j.ModuleFiltering({parentContext:b});}else{if(b.filtering.mode==="cs"){b.filtering.instance=new j.ModuleFilteringCS({parentContext:b});}}}}if(b.pagination.enabled&&h.hasOwnProperty("offerPagination")&&h.offerPagination.hasOwnProperty("currentPage")&&h.offerPagination.hasOwnProperty("totalPages")){if(typeof b.pagination.instance==="object"){b.pagination.instance.init({parentContext:b,offerPagination:h.offerPagination});}else{b.pagination.instance=new j.ModulePagination({parentContext:b,offerPagination:h.offerPagination});}}else{b.pagination.enabled=false;}b.view.render();j.renderedModules++;GMT.Events.trigger("GMT.pagination.init",b);}else{GMT.Events.trigger("GMT.failedResponse",b);}}catch(k){console.log(k);}},abortModule:function(b){if((GMT.abacus.hasOwnProperty("ab10455")&&(GMT.abacus.ab10455==1))){GMT.Events.trigger("GMT.deals.module.view.ready",b);}var c=b.dealsModule;if(b.presentationType=="pt_destination"){b.loaderAnim(b.el,"stop");c.domc.loadMoreBtn.hide();}else{$(b.el).addClass("hidden");}if(b.presentationType=="pt_tab"){b.domc.ownTab.addClass("hidden");function a(){var d=b.domc.lobTabsList.children("li"),e=d.length>=b.preSelectedTabIndex?$(d[b.preSelectedTabIndex]):undefined;if(typeof e!="undefined"&&e.length>0&&e.is(":visible")){e.children("button").trigger("click");}else{$.each(d,function(f,g){var h=$(g);if(h.is(":visible")){h.children("button").trigger("click");return false;}});}}a();}},loaderAnim:function(b,c){var a=this,d=a.dealsModule;if(c=="start"){$(b).addClass("loading");}else{$(b).removeClass("loading");}},scrollToDeals:function(){var b=this,c=b.dealsModule,a=c.el.offset();a=Math.floor(a.top),currentScrollPos=$(window).scrollTop();if(currentScrollPos>a){$(window).scrollTop(a);}},updateQueryAndFetchDeals:function(f,l){var b=this,h=b.dealsModule,a=b.url,c={},d={},g=$(b.el).data("url");try{switch(l.event){case"GMT.reload.selected.tab":a=b.updateQueryVariable("destinationCity","",a);a=b.updateQueryVariable("destinationCountry","",a);break;case"pagination.pageChanged":a=b.updateQueryVariable("pageNumber",l.pageNumber,a);break;case"rfd.loadMore.click":a=b.updateQueryVariable("pageNumber",l.pageNumber,a);break;case"GMT.sorting.change":var k;switch(b.sorting.defaultSorting){case"none":k={sortBy:"",direction:""};break;case"0":if(b.lob=="hotel"){k={sortBy:"price",direction:"asc"};}else{if(b.lob=="package"){k={sortBy:"totalPrice",direction:"asc"};}else{if(b.lob=="flight"){k={sortBy:"perPersonPrice",direction:"asc"};}}}break;case"1":if(b.lob=="hotel"){k={sortBy:"price",direction:"dsc"};}else{if(b.lob=="package"){k={sortBy:"totalPrice",direction:"dsc"};}else{if(b.lob=="flight"){k={sortBy:"perPersonPrice",direction:"dsc"};}}}break;case"2":k={sortBy:"star-rating",direction:"dsc"};break;case"3":k={sortBy:"guest-rating",direction:"dsc"};break;}if(typeof k=="object"){for(var j in k){a=b.updateQueryVariable(j,k[j],a);}}break;case"GMT.filtering.change":for(var j in l.filters){b.activePage=1;a=b.updateQueryVariable(j,l.filters[j],a);}break;}b.url=a;b.fetch(b.url,b.fetchCallback);}catch(i){console.log(i);}},updateQueryVariable:function(a,h,g){var c=this,f=c.dealsModule;if(g.indexOf(a)!=-1){var j,l,m=[],k;if(g.indexOf("?")!=-1){j=g.split("?");k=j[0];j=j[1];}var b=j.split("&");for(var e=0;e<b.length;e++){var d=b[e].split("=");if(d[0]==a&&h!==null){if(h===""){l="";}else{l=d[0]+"="+encodeURI(h);m.push(l);}}else{m.push(d.join("="));}}return k+"?"+m.join("&");}else{if(a!==""&&h!==""){return g+"&"+a+"="+encodeURI(h);}else{return g;}}}});define("GMT-deals",["GMT"],function(a){return a.Deals;});GMT.extend(GMT.Deals.prototype,{ModulePagination:function(a){var b=this;b.module=a.parentContext;b.dealsModule=b.module.dealsModule;b.el=$("#pagination-wrapper-"+b.module.i);b.historyFlag=false;b.init(a);}});GMT.extend(GMT.Deals.prototype.ModulePagination.prototype,{init:function(a){try{var c=this,f=c.dealsModule,b=c.module;c.expectedPaginationModulesLength=f.modules.length;c.paginationHtml=[];c.paginationDone=false;c.paginationConfig={i:b.i,paginationId:"tab-"+b.i+"-pagination",rfrr:b.dealsRfrr,currentPage:a.offerPagination.currentPage,totalResults:a.offerPagination.totalOffers,totalPages:a.offerPagination.totalPages,resultsPerPage:b.pagination.numberOfDealsPerPage,firstResult:(function(){var e=a.offerPagination.currentPage;if(e==1){return 1;}else{return(b.pagination.numberOfDealsPerPage*(e-1))+1;}})()};b.pagination.currentPage=c.paginationConfig.currentPage;c.render();if(!c.historyFlag&&GMT.history.enabled){c.historyRouteCallback();c.historyRouteUpdate();}}catch(d){console.log("GMT.Deals.ModulePagination - init says ",d);}},render:function(){var b=this,c=b.dealsModule,a=b.module;b.el.html("");if(typeof GMT.templates["pagination-tpl"]==="function"){b.paginationHtml.push(GMT.templates["pagination-tpl"](b.paginationConfig));
$(b.paginationHtml.join("")).appendTo(b.el);if(!b.paginationDone){$("#"+b.paginationConfig.paginationId).uitk_pagination();}b.paginationDone=true;GMT.history.goNoGoForHistory(c,a);b.el.children(".pagination").on(uitk.clickEvent,function(k){if($(this).is(":visible")){var j=k.target,d=$(k.target),i=j.nodeName.toLowerCase(),f=$(this).attr("data-tracking-rfrr");switch(true){case (i=="span"):if(typeof dctk!="undefined"&&dctk.hasOwnProperty("omtr")){dctk.trackAction(f+".Pagination."+d.text(),j,{});}else{if(typeof window.s_exp_trackClick!="undefined"){s_exp_trackClick(j,"a",f+".Pagination."+d.text());}}break;case (i=="button"||i=="abbr"):var h=(function(){if(i=="abbr"){d=d.parent("button");}if(d.hasClass("pagination-next")){return"Next";}else{if(d.hasClass("pagination-prev")){return"Prev";}}})();if(typeof dctk!="undefined"&&dctk.hasOwnProperty("omtr")){dctk.trackAction(f+".Pagination"+h,j,{});}else{if(typeof window.s_exp_trackClick!="undefined"){s_exp_trackClick(j,"a",f+".Pagination."+h);}}break;case (i=="a"):var g=(function(){if(d.hasClass("backToTop")){return true;}else{return false;}})();if(g){if(typeof dctk!="undefined"&&dctk.hasOwnProperty("omtr")){dctk.trackAction(f+".Pagination.Top",j,{});}else{if(typeof window.s_exp_trackClick!="undefined"){s_exp_trackClick(j,"a",f+".Pagination.Top");}}}break;}}});}},historyRouteCallback:function(){var a=this;GMT.Events.on("GMT.history.route.callback",function(){var e=GMT.history.currentRoute,g=(function(){if(GMT.history.firstLoad&&GMT.history.deeplinkedTabIndex!=""&&GMT.utils.getQueryParamValue(e,"offertab")==false){return GMT.history.deeplinkedTabIndex;}else{if(typeof e=="undefined"){if(GMT.history.deeplinkedTabIndex!=""){return GMT.history.deeplinkedTabIndex;}else{return 0;}}else{if(GMT.utils.getQueryParamValue(e,"offertab")!=false){return parseInt(GMT.utils.getQueryParamValue(e,"offertab"));}else{return 0;}}}})(),d=$("#pagination-wrapper-"+(g)+" .pagination"),f=d.find("li label.selected input").val(),c=parseInt(d.attr("data-total-pages")),h=(typeof e=="undefined")?1:parseInt(GMT.utils.getQueryParamValue(e,"page")),b=[];if(d.length>0&&h!="undefined"&&f!=h&&h<=c&&h>0){d.find("li label input").each(function(){if($(this).val()==h){b=$(this).siblings(".pagination-label");}});if(b.length>0){b.trigger(uitk.clickEvent);}else{if(h<=c){b=$('<li><label class="check"><input type="radio" value="'+h+'" name="page" class="masked"><span class="pagination-label">'+h+"</span></label></li>");b.appendTo(d.find("ul"));d.find("li label input").each(function(){if($(this).val()==h){b=$(this).siblings(".pagination-label");}});b.trigger(uitk.clickEvent);}}}});a.historyRouteCallbackFlag=true;},historyRouteUpdate:function(){var b=this,a=GMT.history;GMT.Events.on("GMT.history.route.update",function(){uitk.subscribe("pagination.pageChanged",function(f,d){if(typeof a=="object"){var c=parseInt($(".pagination:visible").attr("data-tab-index"));if(d.pageNumber>=1){a.previousRoute=window.location.hash;if(a.firstLoad){a.router.navigate("offertab="+c+"&page="+d.pageNumber);}a.firstLoad=false;if(a.previousRoute!=""){a.router.navigate("offertab="+c+"&page="+d.pageNumber);}a.currentRoute=window.location.hash;if(a.previousRoute==""&&a.currentRoute==""){a.firstLoad=true;}}}});});}});GMT.extend(GMT.Deals.prototype,{ModuleSorting:function(a){var b=this;b.module=a.parentContext;b.dealsModule=b.module.dealsModule;b.el=$("#sorting-container-tab-"+b.module.i);b.init();}});GMT.extend(GMT.Deals.prototype.ModuleSorting.prototype,{init:function(a){try{var c=this,f=c.dealsModule,b=c.module;c.expectedSortingModulesLength=f.modules.length;c.sortingHtml=[];c.sortingReady=false;c.domc={addonContainer:$("#addon-container-"+c.module.i)};c.sortingConfig={i:c.module.i,rfrr:c.module.dealsRfrr,sortingId:"tab-"+c.module.i+"-sorting",defaultSorting:c.module.sorting.defaultSorting,sortingOptions:GMT.loc.sorting[b.Lob],Lob:c.module.Lob};if(!c.sortingReady){c.render();}c.bindEvents();GMT.utils.makeElementSticky();}catch(d){console.log(d);}},render:function(){var b=this,c=b.dealsModule,a=b.module;if(typeof GMT.templates["sorting-tpl"]==="function"){b.sortingHtml.push(GMT.templates["sorting-tpl"](b.sortingConfig));$(b.sortingHtml.join("")).appendTo(b.domc.addonContainer);b.sortingReady=true;b.domc["sortingContainer"]=b.el=$("#sorting-container-tab-"+b.module.i);b.domc["sortingSelect"]=$("#sorting-select-tab-"+b.module.i);}},bindEvents:function(){var b=this,c=b.dealsModule,a=b.module;b.domc.sortingSelect.on("change",function(){GMT.Events.trigger("GMT.sorting.change",{defaultSorting:$(this).val(),activeModule:c.activeModule});var d=$(this).children(":selected").attr("data-rfrr");if(typeof dctk!="undefined"&&dctk.hasOwnProperty("omtr")){dctk.trackAction(c.activeModule.dealsRfrr+".Sort."+d,this,{});}else{if(typeof window.s_exp_trackClick!="undefined"){window.s_exp_trackClick(this,"a",c.activeModule.dealsRfrr+".Sort."+d);}}if(b.domc.addonContainer.hasClass("sticky")){$("html,body").animate({scrollTop:GMT.domc.siteContent.offset().top});}});}});GMT.extend(GMT.Deals.prototype.ModuleCollection.prototype,{priceComparator:function(a){return a.getPrice();},getBookedComparator:function(a){return a.getNumberBooked();},changeSort:function(){var d=this,b=this.module,c=true;if(b.sorting.enabled&&b.sorting.defaultSorting!="none"&&typeof d.sortingMap[b.Lob][b.sorting.defaultSorting]=="function"){d.comparator=d.sortingMap[b.Lob][b.sorting.defaultSorting];c=false;}else{if(b.sorting.enabled&&b.sorting.defaultSorting=="none"&&typeof d.sortingMap[b.sorting.defaultSorting]=="function"){d.comparator=d.sortingMap[b.sorting.defaultSorting];}else{if(b.sorting.sortDealsByPrice&&!(b.lob=="lxactivities")){d.comparator=d.priceComparator;}else{delete d.comparator;}}}if(typeof d.comparator==="function"){d.sort();}if(c&&b.sorting.sortByRecentActivity&&typeof GMT.processedUad=="object"&&GMT.processedUad.length>0){delete d.comparator;var a=[];$.each(GMT.processedUad.models,function(f,e){if(b.lob=="hotel"){a=a.concat(d.where({hotelCity:e.attributes.city}));a=a.concat(d.where({city:e.attributes.city}));}else{if(b.lob=="flight"){a=a.concat(d.where({destTla:e.attributes.TLA}));a=a.concat(d.where({destMetroCode:e.attributes.TLA}));a=a.concat(d.where({destCity:e.attributes.city}));}else{if(b.lob=="package"){a=a.concat(d.where({hotelCity:e.attributes.city}));a=a.concat(d.where({destCity:e.attributes.city}));}else{if(b.lob=="thirdPartyPackage"){a=a.concat(d.where({destTla:e.attributes.TLA}));}}}}});d.uadmodels=a;d.remove(a);d.uadmodels=a.concat(d.models);d.reset(d.uadmodels);}},sortingMap:{Hotel:{0:function(a){if(this.module.useAveragePrice){return Math.round(parseFloat(a.get("averagePrice")));}else{return Math.round(parseFloat(a.get("totalPrice")));}},1:function(a){if(this.module.useAveragePrice){return Math.round(parseFloat(a.get("averagePrice"))*-1);}else{return Math.round(parseFloat(a.get("totalPrice"))*-1);}},2:function(b){var a=(parseFloat(b.get("starRating"))*-1);if(typeof a!="undefined"&&!isNaN(a)){return a;}else{return 0;}},3:function(b){var a=(parseFloat(b.get("guestRating"))*-1);if(typeof a!="undefined"&&!isNaN(a)){return a;}else{return 0;}}},Package:{0:function(a){return Math.round(parseFloat(a.get("perPsgrPackagePrice")));},1:function(a){return Math.round(parseFloat(a.get("perPsgrPackagePrice"))*-1);},2:function(b){var a=(parseFloat(b.get("starRating"))*-1);if(typeof a!="undefined"&&!isNaN(a)){return a;}else{return 0;}},3:function(b){var a=(parseFloat(b.get("guestRating"))*-1);if(typeof a!="undefined"&&!isNaN(a)){return a;}else{return 0;}}},Flight:{0:function(a){return Math.round(parseFloat(a.get("flightPerPsgrBaseFarePlusTax")));},1:function(a){return Math.round(parseFloat(a.get("flightPerPsgrBaseFarePlusTax"))*-1);}},ThirdPartyPackage:{0:function(a){return Math.round(parseFloat(a.get("perPsgrPackagePrice")));},1:function(a){return Math.round(parseFloat(a.get("perPsgrPackagePrice"))*-1);},2:function(b){var a=(parseFloat(b.get("starRating"))*-1);if(typeof a!="undefined"&&!isNaN(a)){return a;}else{return 0;}},3:function(b){var a=(parseFloat(b.get("guestRating"))*-1);
if(typeof a!="undefined"&&!isNaN(a)){return a;}else{return 0;}}},none:function(a){if(a.hasOwnProperty("attributes")&&a.attributes.hasOwnProperty("sortId")&&typeof a.attributes.sortId!="undefined"&&a.attributes.sortId!=""&&a.attributes.sortId!=undefined){return a.attributes.sortId;}else{return parseInt(a.cid.match(/\d{1,}/)[0]);}}}});GMT.extend(GMT.Deals.prototype,{ModuleFiltering:function(a){var b=this;b.module=a.parentContext;b.config=b.module.filtering;b.dealsModule=b.module.dealsModule;b.getDestinationsData={};b.el=$("#filterContainer-tab-"+b.module.i);b.historyFlag=false;b.init();},ModuleFilteringCS:function(a){var b=this;b.module=a.parentContext;b.config=b.module.filtering;b.dealsModule=b.module.dealsModule;b.el=$("#filterContainer-tab-"+b.module.i);b.historyFlag=false;b.config.deeplinkHash=GMT.history.deeplinkedTabIndex!=""?"offertab="+GMT.history.deeplinkedTabIndex:"offertab=0";if(b.module.lob==="hotel"){b.config.filterOptions={country:"country",city:"city"};if(b.dealsModule.activeModule.filtering.defaultFiltering.dealFinderDeepLink===true){b.config.deeplinkHash=b.config.deeplinkHash+((b.config.defaultFiltering.destCountry!==""&&b.config.deeplinkHash.indexOf("country")==-1)?("&country="+b.config.defaultFiltering.destCountry):"")+((b.config.defaultFiltering.destinationCity!==""&&b.config.deeplinkHash.indexOf("city")==-1)?"&city="+b.config.defaultFiltering.destinationCity:"");if(window.location.hash.match(/offertab=\d{1}&((country{1}|city{1}|originCity{1}|destCity{1})=\w{1,}|page=\d{1})/)===null&&b.module.i===b.dealsModule.activeModule.i){window.location.hash=window.location.hash.length>0?window.location.hash+"&"+b.config.deeplinkHash:window.location.hash+"#"+b.config.deeplinkHash;}}}if(b.module.lob==="package"||b.module.lob==="flight"||b.module.lob==="thirdpartypackage"){b.config.filterOptions={originCity:"originCity",city:"destCity"};if(b.dealsModule.activeModule.filtering.defaultFiltering.dealFinderDeepLink===true){b.config.deeplinkHash=b.config.deeplinkHash+((b.config.defaultFiltering.originCity!==""&&b.config.deeplinkHash.indexOf("originCity")==-1)?("&originCity="+b.config.defaultFiltering.originCity):"")+((b.config.defaultFiltering.destinationCity!==""&&b.config.deeplinkHash.indexOf("destCity")==-1)?"&destCity="+b.config.defaultFiltering.destinationCity:"");if(window.location.hash.match(/offertab=\d{1}&((country{1}|city{1}|originCity{1}|destCity{1})=\w{1,}|page=\d{1})/)===null&&b.module.i===b.dealsModule.activeModule.i){window.location.hash=window.location.hash.length>0?window.location.hash+"&"+b.config.deeplinkHash:window.location.hash+"#"+b.config.deeplinkHash;}}}b.init();}});GMT.extend(GMT.Deals.prototype.ModuleFiltering.prototype,{init:function(a){try{var f=this,d=f.dealsModule,b=f.module;f.expectedSortingModulesLength=d.modules.length;f.sortingHtml=[];f.sortingReady=false;f.domc={addonContainer:$("#addon-container-"+f.module.i)};$.ajax({url:b.destinationUrl,dataType:"jsonp",success:function(e){f.getDestinationsData=GMT.parseOSGetDestinations(e,f.config.defaultFiltering);f.render({data:f.getDestinationsData,filterContainer:f.el});GMT.history.goNoGoForHistory(d,b);}});f.bindEvents();if(!f.historyFlag&&GMT.history.enabled){f.historyRouteUpdate();}GMT.utils.makeElementSticky();}catch(c){console.log("GMT.Deals.ModuleFiltering - init says ",c);}},render:function(a){var d=this,c=d.dealsModule,b=d.module;a.GmtFiltersLocTags=GMT.loc.filtering;a.tabIndex=d.module.i;if(typeof GMT.templates["filters-tpl"]==="function"){a.filterContainer.html("").append(GMT.templates["filters-tpl"](a));if(d.config.defaultFiltering.destinationCity!==""&&d.getDestinationsData.hasOwnProperty("destinationCity")){d.getDestinationsData.destinationCity[d.config.defaultFiltering.destinationCity].selected=false;}if(d.config.defaultFiltering.originCity!==""&&d.getDestinationsData.hasOwnProperty("originCity")){d.getDestinationsData.originCity[d.config.defaultFiltering.originCity].selected=false;}if(d.config.defaultFiltering.destCountry!==""&&d.getDestinationsData.hasOwnProperty("destinationCountry")){d.getDestinationsData.destinationCountry[d.config.defaultFiltering.destCountry].selected=false;}}},bindEvents:function(){var c=this,b=c.dealsModule,a=c.module;c.el.on("change",function(k,p){var g=$(k.target);if(k.target.nodeName=="SELECT"&&g.hasClass("filter-select")){var d=$(g.data("paired-with")),l=d.val(),j=d.children(),n=g.children(),f=g.data("tab-index"),i={};i.options={},filterBy=g.data("filter-by"),selection=g.val(),c.filtersStateModel={};if(g.hasClass("select-destinationCountry")){if(selection=="-1"){i.options.destinationCity=c.getDestinationsData.destinationCity;i.reset=true;}else{i.options.destinationCity=c.getDestinationsData.destinationCountry[selection].destinationCity;}c.render({data:i,filterContainer:d});c.filtersStateModel={destinationCountry:selection=="-1"?"":selection,destinationCity:d.val()=="-1"?"":d.val(),pageNumber:"1"};if(typeof dctk!="undefined"&&dctk.hasOwnProperty("omtr")){dctk.trackAction(b.activeModule.dealsRfrr+".Deals.Filter.Country",k.target,{});}else{if(typeof window.s_exp_trackClick!="undefined"){window.s_exp_trackClick(k.target,"a",b.activeModule.dealsRfrr+".Deals.Filter.Country");}}}else{if(g.hasClass("select-originCity")){var m=typeof g.children(":selected").data("user-action")==="undefined"?false:true;if(selection=="-1"){i.options.destinationCity=c.getDestinationsData.destinationCity;d.removeAttr("disabled","disabled");i.reset=true;i.originCity=true;}else{i.options.destinationCity=c.getDestinationsData.originCity[selection].destinationCity;if(c.getDestinationsData.originCity[selection].length==1){for(var o in c.getDestinationsData.originCity[selection].destinationCity){c.getDestinationsData.originCity[selection].destinationCity[o].selected=true;}d.attr("disabled","disabled");}else{d.removeAttr("disabled","disabled");}}if(!m){c.render({data:i,filterContainer:d});}c.filtersStateModel={originCity:selection=="-1"?"":selection,destinationCity:d.val()=="-1"?"":d.val(),pageNumber:"1"};if(typeof dctk!="undefined"&&dctk.hasOwnProperty("omtr")){dctk.trackAction(c.module.dealsRfrr+".Deals.Filter.Departure",k.target,{});}else{if(typeof window.s_exp_trackClick!="undefined"){window.s_exp_trackClick(k.target,"a",c.module.dealsRfrr+".Deals.Filter.Departure");}}}else{if(g.hasClass("select-destinationCity")){var h=typeof g.children(":selected").data("user-action")==="undefined"?true:false;if(selection=="-1"){if(c.getDestinationsData.hasOwnProperty("destinationCountry")){i.options.destinationCountry=c.getDestinationsData.destinationCountry;}else{if(c.getDestinationsData.hasOwnProperty("originCity")){i.options.originCity=c.getDestinationsData.originCity;}}d.removeAttr("disabled","disabled");}else{i.options=c.getDestinationsData.destinationCity[selection];if(i.options.length==1){if(c.getDestinationsData.destinationCity[selection].hasOwnProperty("destinationCountry")&&!h){c.getDestinationsData.destinationCity[selection].destinationCountry[g.children(":selected").data("origin")].selected=true;}else{if(c.getDestinationsData.destinationCity[selection].hasOwnProperty("originCity")&&!h){c.getDestinationsData.destinationCity[selection].originCity[g.children(":selected").data("origin")].selected=true;}}if(l=="-1"){d.attr("disabled","disabled");}}else{i.reset=true;d.removeAttr("disabled","disabled");}}if(!h){c.render({data:i,filterContainer:d});}if(c.getDestinationsData.hasOwnProperty("destinationCountry")){c.filtersStateModel={destinationCountry:d.val()=="-1"?"":d.val(),destinationCity:selection=="-1"?"":selection,pageNumber:"1"};}else{if(c.getDestinationsData.hasOwnProperty("originCity")){c.filtersStateModel={originCity:d.val()=="-1"?"":d.val(),destinationCity:selection=="-1"?"":selection,pageNumber:"1"};}}if(typeof dctk!="undefined"&&dctk.hasOwnProperty("omtr")){dctk.trackAction(c.module.dealsRfrr+".Deals.Filter.City",k.target,{});}else{if(typeof window.s_exp_trackClick!="undefined"){window.s_exp_trackClick(k.target,"a",c.module.dealsRfrr+".Deals.Filter.City");}}}}}GMT.Events.trigger("GMT.filtering.change",{filterBy:filterBy,selection:selection,module:c.module,el:g,filterContainer:c.el,filters:c.filtersStateModel});
}if(c.domc.addonContainer.hasClass("sticky")){$("html,body").animate({scrollTop:GMT.domc.siteContent.offset().top});}});},historyRouteUpdate:function(){var b=this,a=GMT.history;GMT.Events.on("GMT.history.route.update",function(){GMT.Events.on("GMT.filtering.change",function(c){if(typeof a==="object"&&window.location.hash!==""&&$(".pagination:visible").length>0){GMT.Events.trigger("pagination.pageChanged",{pageNumber:1});}});});}});GMT.extend(GMT.Deals.prototype.ModuleFilteringCS.prototype,{init:function(){try{var f=this,d=f.dealsModule,b=f.module;f.module;f.modules=[];f.uniqueDropDownVals;f.dropDownHtml="";f.uniqueCities;f.uniqueCountry;f.uniqueDepatures;f.addon=$(".addon-container");f.siteContentTop=$("#siteContent").offset().top;f.expectedModulesLength=$("#offerTabs .tab").length;if(!f.historyFlag&&GMT.history.enabled){f.historyRouteCallback();f.historyRouteUpdate();}for(var a in f.config.filterOptions){f.filterBy=f.config.filterOptions[a];f.getDistinctDropDownVals(f.filterBy,f.module.parsedData);if(f.uniqueDropDownVals.length===0){return;}f.renderDropDown(function(){f.disableSelect();f.bindEvents(f.select);});}GMT.history.goNoGoForHistory(d,b);GMT.utils.makeElementSticky();}catch(c){console.log("GMT.Deals.ModuleFilteringCS - init says ",c);}},getDistinctDropDownVals:function(a,f){var e=this;e.uniqueDropDownVals=[];for(var c=f.length-1;c>=0;c--){var b=f[c],d=b[a];if(typeof d!=="undefined"){if(e.uniqueDropDownVals.indexOf(d)<0){e.uniqueDropDownVals.push(d);}}}e.uniqueDropDownVals.sort();},renderDropDown:function(h){var g=this,a=g.filterBy,f=g.config.defaultFiltering,d="",e="select-"+a+"-tab-"+g.module.i,b="all",c=a;if(typeof GMT.loc.filtering!=="undefined"){if(a=="country"||a=="destCountry"){b=GMT.loc.filtering.countriesDefaultOpt;c=GMT.loc.filtering.countryLabel;}if(a=="city"||a=="destCity"){b=GMT.loc.filtering.citiesDefaultOpt;c=GMT.loc.filtering.cityLabel;}if(a=="originCity"){b=GMT.loc.filtering.departuresDefaultOpt;c=GMT.loc.filtering.departureLabel;}}d="<option value='-1'>"+b+"</option>";if(g.uniqueDropDownVals.length>1){$.each(g.uniqueDropDownVals,function(j,k){if(f.dealFinderDeepLink==="true"&&(f.destinationCity===k||f.originCity===k||f.destCountry===k)){d+='<option value="'+k+'" selected="selected">'+k+"</option>";}else{d+='<option value="'+k+'" >'+k+"</option>";}});}else{d+='<option value="'+g.uniqueDropDownVals[0]+'" selected="selected">'+g.uniqueDropDownVals[0]+"</option>";}g.dropDownHtml="<label class='select icon icon-toggle180'><span class='inline-label'>"+c+": </span><select id='"+e+"' data-filter-by='"+a+"' data-tab-index='"+g.module.i+"'>"+d+"</select></label>";g.el.append(g.dropDownHtml);g.select=$("#select-"+g.filterBy+"-tab-"+g.module.i);if(typeof h=="function"){h();}},disableSelect:function(){var a=this;if(a.uniqueDropDownVals.length>1){a.select.prop("disabled",false);}else{a.select.prop("disabled","disabled");}},bindEvents:function(a){var c=this,b=c.dealsModule;a.on("change",function(){var e=$(this),d=setInterval(function(){if(b.activeModule.filtering.hasOwnProperty("instance")){GMT.Events.trigger("GMT.filteringCS.change",{filterObj:b.activeModule.filtering.instance,filterBy:e.data("filterBy"),selection:e.val(),module:b.activeModule,el:e});clearInterval(d);}else{return false;}},100);});},filterCollection:function(a,b){if(typeof a!=="undefined"){b.reset(b.where(a));}return b;},getCitiesOnChange:function(b,f,e){var d=this;d.uniqueCities=uniqueCities=[];for(var a=0;a<e.length;a++){var c=e[a];if(typeof c[b.country]!=="undfined"){if(c[b.country]==f){if(uniqueCities.indexOf(c[b.city])<0){uniqueCities.push(c[b.city]);}}}if(typeof c[b.originCity]!=="undfined"){if(c[b.originCity]==f){if(uniqueCities.indexOf(c[b.city])<0){uniqueCities.push(c[b.city]);}}}}uniqueCities.sort();},getCountryOnChange:function(b,f,e){var d=this;d.uniqueCountry=uniqueCountry=[];for(var a=0;a<e.length;a++){var c=e[a];if(c[b.city]==f){if(uniqueCountry.indexOf(c[b.country])<0){uniqueCountry.push(c[b.country]);}}}},getDeparturesOnChange:function(b,f,e){var d=this;d.uniqueDepatures=uniqueDepatures=[];for(var a=0;a<e.length;a++){var c=e[a];if(c[b.city]==f){if(uniqueDepatures.indexOf(c[b.originCity])<0){uniqueDepatures.push(c[b.originCity]);}}}uniqueDepatures.sort();},selectCountry:function(a,b){var d=this;var c=d.uniqueCountry.toString();$("#select-"+a.country+"-tab-"+b+" option").filter(function(){return($(this).val()==c);}).prop("selected",true);},selectCity:function(a,c,b){$("#select-"+a.city+"-tab-"+b+" option").filter(function(){return($(this).val()==c);}).prop("selected",true);},selectDeparture:function(a,c,b){$("#select-"+a.originCity+"-tab-"+b+" option").filter(function(){return($(this).val()==c);}).prop("selected",true);},populateCityDropDown:function(d,a,c){var b;if(a.length>1){$("#select-"+d+"-tab-"+c).prop("disabled",false);b="<option value='-1'>"+GMT.loc.filtering.citiesDefaultOpt+"</option>";}else{$("#select-"+d+"-tab-"+c).prop("disabled","disabled");}$.each(a,function(e,f){b+='<option value="'+f+'">'+f+"</option>";});$("#select-"+d+"-tab-"+c).html(b);},populateDepDropDown:function(d,a,c){var b="";if(a.length>1){$("#select-"+d+"-tab-"+c).prop("disabled",false);b="<option value='-1'>"+GMT.loc.filtering.departuresDefaultOpt+"</option>";}else{$("#select-"+d+"-tab-"+c).prop("disabled","disabled");}$.each(a,function(e,f){b+='<option value="'+f+'">'+f+"</option>";});$("#select-"+d+"-tab-"+c).html(b);},historyRouteCallback:function(){var a=this;GMT.Events.on("GMT.history.route.callback",function(){var b=GMT.history.currentRoute,c=(function(){if(GMT.history.firstLoad&&GMT.history.deeplinkedTabIndex!==""&&GMT.utils.getQueryParamValue(b,"offertab")===false){return GMT.history.deeplinkedTabIndex;}else{if(typeof b==="undefined"){if(GMT.history.deeplinkedTabIndex!==""){return GMT.history.deeplinkedTabIndex;}else{return 0;}}else{if(GMT.utils.getQueryParamValue(b,"offertab")!==false){return parseInt(GMT.utils.getQueryParamValue(b,"offertab"));}else{return 0;}}}})(),e=$("#filterContainer-tab-"+c);if(e.length>0&&typeof b==="string"){var d;if(b.indexOf("country")>-1){d=GMT.utils.getQueryParamValue(b,"country");if(d!="-1"){$("#select-country-tab-"+c).val(d).trigger("change");$("#select-destCountry-tab-"+c).val(d).trigger("change");}}if(b.indexOf("city")>-1){d=GMT.utils.getQueryParamValue(b,"city");if(d!="-1"){$("#select-city-tab-"+c).val(d).trigger("change");$("#select-destCity-tab-"+c).val(d).trigger("change");}}if(b.indexOf("destCity")>-1){d=GMT.utils.getQueryParamValue(b,"destCity");if(d!="-1"){$("#select-destCity-tab-"+c).val(d).trigger("change");}}if(b.indexOf("originCity")>-1){d=GMT.utils.getQueryParamValue(b,"originCity");if(d!="-1"){$("#select-originCity-tab-"+c).val(d).trigger("change");}}}});a.historyFlag=true;},historyRouteUpdate:function(){var c=this,b=c.dealsModule,a=GMT.history;GMT.Events.on("GMT.history.route.update",function(){GMT.Events.on("GMT.filteringCS.change",function(f){var i=f.filters,e=f.filterBy,h=f.selection,g=$(f.el);if(g.is(":visible")&&typeof a=="object"){var d=parseInt(g.attr("data-tab-index"));a.previousRoute=window.location.hash;if(a.firstLoad){a.router.navigate("offertab="+d+"&"+e+"="+h);}a.firstLoad=false;if(a.previousRoute!==""){a.router.navigate("offertab="+d+"&"+e+"="+h);}a.currentRoute=window.location.hash;if(a.previousRoute===""&&a.currentRoute===""){a.firstLoad=true;}}});});}});GMT.extend(GMT,{Countdown:function(a){var b=this;b.el=$(a.el);b.GMT=a.parentContext;b.tickTime=b.el.attr("data-test")=="true"?100:1000;b.timer=true;b.init();}});GMT.extend(GMT.Countdown.prototype,{setDomc:function(c){var b=this,a=b.el.find(".mask");b.domc={mask:a,end:a.find(".ended"),secs:a.find(".secs .d"),mins:a.find(".mins .d"),hrs:a.find(".hrs .d"),days:a.find(".days .d"),lbl:a.find(".lbl"),cta:a.find(".cta"),lblDays:a.find(".lblDays"),lblDay:a.find(".lblDay"),lblHrs:a.find(".lblHrs"),lblHr:a.find(".lblHr"),lblMins:a.find(".lblMins"),lblMin:a.find(".lblMin"),lblSecs:a.find(".lblSecs"),lblSec:a.find(".lblSec")};if(typeof c=="function"){c();}},init:function(){var a=this;
a.setDomc(function(){a.iSecs=a.domc.secs.html(),a.sSecs="",a.sMins=a.domc.mins.html(),a.sHrs=a.domc.hrs.html(),a.sDays=a.domc.days.html(),a.tick();});},addZero:function(b){var a=this;if(b.toString().length===1){b="0"+b;}return b;},toggle:function(c,b,d){var a=this;if(d==="01"){c.addClass("hidden");b.removeClass("hidden");}else{b.addClass("hidden");c.removeClass("hidden");}},endPromo:function(){var b=this,a=b.domc;a.mask.find(".secs").hide();a.mask.find(".mins").hide();a.mask.find(".hrs").hide();a.mask.find(".days").hide();a.lbl.hide();a.cta.hide();a.end.css("display","block");b.timer=false;GMT.Events.trigger("GMT.countdown.finished",{countdown:b});},tick:function(){var b=this;if(b.timer){var a=setTimeout(function(){b.iSecs=parseInt(b.iSecs,10);if(b.iSecs!==0){b.sSecs=b.iSecs--;b.sSecs=b.addZero(b.iSecs);if(b.iSecs===0){b.sMins=parseInt(b.sMins,10);if(b.sMins!==0){b.sMins--;if(b.sMins===0){b.sHrs=parseInt(b.sHrs,10);if(b.sHrs!==0){b.sHrs--;if(b.sHrs===0){b.sDays=isNaN(b.sDays)?0:b.sDays;b.sDays=parseInt(b.sDays,10);if(b.sDays!==0){b.sDays--;if(b.sDays===0||isNaN(b.sDays)){b.days.hide();b.sHrs=23;}else{b.sHrs=0;}}b.sMins=59;b.sDays=b.addZero(b.sDays);b.domc.days.html(b.sDays);b.toggle(b.domc.lblDays,b.domc.lblDay,b.domc.sDays);}}else{b.sSecs=b.iSecs=59;}b.sHrs=b.addZero(b.sHrs);b.domc.hrs.html(b.sHrs);b.toggle(b.domc.lblHrs,b.domc.lblHr,b.domc.sHrs);}b.sMins=b.addZero(b.sMins);}else{if((b.sHrs==="00"||b.sHrs===0)&&(b.domc.days.length==0||b.sDays==="00")){b.endPromo(a);}else{b.sDays=isNaN(b.sDays)?0:b.sDays;b.sDays=parseInt(b.sDays,10);b.sHrs=parseInt(b.sHrs,10);if(b.sDays!==0){if(b.sHrs===0){b.sDays--;}if(b.sDays===0||isNaN(b.sDays)){b.days.hide();}}if((b.sDays===0||isNaN(b.sDays))&&b.sHrs>0){b.sHrs--;}else{b.sHrs=23;}b.sMins=59;b.sDays=b.addZero(b.sDays);b.domc.days.html(b.sDays);b.sHrs=b.addZero(b.sHrs);b.domc.hrs.html(b.sHrs);b.toggle(b.domc.lblDays,b.domc.lblDay,b.domc.sDays);}}b.sMins=b.addZero(b.sMins);b.domc.mins.html(b.sMins);b.toggle(b.domc.lblMins,b.domc.lblMin,b.domc.sMins);}}else{b.sSecs=b.iSecs=59;}b.domc.secs.html(b.sSecs);b.toggle(b.domc.lblSecs,b.domc.lblSec,b.domc.sSecs);b.tick();},b.tickTime);}}});GMT.extend(GMT.history,{started:Backbone.History.started,firstLoad:true,previousRoute:"",currentRoute:"",Router:Backbone.Router.extend({routes:{"":"routeCallback","*route":"routeCallback"},routeCallback:function(a){GMT.history.currentRoute=a;GMT.Events.trigger("GMT.history.route.callback");}}),init:function(){GMT.history.router=new GMT.history.Router();GMT.history.bindEvents();GMT.history.deeplinkedTabIndex();},deeplinkedTabIndex:function(){var b=window.location.href,a=[],d="",c=/(&|\?)tab=\d{1,}/;if(b.indexOf("#")){a=b.split("#");b=a[0];}if(b.indexOf("?")&&c.test(b)){a=b.split("?");GMT.history.deeplinkedTabIndex=parseInt(GMT.utils.getQueryParamValue(a[1],"tab"))-1;}else{GMT.history.deeplinkedTabIndex="";}},bindEvents:function(){var a=this;GMT.Events.on("GMT.history.start",function(b){if(!Backbone.History.started&&GMT.history.enabled){Backbone.history.start();GMT.history.started=Backbone.History.started;GMT.Events.trigger("GMT.history.route.update");}else{return false;}});},goNoGoForHistory:function(d,c){var b=$("#offers-wrapper-"+c.i),a=$("#offerTabs .tab:visible");if((a.length==0&&b.length>0&&b.length==d.setViews.length)||(b.length==0&&a.length>0)&&!GMT.history.started){GMT.Events.trigger("GMT.history.start");}}});var GmtRVSModule=(function(){var w={},g={},t=[],f=[],h=[],b=[],p,r=4,l=function(z){try{w=z||w;g.UAD=w;if((typeof w.viewedHotels==="object"&&w.viewedHotels.length>0)||(typeof w.viewedPackages==="object"&&w.viewedPackages.length>0)||(typeof w.searchedPackages==="object"&&w.searchedPackages.length>0)||(typeof w.searchedFlights==="object"&&w.searchedFlights.length>0)){d({viewedHotels:(w.viewedHotels.length>0)?"true":"false",viewedSearchesPackages:(w.viewedPackages.length>0||w.searchedPackages.length>0)?"true":"false",searchedFlights:(w.searchedFlights.length>0)?"true":"false"});o();v();a();if(t.length>0){for(var A=0;A<t.length;A++){f.push(t[A].hotelId);}i({template:GMT.templates["rv-hotels-tpl"],rvData:t,tabContentContainer:$("#hotel-tab-content")});k();}if(b.length>0){i({template:GMT.templates["rs-flights-tpl"],rvData:b,tabContentContainer:$("#flight-tab-content")});}if(h.length>0){i({template:GMT.templates["rvs-packages-tpl"],rvData:h,tabContentContainer:$("#package-tab-content")});}$("#rv-container .tabs-container").find(".tab-pane").each(function(D){var E=$(this),C=E.find(".box");if(C.length%2>0){E.find(".cols-row").append("<article class='box placeholder even'></article>");}C.each(function(F,G){if(F%2>0){$(G).addClass("even");}});});y();}}catch(B){console.log(B);}},o=function(){var A=0,D=(w.viewedHotels)?w.viewedHotels.length:0,z=0;while(z<r&&(A<D)){var B=w.viewedHotels[A],C=j(B,"hotel",A++);t.push(C);z++;}},v=function(){function C(K,L,J,M){if(K<L){var N=new Date(J[K].searchedDate||J[K].viewedDate);if(E==""||N>E){E=N;A=M;}}}var G=rsP_index=0,B=(w.viewedPackages)?w.viewedPackages.length:0,H=(w.searchedPackages)?w.searchedPackages.length:0,z=0;while(z<r&&(rsP_index<H||G<B)){var E="",A="";C(rsP_index,H,w.searchedPackages,"rsP");C(G,B,w.viewedPackages,"rvP");var I;if(A=="rsP"){var F=w.searchedPackages[rsP_index];I=n(F,"package",rsP_index++);}else{if(A=="rvP"){var D=w.viewedPackages[G];I=j(D,"package",G++);}}h.push(I);z++;}},a=function(){var D=0,B=(w.searchedFlights)?w.searchedFlights.length:0,A=0;while(A<r&&(D<B)){var z=w.searchedFlights[D],C=n(z,"flight",D++);b.push(C);A++;}},n=function(P,J,H){var A={};if(J=="package"){A.rvType="rsP";A.id="rsP"+H;A.isRSP=true;A.thumbnail=(P.thumbnail)?"//images.trvl-media.com"+P.thumbnail.replace("_t","_s"):"";var F=[],z=true,B="&ttla="+P.originTLA,N="&ftla="+P.destinationTLA,L="&destination="+P.destination.city,K="&fromDate="+m(P.departureDate),G="&toDate="+m(P.returnDate);$.each(P.travelerUnits,function(Q,R){var S={};S.adults=R.numberOfAdults;S.children=R.childAges;F.push(S);z=!R.infantInLap;});var I="&NumRoom=1",E="&NumAdult=2";if(P.origin&&P.origin.city&&P.destination&&P.destination.city){A.origin=P.origin.city;A.destination=P.destination.city;}A.localizedPageUrl="/packagesearch?"+B+N+L+K+G+I+E;}if(J=="flight"){A.isRSF=true;A.localizedPageUrl=P.searchUrl;A.rvType="rsF";A.id="rsF"+H;A.originTLA=P.originTLA;A.destTLA=P.destinationTLA;A.price=P.price;A.originCity=P.origin.city;A.destCity=P.destination.city;A.flightType=P.flightType;if(A.flightType=="ROUND_TRIP"){A.isRoundTrip=true;var D=P.searchUrl.indexOf("departure")+10,C=P.searchUrl.indexOf("TANYT",D),M=P.searchUrl.indexOf("departure",C)+10,O=P.searchUrl.indexOf("TANYT",M);A.localizedPageUrl=P.searchUrl.substring(0,D)+m(P.departureDate)+P.searchUrl.substring(C,M)+m(P.returnDate)+P.searchUrl.substring(O);}else{if(A.flightType=="MULTIPLE_DESTINATION"){A.isMultipleDestination=true;}else{if(A.flightType=="ONE_WAY"){A.isOneWay=true;var D=P.searchUrl.indexOf("departure")+10;var C=P.searchUrl.indexOf("TANYT",D);A.localizedPageUrl=P.searchUrl.substring(0,D)+m(P.departureDate)+P.searchUrl.substring(C);}}}A.travelerUnit=P.travelerUnit;}A.departureDate=P.departureDate;A.returnDate=P.returnDate;A.isRS=true;A.sfid=P.cacheKey;return A;},j=function(B,A,z){var C={};C.isRV=true;C.hotelId=B.hotelId;C.hotelName=B.hotelName;C.localizedPageUrl=B.localizedPageUrl;C.thumbnail=(B.thumbnail)?"//images.trvl-media.com"+B.thumbnail.replace("_t","_s"):"";C.city=B.regionLongName.substr(0,B.regionLongName.indexOf(","))||B.regionLongName;C.checkInDate=B.checkInDate;C.checkOutDate=B.checkOutDate;if(A=="package"){C.id="rvP"+z+"-"+B.hotelId;C.rvType="rvP";C.isRVP=true;C.price=(B.packagePricePerPerson&&B.packagePricePerPerson.amount)?B.packagePricePerPerson.amount:"";if(B.packageSavings&&B.packageSavings.amount>0){C.packageSavings=B.packageSavings.amount;}if(B.origin&&B.origin.city&&B.destination&&B.destination.city){C.origin=B.origin.city;C.destination=B.destination.city;}}if(A=="hotel"){C.id="rvH"+z+"-"+B.hotelId;C.rvType="rvH";C.isRVH=true;if(B.price&&B.price.amount){C.price=B.price.amount;
}}return C;},m=function(A){var B=new Date(A),z=B.getFullYear()+","+(parseInt(B.getMonth(),10)+1)+","+B.getDate();return GMT.utils.formatDate(z,"");},d=function(z){var C,B,A;B=GMT.templates["rvs-container-tpl"],A=B(z);$(A).insertAfter("#rvPlaceholder");u();},u=function(){p=$("#rv-container .tabs");var z=p.children("li").first().children("a");z.trigger("click");if(p.children("li").length==1){p.hide();}else{p.show();}},i=function(D){var E,B,A,B=D.template,C=D.rvData,z=D.tabContentContainer;A=B(C);$(A).appendTo(z);},s=function(A){var B=A.attr("id"),z=A.attr("data-rv-type");if(z.length==0){return false;}A.remove();c();if(z=="rvH"){B=B.split("-")[1];}else{if(z=="rvP"){B="VP-"+B.split("-")[1];}else{if(z=="rsP"){B="SP-"+A.attr("sfid");}else{if(z=="rsF"){B=A.attr("sfid");}}}}q(B);},c=function(){$("article.placeholder:visible").remove();$(".rv-container .even:visible").removeClass("even");$(".rv-container").find(".box:visible:odd").addClass("even");if($("#rv-container .box:visible").length%2>0){$("#rv-container .cols-row:visible").append("<article class='box placeholder even'></article>");}if($("#rv-container .box:visible").length==0){$("#rv-container .cols-row:visible").append("<article class='box placeholder'></article><article class='box placeholder even'></article>");}},q=function(z){$.ajax({url:"/UserActivityData/notInterested?id="+z,cache:false});},y=function(){var z=$(".rv-remove");z.off("click touchstart").on("click touchstart",function(B){B.preventDefault();var A=$(this).closest(".box");s(A);});},k=function(){if(f.length>0){e(f);}},e=function(z){var A="";$.each(z,function(B,C){A=A+"&hotelId="+C;});$.ajax({dataType:"json",url:"/UserActivityDataAjax/getAdditionalHotelAvailInfo?"+A,success:x,cache:false,timeout:5000});},x=function(z){if(z!==null){if(typeof z=="string"){if(z.substring(0,5)==="Error"){return false;}dataArray=JSON.parse(z);}else{dataArray=z;}for(var A=0;A<dataArray.length;A++){data=dataArray[A];if(data.freeCancellation){var B=$("#locString-freeCancellation").text();$("[data-hotelId="+data.hotelId+"] .rv-price-info").append('<span class="price-info-additional free-cancellation" style="display:none;">'+B+"</span>");}else{if(data.numberOfRoomsLeft&&parseInt(data.numberOfRoomsLeft)>0){var C=(data.numberOfRoomsLeft>1)?$("#locString-roomsLeft").text():$("#locString-roomLeft").text();C=C.replace("###",data.numberOfRoomsLeft);$("[data-hotelId="+data.hotelId+"] .rv-price-info").append('<span class="price-info-additional number-of-rooms-left" style="display:none;">'+C+"</span>");}}}$(".free-cancellation, .number-of-rooms-left").fadeIn(1000);}};return{init:l,RVS:g};})();GMT.extend(GMT,{utils:{overRideUITKDateSettings:function(){var a=$('input[name$="Date"]');if(a.length>0&&typeof uitk=="object"&&uitk.hasOwnProperty("datePickerCalendarObj")&&typeof uitk.init=="function"&&typeof uitk.refreshPlaceholders=="function"){var b=window.location.host,c=uitk.datePickerCalendarObj.config;if(GMT.locale=="en_US"&&((b.indexOf(".com.tw")!=-1||b.indexOf("comtw.")!=-1)||(b.indexOf(".co.jp")!=-1||b.indexOf("cojp.")!=-1)||(b.indexOf(".co.jp")!=-1||b.indexOf("cojp.")!=-1))||(GMT.locale=="en_HK"&&(b.indexOf("com.hk")!=-1||b.indexOf("comhk.")!=-1))){c.setFormatConfig("yymmdd","/");c.setUnitConfig(0,["January","February","March","April","May","June","July","August","September","October","November","December"],["S","M","T","W","T","F","S"]);c.setTextConfig("Close");uitk.init();a.attr("placeholder","yyyy/mm/dd");}else{if(GMT.locale=="en_US"&&((b.indexOf(".co.kr")!=-1||b.indexOf("cokr.")!=-1))){c.setFormatConfig("yymmdd",".");c.setUnitConfig(0,["January","February","March","April","May","June","July","August","September","October","November","December"],["S","M","T","W","T","F","S"]);c.setTextConfig("Close");uitk.init();a.attr("placeholder","yyyy.mm.dd");}else{if(GMT.locale=="ko_KR"&&((b.indexOf(".co.kr")!=-1||b.indexOf("cokr.")!=-1))){c.setFormatConfig("yymmdd",".");uitk.init();a.attr("placeholder","yyyy.mm.dd");}else{if(GMT.locale=="sv_SE"){c.setFormatConfig("yymmdd","-");uitk.init();}else{if(GMT.locale=="nl_NL"){c.setFormatConfig("ddmmyy","-");uitk.init();}else{if(GMT.locale=="fr_CH"||GMT.locale=="fi_FI"||GMT.locale=="nb_NO"){c.setFormatConfig("ddmmyy",".");uitk.init();}else{if((GMT.siteid=="1"||GMT.siteid=="100008")&&GMT.langId=="2058"){c.setFormatConfig("mmddyy","/");uitk.init();a.attr("placeholder","mm/dd/aaaa");}}}}}}}uitk.refreshPlaceholders();}},enableMobileDeeplinking:function(){return(GMT.brand.isExp&&(GMT.options.isMobilePhone||GMT.options.isTablet))?true:false;},scrollToDeals:function(){var a=$(".site-content").offset();a=Math.floor(a.top),currentScrollPos=$(window).scrollTop();if(currentScrollPos>a){$(window).scrollTop(a);}},getQueryParamValue:function(e,a){var c=new RegExp("&?"+a+"=");if(c.test(e)){var f=[],d=[];if(e.indexOf("&")==-1){d.push(e);}else{d=e.split("&");}for(var b=0;b<d.length;b++){var f=d[b].split("=");if(f[0]==a&&f[1]!=null){return f[1];}}}else{return false;}},updateQueryParamValue:function(g,a,f){if(g!=""){var c=new RegExp("&?"+a+"="),d=g.split("?")[0],g=g.split("?")[1];if(c.test(g)){var h=[],e=[];if(g.indexOf("&")==-1){e.push(g);}else{e=g.split("&");}for(var b=0;b<e.length;b++){var h=e[b].split("=");if(h[0]==a&&h[1]!=null){e[b]=a+"="+f;}}return d+"?"+e.join("&");}return d+"?"+g;}},isTestActive:function(b){var a=GMT.abacus||{"1234":0};if(typeof a["ab"+b]!=="undefined"&&a["ab"+b]>0){return true;}else{return false;}},clickTrack:function(a){if(window.dctk&&dctk.enabled){dctk.onReady(function(){dctk.trackAction(a,{});});}else{if(s_exp){s_exp.tl(a);}}},equalHeights:function(d,b){if(!window.isMobilePhone||!window.isTablet){var d=$(d),n=d.find("section:visible,footer:visible"),h=$([]),e=$([]),c,f=false,o,j=false,l=0,i=0,g,k,a,m;n.each(function(p){g=$(this).children("a.tile-link").eq(0).children(".tile-details");k=$(this).children("a.tile-link,div.tile-link").eq(1).children(".tile-details");if(g.length>0){h=$.merge(h,g);a=parseInt(g.height());if(typeof c=="undefined"){c=a;}if(a!=c){f=true;}if(a>c){c=a;}if(typeof k=="object"){e=$.merge(e,k);m=parseInt(k.height());if(typeof o=="undefined"){o=m;}if(m>o){o=m;}if(m!=o){j=true;}}if(p<2){if(typeof g.css("padding-bottom")!="undefined"&&typeof g.css("padding-top")!="undefined"){l=parseInt(g.css("padding-bottom"));l=l+parseInt(g.css("padding-top"));if(typeof k=="object"&&typeof k.css("padding-bottom")!="undefined"&&typeof k.css("padding-top")!="undefined"){i=parseInt(k.css("padding-bottom"));i=i+parseInt(k.css("padding-top"));}}}}});if(f){h.css({"height":(c+l)/17+"em"});}if(j){e.css({"height":(o+i)/17+"em"});}}},equalHeightsOnPromoBanners:function(d,b){var d=$(d),i=d.find("section:visible"),g=$([]),c,e=false,h=0,f,a;i.each(function(j){f=$(this).children(".tile-details");f.css({"height":"auto"});if(f.length>0){g=$.merge(g,f);a=parseInt(f.height());if(typeof c=="undefined"){c=a;}if(a!=c){e=true;}if(a>c){c=a;}if(j<2){if(typeof f.css("padding-bottom")!="undefined"&&typeof f.css("padding-top")!="undefined"){h=parseInt(f.css("padding-bottom"));h=h+parseInt(f.css("padding-top"));}}}});if(e){g.css({"height":(c+h)/17+"em"});}},makeElementSticky:function(){var b=false,a=$("#stickyAnchor");if(a.length){var c=$("#offerTabs").length?a.offset().top+$(".tabs").outerHeight():a.offset().top;uitk.subscribe("windowScroll",function(){var f=$(window).scrollTop(),d=$(".addon-container").not(":hidden"),e=f>c;if(e&&!b){d.addClass("sticky");b=true;d.parent(".tab-pane").css("margin-top",d.outerHeight());}else{if(!e&&b){d.removeClass("sticky");b=false;d.parent(".tab-pane").css("margin-top","0");}}});}},formatPrice:function(d){if(typeof d=="string"&&d!=""||typeof d=="number"){var d=d.toString(),a=GMT.locale=="id_ID"?"in_ID":GMT.locale,b=uitk.utils.createLocalizedPrice(d,a,GMT.currencyCode),c=b.roundHalfUp(),e=c.format();return e;}},formatDate:function(c,g){var i=c.toString(),i=i.replace(/[,\.]/g,"/"),h=Date.parse(i),f=new Date(h),a=GMT.locale=="id_ID"?"in_ID":GMT.locale,b=uitk.utils.createLocalizedDate(f,a),e=b.fullDate();shortDateString=b.shortDate();
if(g=="shortDate"){return shortDateString;}else{return e;}},getDateDifference:function(d,g){var i=d.toString(),i=i.replace(/[,\.]/g,"/"),j=Date.parse(i),c=new Date(j),e=g.toString(),e=e.replace(/[,\.]/g,"/"),b=Date.parse(e),f=new Date(b),a=Math.abs(f.getTime()-c.getTime()),h=Math.ceil(a/(1000*3600*24));return h;},loadIfInTest:function(b,c){var a="ab"+b;require(["dctk"],function(d){d.onReady(function(){d.evaluateExperimentAndLog({id:b,callback:function(e){if(typeof GMT.abacus!=="undefined"){GMT.abacus[a]=e.value;}if(typeof c!=="undefined"&&typeof e!=="undefined"&&typeof e.value!=="undefined"&&e.value!==0){c(e.value);}GMT.Events.trigger(a,e.value);}});});});}}});var globalUtils=GMT.utils;require(["handlebars","jquery"],function(){Handlebars.registerHelper("list",function(d,e){var b="",c,a;for(c=0,a=d.length;c<a;c++){b=b+e.fn(d[c]);}return b;});Handlebars.registerHelper("getTMDestinationUrl",function(d){var a="",b=new Date();var e=b.getMonth()+"-"+b.getDate()+"-"+parseInt(b.getHours()/12,10);if(typeof d=="object"&&typeof d.fn=="function"&&typeof d.fn(this)=="string"){a=d.fn(this)+"/";}else{if(typeof d==="string"&&d!==""){a=d+"/";}}if((GMT.abacus["ab13644"]==1||GMT.abacus&&GMT.abacus["ab13644"]==2)&&typeof require("mediaHub").dynamicUrl(this.getRegionId())!="undefined"){return require("mediaHub").dynamicUrl(this.getRegionId());}var c="//images.trvl-media.com/media/content/expuk/Images/deals/destinations/w456/missing_d.jpg";if(typeof this.attributes.regionID!=="undefined"){c=require("GMT-Services").imageRenderer+a+this.attributes.regionID+".jpg?currentCrop=true&cacheKey="+e;}return c;});Handlebars.registerHelper("isDealCount",function(c){if(typeof this.attributes.nonLocalizedCity!=="undefined"&&typeof modDestinationCount!=="undefined"){var b=this.attributes.nonLocalizedCity.replace(/ |\.|-/g,"").toLowerCase(),a=modDestinationCount.config[b];if(typeof a!=="undefined"){return c.fn(this);}}});Handlebars.registerHelper("getDealCount",function(){if(typeof this.attributes.nonLocalizedCity!=="undefined"){var b=this.attributes.nonLocalizedCity.replace(/ |\.|-/g,"").toLowerCase(),a=modDestinationCount.config[b];if(typeof a!=="undefined"){return a;}}});Handlebars.registerHelper("getTroverImgDetails",function(c){if(typeof this.attributes.nonLocalizedCity!=="undefined"){var b=this.attributes.nonLocalizedCity.replace(/ |\.|-/g,"").toLowerCase(),d=GMT.utils.getTroverDetails(b);var a=c.replace("BLOGGER",d);if(typeof d!=="undefined"){return a;}}});Handlebars.registerHelper("unescape",function(a){return unescape(a);});Handlebars.registerHelper("replace",function(d,c,b){var a=b.fn(this);return a.replace(d,c);});Handlebars.registerHelper("ifCond",function(d,a,c,b){if(typeof d==="function"){d=d(this);}if(typeof c==="function"){c=c(this);}if(typeof b!="undefined"){switch(a){case"==":return(d==c)?b.fn(this):b.inverse(this);case"===":return(d===c)?b.fn(this):b.inverse(this);case"<":return(d<c)?b.fn(this):b.inverse(this);case"<=":return(d<=c)?b.fn(this):b.inverse(this);case">":return(d>c)?b.fn(this):b.inverse(this);case">=":return(d>=c)?b.fn(this):b.inverse(this);case"!=":return(d!=c)?b.fn(this):b.inverse(this);default:return b.inverse(this);}}});Handlebars.registerHelper("showHotelDiscount",function(e,b,a){var d=GMT.locale;if(typeof a!="undefined"){var c=parseInt(a.fn(this));output=e.replace("#Percentage#",(c+"%"));if(c>0&&c<100&&c>=b){return output;}}});Handlebars.registerHelper("showPackageDiscount",function(f,b,a){var e=GMT.locale;if(typeof a!="undefined"){var d=parseInt(a.fn(this));if(typeof GMT.utils.formatPrice(d)!="undefined"){var c=GMT.utils.formatPrice(d);if(e=="ko_KR"){output=f.replace("#Price#",c.replace(/~/,""));}else{output=f.replace("#Price#",c);}if(d>=b){return output;}}}});Handlebars.registerHelper("getDateLength",function(f,d,b){var h=b.fn(this).split("-"),c=24*60*60*1000,a=h[0],g=h[1],e;a=a.split(",");a=new Date(a[0],a[1]-1,a[2]);g=g.split(",");g=new Date(g[0],g[1]-1,g[2]);e=Math.round(Math.abs((a.getTime()-g.getTime())/(c)));if(e>1){e=f.replace("#Number#",e);}else{if(e===1){e=d.replace("#Number#",e);}else{e="";}}return e;});Handlebars.registerHelper("starRatingClass",function(a){var b=a.fn(this);if(b>0){return b.replace(".","-");}});Handlebars.registerHelper("destinationPriceString",function(i){var f=parseInt(i.fn(this)),g=i.hash["lob"],h=i.hash["strikethru"],e=i.hash["finalStr"],d=i.hash["str1"],c=i.hash["str2"],b,a;if(g==="package"){a=Math.round(this.perPsgrPackagePrice+this.packagePerPsgrSavings);}else{a=Math.round(this.hotelCrossOutPriceValue);}if(h==="true"&&(a>f)){d=d.replace("#strikethruPrice#",GMT.utils.formatPrice(a));c=c.replace("#currentPrice#",GMT.utils.formatPrice(f));b=e.replace("#StrikethruPriceString#",d).replace("#CurrentPriceString#",c);}else{c=c.replace("#currentPrice#",GMT.utils.formatPrice(f));b=e.replace("#StrikethruPriceString#","").replace("#CurrentPriceString#",c);}return b;});Handlebars.registerHelper("getUrl",function(b){var a=unescape(b.fn(this));if(a.indexOf("?")==-1){a=a+"?";}else{a=a+"&";}return a;});Handlebars.registerHelper("showNumOfPeopleViewing",function(c,d,b){var e=b.fn(this),a;if(e>0){if(e==1){a=e+" "+c;}else{a=e+" "+d;}return a;}});Handlebars.registerHelper("showCrossOutPrice",function(b){var c=b.fn(this),a=GMT.utils.formatPrice(c);if(c>0){return a;}});Handlebars.registerHelper("toFromDate",function(c){var a=this.startDate;var b=this.endDate;return c.replace("#startDate#",a).replace("#endDate#",b);});Handlebars.registerHelper("impressionFrom",function(a){var d=a.fn(this);var b=this.destinationCity;var c=this.fromPrice;d=d.replace("#destinationName#",b);d=d.replace("#price#",c);return d;});Handlebars.registerHelper("travelGuideLink",function(a){return"/d.d"+a.fn(this)+".Destination-Travel-Guides";});Handlebars.registerHelper("milesFromYou",function(d,b){var c=parseInt(b.fn(this)),a=d.replace("#number#",(c));return a;});Handlebars.registerHelper("numberBooked",function(a,b){var c=(b.fn(this)||0);return(c>0)?a.replace("###",c):" ";});Handlebars.registerHelper("showGuestRating",function(d,c,b){var e=b.fn(this),a;if(GMT.locale==="da_DK"||GMT.locale==="de_DE"||GMT.locale==="nb_NO"){e=e.replace(".",",");}a='<p class="secondary tile-guestRate">'+d+" "+e+" "+c+"</p>";if(parseInt(e)>0){return a;}});Handlebars.registerHelper("formatPriceString",function(b){var d=b.hash["format"];var c=b.hash["key"];var a=b.hash["showPriceFromText"];var e=b.fn(this);switch(GMT.locale){case"ko_KR":if(a==="true"&&d!==null&&d!==undefined){e=e+d.replace(c,"");}else{e+="<strong>~</strong>";}break;default:if(a==="true"&&d!==null&&d!==undefined&&d.indexOf(c)!==-1){e=d.replace(c,e);}break;}return e;});Handlebars.registerHelper("formatPrice",function(a){return GMT.utils.formatPrice(a.fn(this));});Handlebars.registerHelper("formatRvsDate",function(b){var c=new Date(b.fn(this)),a=c.getFullYear()+","+(parseInt(c.getMonth(),10)+1)+","+c.getDate();return GMT.utils.formatDate(a,"prettyDate");});Handlebars.registerHelper("formatDate",function(a){return GMT.utils.formatDate(a.fn(this));});Handlebars.registerHelper("formatDateShort",function(a){return GMT.utils.formatDate(a.fn(this),"shortDate");});Handlebars.registerHelper("formatInputDate",function(a){return GMT.utils.formatDate(a.fn(this),"");});Handlebars.registerHelper("constructDealsRfrr",function(a){var c=(typeof this.getCity=="function")?this.getCity():"",c=(typeof c=="string")?c.replace(/ /g,""):"",b=(typeof this.getDealsRfrr=="function")?this.getDealsRfrr()+"."+(this.getIndex()+1):"";if(a=="deeplink"){return"rfrr="+b;}else{return"rfrr="+b+"."+a;}});Handlebars.registerHelper("constructDealsRfrrPremPackages",function(){var b=this.cabinClass,a;if(b=="economy"){a="GMTPremiumPackage.Econ";}else{if(b=="premium"){a="GMTPremiumPackage.PremiumEcon";}else{if(b=="business"){a="GMTPremiumPackage.Business";}else{if(b=="first"){a="GMTPremiumPackage.First";}}}}return"rfrr="+a;});Handlebars.registerHelper("inc",function(b,a){return parseInt(b)+1;});Handlebars.registerHelper("processTripType",function(b){var a=this.getTripType();
b=b.fn(this);b=b.split("|");if(a=="ROUND_TRIP"&&typeof b[0]=="string"){return b[0];}else{if(a!="ROUND_TRIP"&&typeof b[1]=="string"){return b[1];}else{return false;}}});Handlebars.registerHelper("numberPeopleViewing",function(a,b){var c=(b.fn(this)||0);return(c>0)?a.replace("###",c):" ";});Handlebars.registerHelper("if_even",function(b,a){if((b%2)==0){return a.inverse(this);}else{return a.fn(this);}});Handlebars.registerHelper("if_even",function(b,a){if((b%2)==0){return a.inverse(this);}else{return a.fn(this);}});Handlebars.registerHelper("destinationUrl",function(f,e,n){var h=this.hasHotel(),g=this.hasPackage(),j=this.hasFlight(),a=GMT.pageId,k=Handlebars.helpers.constructDealsRfrr.bind(this),l=n.fn(this),m=(f==="")?"":"class="+f,i=(e=="")?"deals":e,d="",c=k("deeplink").replace("groupByDestination","groupByDestination.destImageUrl");var b="special-imgboxPackage";if(g){d=this.getPackageDealDeepLink()+c;}else{if(h){b="special-imgboxHotel";d=this.getSimilarDeepLink()+"&"+c+"&selected="+this.getHotelId()+"&sort="+i;}else{if(j){b="special-imgboxFlight";d=this.getFlightSearchUrl()+c;}}}return'<a class="'+b+'" href="'+d+'" '+m+' tabindex="-1" aria-hidden="true">'+this.getCity()+"</a>";});Handlebars.registerHelper("destinationCityLink",function(d,c,m){var f=this.hasHotel(),e=this.hasPackage(),i=this.hasFlight(),a=GMT.pageId,j=Handlebars.helpers.constructDealsRfrr.bind(this),k=m.fn(this),l=(d==="")?"":"class="+d,g=(c=="")?"deals":c,h="",b=j("deeplink").replace("groupByDestination","groupByDestination.destImageUrl");if(e){h=this.getPackageDealDeepLink()+b+".package";}else{if(f){h=this.getSimilarDeepLink()+"&"+b+".hotel"+"&selected="+this.getHotelId()+"&sort="+g;}else{if(i){h=this.getFlightSearchUrl()+b+".flight";}}}return'<a class="'+d+'" href="'+h+'" '+l+' aria-hidden="true">'+this.getCity()+"</a>";});Handlebars.registerHelper("getCarrierLogo",function(d){var c=this.getCarrierCode(),a=/[a-z0-9]{2}/i,b=a.test(c);if(typeof c=="string"&&c!=""&&b){c=c.toUpperCase().replace(/ /g,"");if(c.indexOf(",")!=-1){return"/static/default/default/images/flight/multiple_airlines_logo.png";}else{return d+"/media/content/expus/graphics/static_content/fusion/v0.1b/images/airlines/"+c+".gif";}}else{return"/static/default/default/images/flight/multiple_airlines_logo.png";}});Handlebars.registerHelper("getLargeImageUrl",function(){var b=this.get("imageUrl");var a=this.get("imageUrl");if($("body").hasClass("page-dailydeals")){if(b&&b.indexOf("_t.jpg")!=-1){a=a.replace("_t.jpg","_l.jpg");b=b.replace("_t.jpg","_y.jpg");}if(b&&b.indexOf("_l.jpg")!=-1){b=b.replace("_l.jpg","_y.jpg");}var c=new Image();c.src=b;c.onerror=function(){$('img[src="'+b+'"]').attr("src",a);};}else{if(b&&b.indexOf("_t.jpg")!=-1){b=b.replace("_t.jpg","_l.jpg");}}return b;});Handlebars.registerHelper("getReallyLargeImageUrl",function(){var b=this.get("imageUrl");var a=this.get("imageUrl");if(b&&b.indexOf("_t.jpg")!=-1){a=a.replace("_t.jpg","_l.jpg");b=b.replace("_t.jpg","_y.jpg");}if(b&&b.indexOf("_l.jpg")!=-1){b=b.replace("_l.jpg","_y.jpg");}var c=new Image();c.src=b;c.onerror=function(){$('img[src="'+b+'"]').attr("src",a);};return b;});Handlebars.registerHelper("formatCruiseDate",function(b){var a=b.fn(this);a=a.toString();a=a.replace(/[,\.]/g,"/");var e=Date.parse(a);var c=new Date(e);months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];weekDays=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];a=weekDays[c.getDay()]+" "+c.getDate()+", "+months[c.getMonth()]+" "+c.getFullYear();return a;});Handlebars.registerHelper("foreach",function(a,b){if(b.inverse&&!a.length){return b.inverse(this);}else{return $.map(a,function(d,c){d.$index=c;d.$first=c===0;d.$last=c===a.length-1;return b.fn(d);}).join("");}});Handlebars.registerHelper("encodeURL",function(a){return encodeURIComponent(a.fn(this));});});GMT.extend(GMT,{parseOSGetOffers:function(g,a){var b=[],j={};if(!$.isEmptyObject(g.offers)){if(g.offers.hasOwnProperty("Hotel")&&g.offers.Hotel.length>0){b=k(g,a);}else{if(g.offers.hasOwnProperty("HotelCar")&&g.offers.HotelCar.length>0){b=k(g,a);}else{if(g.offers.hasOwnProperty("Package")&&g.offers.Package.length>0){b=m(g,a);}else{if(g.offers.hasOwnProperty("Flight")&&g.offers.Flight.length>0){b=l(g,a);}else{if(g.offers.hasOwnProperty("FlightCar")&&g.offers.FlightCar.length>0){b=l(g,a);}else{if(g.offers.hasOwnProperty("Cruise")&&g.offers.Cruise.length>0){b=o(g,a);}else{if(g.offers.hasOwnProperty("ThirdPartyPackage")&&g.offers.ThirdPartyPackage.length>0){b=d(g,a);}else{if(g.offers.hasOwnProperty("Car")&&g.offers.Car.length>0){b=f(g,a);}else{if(g.offers.hasOwnProperty("LXActivities")&&g.offers.LXActivities.length>0){b=p(g,a);}else{return false;}}}}}}}}}}else{if(g.hasOwnProperty("destinations")&&g.destinations.length>0){b=i(g,a);}}return b;function i(w,q){var r=[],A=1,z=q.useAveragePrice,t=q.dealsRfrr,s=q.subSecIndex,B=q.secIndex,x=w.offerInfo.siteID,C=q.hotelOfferMarker,u=[];j.all=[];$.each(w.destinations,function(E,D){v(D);});function v(D){var H,G,E={},F={index:A,dealsRfrr:t,subSecIndex:s,secIndex:B,regionID:D.destinationInfo.regionID,country:D.destinationInfo.country,city:D.destinationInfo.city,rank:D.destinationInfo.rank,nonLocalizedCity:D.destinationInfo.nonLocalizedCity,useAveragePrice:z,source:D.destinationInfo.source,queryScenario:q.queryScenario,hasPackage:false,hasHotel:false,hasFlight:false};j.all.push(F.regionID);j[F.regionID]={hotelPrice:undefined,index:A,hotelId:undefined};if(typeof D.packages!="undefined"){packageDeal=y(D.packages,"LEADIN_PRICE");F.hasPackage=true;F.perPsgrPackagePrice=packageDeal.packagePricingInfo.perPsgrPackagePrice;F.packagePerPsgrSavings=packageDeal.packagePricingInfo.perPsgrSavings;F.packageLengthOfStay=packageDeal.offerDateRange.maxLengthOfStay;F.packageSearchUrl=packageDeal.packageUrls.packageSearchUrl;F.packageStartDate=packageDeal.offerDateRange.travelStartDate;F.packageEndDate=packageDeal.offerDateRange.travelEndDate;}if(typeof D.flights!="undefined"){flightDeal=D.flights[0];F.hasFlight=true;F.flightPerPsgrBaseFarePlusTax=flightDeal.flightPricingInfo.flightPerPsgrBaseFarePlusTax;F.flightSearchUrl=flightDeal.flightUrls.flightSearchUrl;F.flightTripType=flightDeal.flightInfo.tripType;F.flightStartDate=flightDeal.offerDateRange.travelStartDate;F.flightEndDate=flightDeal.offerDateRange.travelEndDate;F.flightDestinationAirport=flightDeal.destination.tla;F.originCity=flightDeal.origin.city;F.originCountry=flightDeal.origin.country;F.originLongName=flightDeal.origin.longName;F.originMetrocode=flightDeal.origin.metrocode;F.originProvince=flightDeal.origin.province;F.flightDepartureAirport=flightDeal.origin.tla;F.originRegionID=flightDeal.origin.regionID;}if(typeof D.hotels!="undefined"){hotelDeal=y(D.hotels,C);F.hasHotel=true;F.hotelStartDate=hotelDeal.offerDateRange.travelStartDate;F.hotelEndDate=hotelDeal.offerDateRange.travelEndDate;F.hotelName=hotelDeal.hotelInfo.localizedHotelName?decodeURIComponent(hotelDeal.hotelInfo.localizedHotelName):hotelDeal.hotelInfo.hotelName,F.hotelId=hotelDeal.hotelInfo.hotelId;F.hotelDestination=hotelDeal.hotelInfo.hotelDestination;F.hotelSearchResultUrl=(typeof hotelDeal.hotelUrls.hotelSearchResultUrl!="undefined")?decodeURIComponent(hotelDeal.hotelUrls.hotelSearchResultUrl):e({hotelCity:hotelDeal.hotelInfo.hotelCity,hotelCountry:D.destinationInfo.country,startDate:hotelDeal.offerDateRange.travelStartDate,endDate:hotelDeal.offerDateRange.travelEndDate},"hotel");F.hotelCity=hotelDeal.hotelInfo.hotelCity;F.hotelAveragePrice=hotelDeal.hotelPricingInfo.averagePriceValue;F.hotelTotalPrice=hotelDeal.hotelPricingInfo.totalPriceValue;F.hotelCrossOutPriceValue=typeof hotelDeal.hotelPricingInfo.crossOutPriceValue!=="undefined"?hotelDeal.hotelPricingInfo.crossOutPriceValue:typeof hotelDeal.hotelPricingInfo.originalPricePerNight!=="undefined"?hotelDeal.hotelPricingInfo.originalPricePerNight:0;F.hotelPercentSavings=hotelDeal.hotelPricingInfo.percentSavings;F.hotelPrice=z?F.hotelAveragePrice:F.hotelTotalPrice;if(!F.hotelPrice||F.hotelPrice==0){F.hasHotel=false;
}j[F.regionID].hotelPrice=F.hotelPrice;j[F.regionID].hotelId=F.hotelId;}if(F.hasHotel||F.hasPackage||F.hasFlight){A++;if(F.hasHotel&&!F.hasPackage){u.push("Hotel");}else{u.push("Package");}r.push(F);}}function y(H,G){var D=H.length,F=H[0];if(D>0){for(var E=0;E<D;E++){if(typeof H[E].offerMarkers!="undefined"&&H[E].offerMarkers.indexOf(G)>-1){F=H[E];break;}}}return F;}flatData={lowestPrice:null,highestPercentageSaving:null,models:r,tabLob:(u.indexOf("Package")===-1?"Hotel":"Package"),destinations:j};return flatData;}function k(v,q){var t=[],A=0,y=q.useAveragePrice,D=q.minOfferThreshold?q.minOfferThreshold:0,w=v.offerInfo.siteID,E,z={},s=q.dealsRfrr,r=q.subSecIndex,C=q.secIndex,u,B;if(typeof v.offers.Hotel==="object"){function x(G,F){if((F.hotelPricingInfo&&G)&&(!G.hasOwnProperty("regionID")||G.hasOwnProperty("regionID")&&G.regionID!="180066")){var H={index:A,dealsRfrr:s,subSecIndex:r,secIndex:C,startDate:F.offerDateRange.travelStartDate,endDate:F.offerDateRange.travelEndDate,lengthOfStay:F.offerDateRange.hasOwnProperty("lengthOfStay")?F.offerDateRange.lengthOfStay:F.offerDateRange.hasOwnProperty("minLengthOfStay")?F.offerDateRange.minLengthOfStay:GMT.utils.getDateDifference(F.offerDateRange.travelStartDate,F.offerDateRange.travelEndDate),hotelName:F.hotelInfo.localizedHotelName?decodeURIComponent(F.hotelInfo.localizedHotelName):F.hotelInfo.hotelName,hotelId:F.hotelInfo.hotelId,regionID:(typeof F.destination!=="undefined"&&F.destination.regionID!=="undefined")?F.destination.regionID:0,starRating:F.hotelInfo.hotelStarRating,vipAccess:(GMT.isVipAccessSupported&&F.hotelInfo.hasOwnProperty("vipAccess")&&(F.hotelInfo.vipAccess==="true"||F.hotelInfo.vipAccess===true))?true:false,guestRating:F.hotelInfo.hotelGuestReviewRating,reviewTotal:F.hotelInfo.hotelReviewTotal,imageUrl:F.hotelInfo.hotelImageUrl,numberViewing:F.hotelUrgencyInfo?F.hotelUrgencyInfo.numberOfPeopleViewing:"",numberBooked:(F.hasOwnProperty("hotelUrgencyInfo")&&F.hotelUrgencyInfo.hasOwnProperty("numberOfPeopleBooked"))?F.hotelUrgencyInfo.numberOfPeopleBooked:0,almostSoldStatus:F.hotelUrgencyInfo?F.hotelUrgencyInfo.almostSoldStatus:"",totalPrice:typeof F.hotelPricingInfo.totalPriceValue!=="undefined"?F.hotelPricingInfo.totalPriceValue:0,averagePrice:typeof F.hotelPricingInfo.averagePriceValue!=="undefined"?F.hotelPricingInfo.averagePriceValue:0,crossOutPrice:F.hotelPricingInfo.crossOutPriceValue,percentSavings:F.hotelPricingInfo.percentSavings,city:G.city,hotelCity:F.hotelInfo.hotelCity,hotelDestination:typeof F.hotelInfo.hotelDestination==="string"?F.hotelInfo.hotelDestination:F.hotelInfo.hotelCity,shortName:G.shortName,tla:(typeof G.tla!=="undefined")?G.tla:"",province:G.province,country:G.country,hotelInfositeUrl:F.hotelUrls.hotelInfositeUrl,promotionDescription:F.hotelInfo.promotionDescription,sortId:F.sortId,siteId:w,hotelSearchResultUrl:typeof F.hotelUrls.hotelSearchResultUrl!="undefined"?decodeURIComponent(F.hotelUrls.hotelSearchResultUrl):e({hotelCity:F.hotelInfo.hotelCity,hotelCountry:G.country,startDate:F.offerDateRange.travelStartDate,endDate:F.offerDateRange.travelEndDate,regionID:(typeof F.destination!=="undefined"&&typeof F.destination.regionID!=="undefined")?F.destination.regionID:0},"hotel"),useAveragePrice:y,pageNum:(typeof v.offerPagination=="object"&&typeof v.offerPagination.currentPage=="number")?v.offerPagination.currentPage:1};if(window.location.hostname.indexOf("www.expedia-aarp.com")!=-1||window.location.hostname.indexOf("wwwexpedia-aarpcom")!=-1){H.hotelSearchResultUrl=H.hotelSearchResultUrl.replace("www.expedia.com","www.expedia-aarp.com");}H.price=y?H.averagePrice:H.totalPrice;if(GMT.utils.isTestActive("12290")){if(H.averagePrice!==0){H.price=H.averagePrice;}else{H.price=H.totalPrice;}}else{H.price=y?H.averagePrice:H.totalPrice;}if(typeof H.percentSavings=="undefined"){if(typeof H.crossOutPrice!="undefined"&&H.crossOutPrice>0){if(y&&typeof H.averagePrice!=="undefined"){H.percentSavings=Math.round((H.crossOutPrice-H.averagePrice)/H.crossOutPrice*100);}else{H.percentSavings=Math.round((H.crossOutPrice-H.totalPrice)/H.crossOutPrice*100);}}else{H.percentSavings=0;}}if((y&&H.crossOutPrice==H.averagePrice)||(!y&&H.crossOutPrice==H.totalPrice)){H.crossOutPrice=0;}if(H.price<E||typeof E==="undefined"){E=H.price;}if(H.percentSavings>u||typeof u==="undefined"){u=H.percentSavings;}if(q.isIncludeUnpriced&&H.price==0){A++;H.isUnpriced=true;t.push(H);}else{if((H.price&&H.price!==0)&&(H.percentSavings>=D||D===0)){A++;t.push(H);}}}}$.each(v.offers.Hotel,function(G,H){var F=H.destination;if(!H.hasOwnProperty("hotelOffers")){x(F,H);}else{$.each(H.hotelOffers,function(J,I){x(F,I);});}});}if(typeof v.offers.HotelCar==="object"){u=0;$.each(v.offers.HotelCar,function(I,F){var G=F.destination;var H={index:A,dealsRfrr:s,subSecIndex:r,secIndex:C,startDate:F.offerDateRange.travelStartDate,endDate:F.offerDateRange.travelEndDate,hotelName:F.hotelInfo.localizedHotelName?decodeURIComponent(F.hotelInfo.localizedHotelName):F.hotelInfo.hotelName,hotelId:F.hotelInfo.hotelId,starRating:F.hotelInfo.hotelStarRating,guestRating:F.hotelInfo.hotelGuestReviewRating,reviewTotal:F.hotelInfo.hotelReviewTotal,imageUrl:F.hotelInfo.hotelImageUrl,numberViewing:F.hasOwnProperty("hotelUrgencyInfo")?F.hotelUrgencyInfo.numberOfPeopleViewing:"",almostSoldStatus:F.hasOwnProperty("hotelUrgencyInfo")?F.hotelUrgencyInfo.almostSoldStatus:"",totalPrice:F.packagePricingInfo.totalPackagePrice,lengthOfStay:F.flightInfo.lengthOfStay,city:G.city,hotelCity:F.hotelInfo.hotelCity,hotelDestination:typeof F.hotelInfo.hotelDestination==="string"?F.hotelInfo.hotelDestination:F.hotelInfo.hotelCity,shortName:(G.shortName)?G.shortName:"",tla:G.tla,province:(G.province)?G.province:"",country:G.country,packageSearchUrl:F.packageUrls.packageSearchUrl,packageInfositeUrl:(F.packageUrls.packageInfositeUrl)?F.packageUrls.packageInfositeUrl:"",promotionDescription:(F.hotelInfo.promotionDescription)?F.hotelInfo.promotionDescription:"",sortId:F.sortId,siteId:w};H.price=H.totalPrice;if(H.price<E||typeof E==="undefined"){E=H.price;}if(H.price&&H.price!==0){A++;t.push(H);}});}z={lowestPrice:E,highestPercentageSaving:u,models:t};return z;}function m(u,q){var s=[],x=0,v=u.offerInfo.siteID,B,w={},t=q.dealsRfrr,r=q.subSecIndex,z=q.secIndex,y=q.queryScenario;function A(E,D,C){var F={index:x,dealsRfrr:t,subSecIndex:r,secIndex:z,originTla:E.tla,originCity:E.city,originCountry:E.country,originProvince:E.province,destTla:D.tla,destRegionID:(typeof C.destination!=="undefined"&&C.destination.regionID!=="undefined")?C.destination.regionID:0,destCity:D.city,destCityEN:D.nonLocalizedCity,destCountry:D.country,destProvince:D.province,hotelId:C.hotelInfo.hotelId,hotelName:C.hotelInfo.localizedHotelName?C.hotelInfo.localizedHotelName:C.hotelInfo.hotelName,hotelCity:C.hotelInfo.hotelCity,hotelDestination:C.hotelInfo.hotelDestination,hotelProvince:C.hotelInfo.hotelProvince,perPsgrPackagePrice:C.packagePricingInfo.perPsgrPackagePrice,totalPackagePrice:C.packagePricingInfo.totalPackagePrice,hotelTotalRate:C.hotelPricingInfo.hotelTotalRate,hotelPerPsgrTotalRate:C.hotelPricingInfo.hotelPerPsgrTotalRate,perPsgrFlightPrice:C.flightPricingInfo.flightPerPsgrTotalPrice,flightSearchUrl:C.packageUrls.flightDeeplinks.flightSearchUrl,hotelInfositeUrl:C.packageUrls.hotelDeeplinks.hotelInfositeUrl,packageSearchUrl:C.packageUrls.packageSearchUrl,imageUrl:C.hotelInfo.hotelImageUrl,lengthOfStay:C.flightInfo.lengthOfStay,perPsgrSavings:C.packagePricingInfo.perPsgrSavings,starRating:C.hotelInfo.hotelStarRating,vipAccess:(GMT.isVipAccessSupported&&C.hotelInfo.hasOwnProperty("vipAccess")&&(C.hotelInfo.vipAccess==="true"||C.hotelInfo.vipAccess===true))?true:false,guestRating:C.hotelInfo.hotelGuestReviewRating,reviewTotal:C.hotelInfo.hotelReviewTotal,numberViewing:C.hotelUrgencyInfo?C.hotelUrgencyInfo.numberOfPeopleViewing:"",numberBooked:(C.hasOwnProperty("hotelUrgencyInfo")&&C.hotelUrgencyInfo.hasOwnProperty("numberOfPeopleBooked"))?C.hotelUrgencyInfo.numberOfPeopleBooked:0,almostSoldStatus:C.hotelUrgencyInfo?C.hotelUrgencyInfo.almostSoldStatus:"",startDate:C.offerDateRange.travelStartDate,endDate:C.offerDateRange.travelEndDate,hotelPromotionDescription:C.hotelInfo.promotionDescription,packagePromotionDescription:C.packageInfo.promotionDescription,sortId:C.sortId,siteId:v,brandedDealsIdentifier:C.packageInfo.brandedDealsIdentifier,flightDealCarrier:C.flightInfo.flightDealCarrier,packageSearchResultUrl:typeof C.packageUrls.packageSearchResultUrl!="undefined"?C.packageUrls.packageSearchResultUrl:e({hotelCity:C.hotelInfo.hotelCity,startDate:C.offerDateRange.travelStartDate,endDate:C.offerDateRange.travelEndDate,lengthOfStay:C.flightInfo.lengthOfStay,tla:D.tla,originTla:E.tla,regionID:(typeof C.destination!=="undefined"&&typeof C.destination.regionID!=="undefined")?C.destination.regionID:0},"package")};
if(window.location.hostname.indexOf("www.expedia-aarp.com")!=-1||window.location.hostname.indexOf("wwwexpedia-aarpcom")!=-1){if(typeof F.hotelInfositeUrl!="undefined"){F.hotelInfositeUrl=F.hotelInfositeUrl.replace("www.expedia.com","www.expedia-aarp.com");}}if(F.perPsgrPackagePrice<B||typeof B==="undefined"){B=F.perPsgrPackagePrice;}x++;if(q.isIncludeUnpriced&&F.perPsgrPackagePrice==0){F.isUnpriced=true;}s.push(F);}$.each(u.offers.Package,function(E,F){var D=F.destination,C=F.origin;if(!F.hasOwnProperty("packageOffers")){A(C,D,F);}else{$.each(F.packageOffers,function(H,G){A(C,D,G);});}});w={lowestPrice:B,models:s};return w;}function l(u,q){var s=[],y=0,v=u.offerInfo.siteID,B,x={},t=q.dealsRfrr,r=q.subSecIndex,w=q.showFlightImage,A=q.secIndex;if(typeof u.offers.Flight==="object"){function z(E,D,C){var F={index:y,dealsRfrr:t,subSecIndex:r,secIndex:A,regionID:D.regionID,originTla:E.tla,originCity:E.city,destTla:D.tla,destCity:D.city,destMetroCode:D.metrocode,flightPerPsgrBaseFarePlusTax:C.flightPricingInfo.flightPerPsgrBaseFarePlusTax,flightPerPsgrTotalPrice:C.flightPricingInfo.flightPerPsgrTotalPrice,tripType:C.flightInfo.tripType,flightSearchUrl:C.flightUrls.flightSearchUrl,startDate:C.offerDateRange.travelStartDate,endDate:C.offerDateRange.travelEndDate,flightDealCarrier:C.flightInfo.flightDealCarrier,flightDealCarrierName:C.flightInfo.flightDealCarrierName,sortId:C.sortId,showFlightImage:w,siteId:v};if(F.flightPerPsgrBaseFarePlusTax<B||typeof B==="undefined"){B=F.flightPerPsgrBaseFarePlusTax;}y++;s.push(F);}$.each(u.offers.Flight,function(F,C){var E=C.destination,D=C.origin;if(!C.hasOwnProperty("flightOffers")){z(D,E,C);}else{$.each(C.flightOffers,function(H,G){z(D,E,G);});}});}if(typeof u.offers.FlightCar==="object"){$.each(u.offers.FlightCar,function(G,C){var E=C.destination,D=C.origin;var F={index:y,dealsRfrr:t,subSecIndex:r,secIndex:A,originTla:D.tla,originCity:D.city,destTla:E.tla,destCity:E.city,destMetroCode:E.metrocode,lengthOfStay:C.flightInfo.lengthOfStay,perPsgrPackagePrice:C.packagePricingInfo.perPsgrPackagePrice,totalPackagePrice:C.packagePricingInfo.totalPackagePrice,tripType:C.flightInfo.tripType,flightDealCarrier:C.flightInfo.flightDealCarrier,packageSearchUrl:C.packageUrls.packageSearchUrl,startDate:C.offerDateRange.travelStartDate,endDate:C.offerDateRange.travelEndDate,sortId:C.sortId,siteId:v};if(F.totalPackagePrice<B||typeof B==="undefined"){B=F.totalPackagePrice;}y++;s.push(F);});}x={lowestPrice:B,models:s};return x;}function d(u,q){var s=[],x=0,v=u.offerInfo.siteID,z,w={},t=q.dealsRfrr,r=q.subSecIndex,y=q.secIndex;$.each(u.offers.ThirdPartyPackage,function(E,A){var C=A.destination,B=A.origin,D={index:x,dealsRfrr:t,subSecIndex:r,secIndex:y,originTla:B.tla,originCity:B.city,originCountry:B.country,originProvince:B.province,destTla:C.tla,destCity:C.city,destCountry:C.country,destProvince:C.province,hotelName:A.hotelInfo.localizedHotelName?A.hotelInfo.localizedHotelName:A.hotelInfo.hotelName,hotelCity:A.hotelInfo.hotelCity,hotelDestination:A.hotelInfo.hotelDestination,hotelProvince:A.hotelInfo.hotelProvince,perPsgrPackagePrice:A.packagePricingInfo.perPsgrPackagePrice,crossOutPrice:A.packagePricingInfo.crossOutPriceValue,hotelTotalRate:A.hotelPricingInfo.hotelTotalRate,flightSearchUrl:A.packageUrls.flightDeeplinks.flightSearchUrl,hotelInfositeUrl:A.packageUrls.hotelDeeplinks.hotelInfositeUrl,packageSearchUrl:A.packageUrls.packageSearchUrl,imageUrl:typeof A.hotelInfo.hotelImageUrl=="string"?A.hotelInfo.hotelImageUrl.replace("booking_thumbs","booking_thumbs_w_gr"):"",lengthOfStay:A.flightInfo.lengthOfStay,perPsgrSavings:A.packagePricingInfo.perPsgrSavings,starRating:A.hotelInfo.hotelStarRating,guestRating:A.hotelInfo.hotelGuestReviewRating,reviewTotal:A.hotelInfo.hotelReviewTotal,startDate:A.offerDateRange.travelStartDate,endDate:A.offerDateRange.travelEndDate,is3PP:true,sortId:A.sortId,siteId:v};if(D.perPsgrPackagePrice<z||typeof z==="undefined"){z=D.perPsgrPackagePrice;}x++;s.push(D);});w={lowestPrice:z,models:s};return w;}function o(u,q){var r=[],x=0,v=u.offerInfo.siteID,w={},t=q.dealsRfrr,s=q.subSecIndex,y=q.secIndex,z;$.each(u.offers.Cruise,function(C,D){var A=D,B={index:x,dealsRfrr:t,subSecIndex:s,secIndex:y,averageCustomerRating:A.cruiseInfo.averageCustomerRating,shipImage:A.cruiseUrls.shipImage,category:A.category,disembarkationPort:A.cruiseInfo.disembarkationPort,itinerary:A.cruiseInfo.itinerary,lengthOfStay:A.offerDateRange.lengthOfStay,embarkationPort:A.cruiseInfo.embarkationPort,cruiseLine:A.cruiseInfo.cruiseLine,cruiseLineLogo:A.cruiseUrls.cruiseLineLogo,dealDeepLink:A.cruiseUrls.dealDeepLink,shipDeepLink:A.cruiseUrls.cruiseLineLogo,priceBalcony:A.cruisePricingInfo.priceBalcony===""?0:parseInt(A.cruisePricingInfo.priceBalcony,10),priceInterior:A.cruisePricingInfo.priceInterior===""?0:parseInt(A.cruisePricingInfo.priceInterior,10),priceSuite:A.cruisePricingInfo.priceSuite===""?0:parseInt(A.cruisePricingInfo.priceSuite,10),priceOceanView:A.cruisePricingInfo.priceOceanView===""?0:parseInt(A.cruisePricingInfo.priceOceanView,10),percentSavings:A.cruisePricingInfo.percentOff,sortId:A.sortId,siteId:v};B.cruisePrice=0;if(B.priceInterior!=0&&!isNaN(B.priceInterior)){B.cruisePrice=B.priceInterior;}if(B.priceBalcony!=0&&(0==B.cruisePrices||B.priceBalcony<B.cruisePrice)&&!isNaN(B.priceBalcony)){B.cruisePrice=B.priceBalcony;}if(B.priceOceanView!=0&&(0==B.cruisePrice||B.priceOceanView<B.cruisePrice)&&!isNaN(B.priceOceanView)){B.cruisePrice=B.priceOceanView;}if(B.priceSuite!=0&&(0==B.cruisePrice||B.priceSuite<B.cruisePrice)&&!isNaN(B.priceSuite)){B.cruisePrice=B.priceSuite;}if(B.cruisePrice<z||typeof z==="undefined"){z=B.cruisePrice;}if(typeof A.destination!="undefined"){B.destination=A.destination.destination;}if(typeof A.destination.country!="undefined"){B.destination=A.destination.country;}if(typeof A.offerDateRange.travelStartDate!="undefined"){B.travelStartDate=A.offerDateRange.travelStartDate;}else{B.travelStartDate=[];}if(typeof A.offerDateRange.travelEndDate!="undefined"){B.travelEndDate=A.offerDateRange.travelEndDate;}else{B.travelEndDate=[];}x++;r.push(B);});w={lowestPrice:z,models:r};return w;}function f(u,q){var s=[],x=0,v=u.offerInfo.siteID,z,w={},t=q.dealsRfrr,r=q.subSecIndex,y=q.secIndex;$.each(u.offers.Car,function(D,A){var B=A.destination,C={index:x,dealsRfrr:t,subSecIndex:r,secIndex:y,destCity:B.city,carTotalPrice:A.carPricingInfo.totalPriceValue,carSearchUrl:A.carUrls.carSearchUrl,startDate:A.offerDateRange.travelStartDate,endDate:A.offerDateRange.travelEndDate,lengthOfStay:GMT.utils.getDateDifference(A.offerDateRange.travelStartDate,A.offerDateRange.travelEndDate),carSupplierName:A.carInfo.supplierName,carSupplierLogo:A.carInfo.supplierLogo,sortId:A.sortId,siteId:v};if(C.carTotalPrice<z||typeof z==="undefined"){z=C.carTotalPrice;}x++;s.push(C);});w={lowestPrice:z,models:s};return w;}function p(u,q){var r=[],y=0,v=u.offerInfo.siteID,x={},t=q.dealsRfrr,s=q.subSecIndex,z=q.secIndex,w=[];$.each(u.offers.LXActivities,function(D,A){var B=A.destination,C={index:y,dealsRfrr:t,subSecIndex:s,secIndex:z,destCity:B.destination,activityPrice:A.activitiesPricingInfo.price,activitySearchUrl:A.activitiesUrls.detailsLink,startDate:A.offerDateRange.travelStartDate,endDate:A.offerDateRange.travelEndDate,activitySupplierName:A.activitiesInfo.supplierName,activityImageLogo:A.activitiesUrls.imageUrl,activityTitle:A.activitiesInfo.title,activityDuration:A.activitiesInfo.duration,activityStartDate:GMT.utils.formatDate(A.offerDateRange.travelStartDate),activityEndDate:GMT.utils.formatDate(A.offerDateRange.travelEndDate),activityPriceLabel:A.activitiesPricingInfo.priceLabel,activityDiscountPercentage:A.activitiesPricingInfo.discountPercentage,freeCancellable:A.activitiesInfo.freeCancellable,sortId:A.sortId,siteId:v};if(C.activityDiscountPercentage&&C.activityDiscountPercentage!="0"){C.discount=1;var F=parseInt(Number(C.activityPrice.replace(/[^0-9\.]+/g,"")));if(A.activitiesPricingInfo.strikeThroughPrice){var G=parseInt(Number(A.activitiesPricingInfo.strikeThroughPrice.replace(/[^0-9\.]+/g,"")));
var E=parseInt(G-F);C.activityTotalPrice=A.activitiesPricingInfo.strikeThroughPrice;C.activityDiscountValue=GMT.utils.formatPrice(E);}}else{C.discount=0;}C.activityLargeImage=A.activitiesUrls.largeImageUrl;y++;r.push(C);});x={models:r};return x;}function h(q,r){return Math.round((r-q)/r*100);}function n(s){var q=s.toString(),u=q.replace(/[,\.]/g,"/"),r=new Date(u),t=r.getFullYear()+"-"+(parseInt(r.getMonth(),10)+1)+"-"+r.getDate();return t;}function c(u){var r="",q=n(u.startDate),v=n(u.endDate),t=u.hotelId,s=u.originTla,w=u.destTla;r="/go/package/search/FlightHotel/"+q+"/"+v+"?HotelID="+t+"&FromAirport="+s+"&Destination="+w+"&NumRoom=1&NumAdult=2";return r;}function e(u,w){var B="",r=u.hasOwnProperty("hotelCity")?u.hotelCity.replace(/,/g,", "):u.destCity.replace(/,/g,", "),A=u.hotelCountry?u.hotelCountry.replace(/,/g,", "):"",t=u.hasOwnProperty("tla")?u.tla:u.destTla,x=u.hasOwnProperty("originTla")?u.originTla:"",q=GMT.utils.formatDate(u.startDate,"shortDate"),v=GMT.utils.formatDate(u.endDate,"shortDate"),s=u.lengthOfStay;switch(w){case"package":B="/packagesearch?ttla="+t+"&ftla="+x+"&destination="+encodeURIComponent(r)+"&fromDate="+q+"&toDate="+v+"&NumRoom=1&NumAdult=2&SortBy=10&HotelClass=30";return B;break;case"hotel":var z=A.length>0?r+", "+A:r,y=u.regionID!==0?"regionId="+u.regionID:"destination="+encodeURIComponent(z);B="/go?type=Hotel-Search&"+y+"&startDate="+q+"&endDate="+v;return B;break;case"thirdpartypackage":q=q.replace(/\//g,"."),v=v.replace(/\//g,".");B="http://booking.expedia.de/booking/exp/ibe/index.php?"+"GOTO=TTPauschalreisen&lnkloc=lmn_1&lnkcid=100&tab=lmn&showresult=1&StrWizTag=TT_HolidayHome&frbuch=&"+"KID=360010&"+"agent=&org_tla=&formular=2&sortierung=&detail=zielgebiet&rliste=2&zfilter=&backon=1&hostexp=&wzdf=&wzid=&"+"termin="+encodeURI(q)+"&ruecktermin="+encodeURI(v)+"&dauer="+encodeURI(u.lengthOfStay)+"&zimmer=-1&erwachsene="+encodeURI("25;25")+"&alter1="+"&alter2="+"&alter3="+"&alter4=-1&alter5=-1&alter6=-1&alter7=-1&alter8=-1&hbfges=0&hbfanz=0&hbfempf=0&kategorie=-1&shotel=&typ=-1&preis=-1&verpflegung=-1&sportangebot=-1&marke=-1&"+"wizardSubmit.x=23&wizardSubmit.y=4"+"&lcfilter="+encodeURI("513;0");return B;break;default:return"";}}}});GMT.extend(GMT,{parseOSGetDestinations:function(g,j){var h=true,f,i,d,a={};if(typeof j!="undefined"){f=j.destinationCity;i=j.originCity;d=j.destCountry;}if(!$.isEmptyObject(g)){if(g.hasOwnProperty("hotelDestinations")){a=e(g.hotelDestinations);}else{if(g.hasOwnProperty("flightOrigins")&&g.flightOrigins.length>0){a=b(g.flightOrigins);}else{if(g.hasOwnProperty("packageOrigins")&&g.packageOrigins.length>0){a=b(g.packageOrigins);}else{if(g.hasOwnProperty("thirdPartyPackageOrigins")&&g.thirdPartyPackageOrigins.length>0){a=b(g.thirdPartyPackageOrigins);}else{return false;}}}}}return a;function c(m){var l=_.keys(m);l.sort(function(o,n){return o.localeCompare(n);});var k={};_.each(l,function(n){k[n]=m[n];});return k;}function e(m){var u={},k={},t={},o=[],s=[];var n=0;function l(v,w){var z={};for(var A in w){z[w[A].city]=w[A];t[w[A].city]={length:1,city:w[A].city,selected:w[A].city==f?true:false,country:w[A].country,tla:w[A].tla,destinationCountry:{}};t[w[A].city].destinationCountry[v]={country:v};o.push(w[A].city);}return{destinationCity:h?c(z):z};}for(var r in m){s.push(r);k[r]=l(r,m[r]);k[r].selected=r==d?true:false;}u={destinationCountry:h?c(k):k,destinationCity:h?c(t):t};if(s.length===1){for(var q in u.destinationCountry){u.destinationCountry[q].selected=true;}}if(o.length===1){for(var p in u.destinationCity){u.destinationCity[p].selected=true;}}return u;}function b(p){var w={},l={},u={},q=[],s=[];function m(z,x){var o={},B=0;for(var A in x){B++;o[x[A].city]=x[A];if(q.indexOf(x[A].city)!=-1){u[x[A].city].length++;u[x[A].city].multipleOrigin=true;u[x[A].city].originCity[z.city]={city:z.city,selected:z.city==f?true:false,continent:z.continent,country:z.country,tla:z.tla};}else{u[x[A].city]={length:1,city:x[A].city,selected:x[A].city==f?true:false,country:x[A].country,tla:x[A].tla,originCity:{}};u[x[A].city].originCity[z.city]={city:z.city,selected:x[A].city==f?true:false,continent:z.continent,country:z.country,tla:z.tla};q.push(x[A].city);}}return{length:B,destinationCity:h?c(o):o};}for(var t in p){if(s.indexOf(p[t].city)!=-1){var v=m(p[t],p[t].destinations);for(var n in v.destinationCity){l[p[t].city].destinationCity[n]=v.destinationCity[n];l[p[t].city].length++;l[p[t].city].selected=p[t].city==i?true:false;}}else{l[p[t].city]=m(p[t],p[t].destinations);l[p[t].city].selected=p[t].city==i?true:false;}s.push(p[t].city);}w={originCity:h?c(l):l,destinationCity:h?c(u):u};if(s.length===1){for(var k in w.originCity){w.originCity[k].selected=true;}}if(q.length===1){for(var r in w.destinationCity){w.destinationCity[r].selected=true;}}return w;}}});var GMTHotelModel=Backbone.Model.extend({initialize:function(){_.bindAll(this,"initialize","getIndex","getSecIndex","getSubSecIndex","getDealsRfrr","getDealDeepLink","getSimilarDeepLink","getHotelId","getHotelName","getTruncatedHotelName","getCheckInDate","getCheckOutDate","getTla","getDestinationRegionID","getCity","getNormalisedCity","getHotelCity","getProvince","getCountry","getImageUrl","getDestinationImageUrl","getThumbnailUrl","getStarRating","getVipAccess","getStarRatingClass","getGuestRating","getReviewTotal","getTotalPrice","getAveragePrice","getPrice","getNumberBooked","getCrossOutPrice","getPercentSavings","getNumberOfPeopleViewing","getPromotionDescription","getSoldOutDealDeepLink","getSimilarSoldOutDeepLink","getAlmostSold","getRegionID","getLengthOfStay","isUseAveragePrice","getPageNum");},getIndex:function(){return this.get("index");},getSecIndex:function(){return this.get("secIndex");},getSubSecIndex:function(){return this.get("subSecIndex");},getDealsRfrr:function(){return this.get("dealsRfrr");},getDealDeepLink:function(){var a=unescape(this.get("hotelInfositeUrl"));if(a.indexOf("?")==-1){a=a+"?";}else{a=a+"&";}return a;},getSoldOutDealDeepLink:function(){var a="/hotel.h"+this.getHotelId()+".Hotel-Information?";return a;},getSimilarDeepLink:function(){var a=this.get("hotelSearchResultUrl");if(a.indexOf("?")==-1){a=a+"?";}else{a=a+"&";}return a;},getSimilarSoldOutDeepLink:function(){var a="/go?type=Hotel-Search&destination="+this.getCity()+"&";return a;},getHotelId:function(){return this.get("hotelId");},getHotelName:function(){return this.get("hotelName");},getTruncatedHotelName:function(){var a=this.get("hotelName");if(a.length>35){a=a.substring(0,35).split(" ").slice(0,-1).join(" ")+"...";}return a;},getCheckInDate:function(){return this.get("startDate");},getCheckOutDate:function(){return this.get("endDate");},getTla:function(){return this.get("tla");},getDestinationRegionID:function(){return this.get("destRegionID");},getCity:function(){if(typeof this.get("city")!="undefined"){return this.get("city");}if(typeof this.get("shortName")!="undefined"){return this.get("shortName");}},getNormalisedCity:function(){if(typeof this.get("city")!="undefined"){return this.get("city").replace(/ /g,"");}if(typeof this.get("shortName")!="undefined"){return this.get("shortName").replace(/ /g,"");}},getHotelCity:function(){return this.get("hotelCity");},getProvince:function(){return this.get("province");},getCountry:function(){return this.get("country");},getImageUrl:function(){var a=this.get("imageUrl");if(a){a=a.replace(/http(s)*:\/\/media.(travelocitycustomercare|expedia).com/g,"//images.trvl-media.com").replace("_t.jpg","_l.jpg").replace("http:","https:");}return a;},getNumberBooked:function(){return this.get("numberBooked");},getDestinationImageUrl:function(){var b="//images.trvl-media.com/media/content/expuk/Images/deals/destinations/w456/",c="//images.trvl-media.com/media/content/expuk/Images/deals/destinations/w456/default.jpg",a=this.getHotelCity();if(typeof a=="string"&&a!=""){a=a.replace(/ /g,"");a=a.toLowerCase();return b+a+".jpg";}else{return c;}},getThumbnailUrl:function(){return this.get("imageUrl");},getStarRating:function(){return this.get("starRating");
},getStarRatingClass:function(){var a=this.get("starRating");if(a>0){return a.replace(".","-");}},getVipAccess:function(){return this.get("vipAccess");},getGuestRating:function(){var a=this.get("guestRating");if(a>0){return a.toFixed(1);}},getReviewTotal:function(){return this.get("reviewTotal");},getTotalPrice:function(){return Math.round(this.get("totalPrice"));},getAveragePrice:function(){return Math.round(this.get("averagePrice"));},getPrice:function(){return Math.round(this.get("price"));},getCrossOutPrice:function(){var a=this.getPrice(),b=this.get("crossOutPrice");if(b>a){return this.get("crossOutPrice");}},getPercentSavings:function(){return this.get("percentSavings");},getNumberOfPeopleViewing:function(){return this.get("numberViewing");},getPromotionDescription:function(){return this.get("promotionDescription");},getAlmostSold:function(){return this.get("almostSoldStatus");},getRegionID:function(){return this.get("regionID");},getLengthOfStay:function(){var a=parseInt(this.get("lengthOfStay"));if(typeof a=="number"&&a>0){return a;}else{return 0;}},isUseAveragePrice:function(){return this.get("useAveragePrice");},getPageNum:function(){return this.get("pageNum");}});var GMTPackageModel=Backbone.Model.extend({initialize:function(){_.bindAll(this,"getIndex","getSecIndex","getSubSecIndex","getDealsRfrr","getDestinationTla","getDestinationRegionID","getDestinationCity","getDestinationCountry","getDestinationProvince","getOriginTla","getOriginCity","getOriginCountry","getOriginProvince","getHotelId","getHotelCity","getHotelDestination","getHotelProvince","getPrice","getHotelOnlyPrice","getFlightOnlyPrice","getHotelOnlyPricePerPerson","getTotalStandalonePricePerPerson","getTotalPackagePrice","getCrossOutPrice","getPackageSavingsDifference","getFlightDeepLink","getHotelDeepLink","getDealDeepLink","getSimilarDeepLink","getHotelName","getNumberBooked","getTruncatedHotelName","getImageUrl","getDestinationImageUrl","getImageUrl_t","getLengthOfStay","getPackageSavings","getStarRating","getStarRatingClass","getVipAccess","getGuestRating","getReviewTotal","getCheckInDate","getCheckOutDate","getHotelPromotionDescription","getPackagePromotionDescription","getNumberOfPeopleViewing","getAlmostSold");},getIndex:function(){return this.get("index");},getSecIndex:function(){return this.get("secIndex");},getSubSecIndex:function(){return this.get("subSecIndex");},getDealsRfrr:function(){return this.get("dealsRfrr");},getDestinationTla:function(){return this.get("destTla");},getDestinationCity:function(){if(typeof this.get("destCity")==="string"){return this.get("destCity")+" ";}else{return"";}},getDestinationCityEN:function(){if(typeof this.get("destCityEN")==="string"){return this.get("destCityEN")+" ";}else{return"";}},getDestinationCountry:function(){return this.get("destCountry");},getDestinationProvince:function(){return this.get("destProvince");},getDestinationRegionID:function(){return this.get("destRegionID");},getOriginTla:function(){return this.get("originTla");},getOriginCity:function(){if(typeof this.get("originCity")==="string"){return this.get("originCity")+" ";}else{return"";}},getOriginCountry:function(){return this.get("originCountry");},getOriginProvince:function(){return this.get("originProvince");},getHotelId:function(){return this.get("hotelId");},getHotelCity:function(){return this.get("hotelCity");},getHotelDestination:function(){return this.get("hotelDestination");},getHotelProvince:function(){return this.get("hotelProvince");},getNumberBooked:function(){return this.get("numberBooked");},getPrice:function(){return Math.round(this.get("perPsgrPackagePrice"));},getTotalPackagePrice:function(){return Math.round(this.get("totalPackagePrice"));},getCrossOutPrice:function(){if(typeof this.get("crossOutPrice")==="number"){if(this.get("crossOutPrice")>0){return Math.round(this.get("crossOutPrice"));}}if(typeof this.get("perPsgrPackagePrice")==="number"&&typeof this.get("perPsgrSavings")==="number"){return Math.round(this.get("perPsgrPackagePrice")+this.get("perPsgrSavings"));}return 0;},getHotelOnlyPrice:function(){if(typeof this.get("hotelTotalRate")!="undefined"){return Math.round(this.get("hotelTotalRate"));}else{return 0;}},getHotelOnlyPricePerPerson:function(){return Math.round(this.get("hotelPerPsgrTotalRate"));},getFlightOnlyPrice:function(){return Math.round(this.get("perPsgrFlightPrice"));},getTotalStandalonePricePerPerson:function(){return((Math.round(this.get("hotelPerPsgrTotalRate")))+(Math.round(this.get("perPsgrFlightPrice"))));},getPackageSavingsModal:function(){return((Math.round(this.get("hotelPerPsgrTotalRate")))+(Math.round(this.get("perPsgrFlightPrice")))-Math.round(this.get("perPsgrPackagePrice")));},getPackageSavingsDifference:function(){var a=(Math.round(this.get("perPsgrSavings"))-((Math.round(this.get("hotelPerPsgrTotalRate")))+(Math.round(this.get("perPsgrFlightPrice")))-Math.round(this.get("perPsgrPackagePrice"))));if(a>-3&&a<3){return 0;}else{return a;}},getFlightDeepLink:function(){var a=unescape(this.get("flightSearchUrl"));if(a.indexOf("?")==-1){a=a+"?";}else{a=a+"&";}return a;},getHotelDeepLink:function(){var a=unescape(this.get("hotelInfositeUrl"));if(a.indexOf("?")==-1){a=a+"?";}else{a=a+"&";}return a;},getDealDeepLink:function(){var a=unescape(this.get("packageSearchUrl"));if(a.indexOf("?")==-1){a=a+"?";}else{a=a+"&";}return a;},getSimilarDeepLink:function(){var a=this.get("packageSearchResultUrl");if(a.indexOf("?")==-1){a=a+"?";}else{a=a+"&";}return a;},getHotelName:function(){return this.get("hotelName");},getTruncatedHotelName:function(b){var a=this.get("hotelName");if(a.length>35){a=a.substring(0,35).split(" ").slice(0,-1).join(" ")+"...";}return a;},getImageUrl:function(b){var a=this.get("imageUrl");if(a){a=a.replace(/http(s)*:\/\/media.(travelocitycustomercare|expedia).com/g,"//images.trvl-media.com").replace("_t.jpg","_l.jpg").replace("http:","https:");}return a;},getDestinationImageUrl:function(){var b="//images.trvl-media.com/media/content/expuk/Images/deals/destinations/w456/",c="//images.trvl-media.com/media/content/expuk/Images/deals/destinations/w456/default.jpg",a=this.getHotelCity();if(typeof a=="string"&&a!=""){a=a.replace(/ /g,"");a=a.toLowerCase();return b+a+".jpg";}else{return c;}},getImageUrl_t:function(){return this.get("hotelImageUrl");},getLengthOfStay:function(){return this.get("lengthOfStay");},getPackageSavings:function(){return Math.round(this.get("perPsgrSavings"));},getStarRating:function(){return this.get("starRating");},getStarRatingClass:function(){var a=this.get("starRating");if(a>0){return a.replace(".","-");}},getVipAccess:function(){return this.get("vipAccess");},getGuestRating:function(){var a=this.get("guestRating");if(a>0){return a.toFixed(1);}},getReviewTotal:function(){return this.get("reviewTotal");},getCheckInDate:function(){return this.get("startDate");},getCheckOutDate:function(){return this.get("endDate");},getHotelPromotionDescription:function(){return this.get("hotelPromotionDescription");},getPackagePromotionDescription:function(){return this.get("packagePromotionDescription");},getNumberOfPeopleViewing:function(){return this.get("numberViewing");},getCarrierCode:function(){return this.get("flightDealCarrier");},getAlmostSold:function(){return this.get("almostSoldStatus");}});var GMTFlightModel=Backbone.Model.extend({initialize:function(){_.bindAll(this,"getIndex","getSecIndex","getSubSecIndex","getDealsRfrr","getOriginCity","getDestinationCity","getPrice","getTotalPrice","getTripType","getDealDeepLink","getDepartureAirport","getDestinationAirport","getCheckInDate","getCheckOutDate","getCarrierCode","getFlightDealCarrierName","getRegionID","getFlightImage");},getFlightImage:function(){return this.get("showFlightImage");},getRegionID:function(){return this.get("regionID");},getIndex:function(){return this.get("index");},getSecIndex:function(){return this.get("secIndex");},getSubSecIndex:function(){return this.get("subSecIndex");},getDealsRfrr:function(){return this.get("dealsRfrr");
},getOriginCity:function(){return this.get("originCity");},getDestinationCity:function(){return this.get("destCity");},getPrice:function(){return Math.round(this.get("flightPerPsgrBaseFarePlusTax"));},getTotalPrice:function(){return Math.round(this.get("flightPerPsgrTotalPrice"));},getTripType:function(){return this.get("tripType");},getDealDeepLink:function(){var a=unescape(this.get("flightSearchUrl"));if(a.indexOf("?")==-1){a=a+"?";}else{a=a+"&";}return a;},getDepartureAirport:function(){return this.get("originTla");},getDestinationAirport:function(){return this.get("destTla");},getCheckInDate:function(){return this.get("startDate");},getCheckOutDate:function(){return this.get("endDate");},getCarrierCode:function(){return this.get("flightDealCarrier");},getFlightDealCarrierName:function(){return this.get("flightDealCarrierName");}});var GMTCruiseModel=Backbone.Model.extend({initialize:function(){_.bindAll(this,"getIndex","getSecIndex","getSubSecIndex","getDealsRfrr","getDealDeepLink","getTravelStartDate","gettravelEndDate","getDisembarkationPort","getEmbarkationPort","getCountry","getLengthOfStay","getcruiseLineLogo","getCruiseLine","getDestination","getCruiseLowPrice","getPercentSavings","getPrice");},getIndex:function(){return this.get("index");},getSecIndex:function(){return this.get("secIndex");},getSubSecIndex:function(){return this.get("subSecIndex");},getDealsRfrr:function(){return this.get("dealsRfrr");},getDealDeepLink:function(){var a=this.get("dealDeepLink");if(window.location.hostname.indexOf("www.expedia-aarp.com")!=-1||window.location.hostname.indexOf("wwwexpedia-aarpcom")!=-1){a=a.replace("cruise.expedia.com","cruise.expedia-aarp.com?");}return a;},getTravelStartDate:function(){return this.get("travelStartDate").toString();},gettravelEndDate:function(){return this.get("travelEndDate");},getDisembarkationPort:function(){if(typeof this.get("disembarkationPort")!="undefined"){return this.get("disembarkationPort");}},getEmbarkationPort:function(){if(typeof this.get("embarkationPort")!="undefined"){return this.get("embarkationPort");}},getCountry:function(){return this.get("country");},getLengthOfStay:function(){return this.get("lengthOfStay");},getCruiseLine:function(){return this.get("cruiseLine");},getcruiseLineLogo:function(){return this.get("cruiseLineLogo");},getDestination:function(){return this.get("destination");},getPrice:function(){return this.getCruiseLowPrice();},getCruiseLowPrice:function(){return this.get("cruisePrice");},getPercentSavings:function(){return this.get("percentSavings");}});var GMTCarModel=Backbone.Model.extend({initialize:function(){_.bindAll(this,"getIndex","getSecIndex","getSubSecIndex","getDealsRfrr","getDestinationCity","getTotalPrice","getDealDeepLink","getCheckInDate","getCheckOutDate","getSupplierLogo","getSupplierName","getLengthOfStay");},getIndex:function(){return this.get("index");},getSecIndex:function(){return this.get("secIndex");},getSubSecIndex:function(){return this.get("subSecIndex");},getDealsRfrr:function(){return this.get("dealsRfrr");},getDestinationCity:function(){return this.get("destCity");},getTotalPrice:function(){return Math.round(this.get("carTotalPrice"));},getPrice:function(){return Math.round(this.get("carTotalPrice"));},getDealDeepLink:function(){var a=this.get("carSearchUrl");if(a.indexOf("?")==-1){a=a+"?";}else{a=a+"&";}return a;},getCheckInDate:function(){return this.get("startDate");},getCheckOutDate:function(){return this.get("endDate");},getSupplierLogo:function(){var a=this.get("carSupplierName");return(a&&a!="")?"//images.trvl-media.com/cars/logos/"+a+".png":"/static/default/default/images/car/car_icon.png";},getSupplierName:function(){return this.get("carSupplierName");},getLengthOfStay:function(){var a=parseInt(this.get("lengthOfStay"));if(typeof a=="number"&&a>0){return a;}else{return 0;}}});var GMTFlightCarModel=Backbone.Model.extend({initialize:function(){_.bindAll(this,"getIndex","getSecIndex","getSubSecIndex","getDealsRfrr","getOriginCity","getDestinationCity","getPrice","getTotalPrice","getTripType","getDealDeepLink","getDepartureAirport","getDestinationAirport","getCheckInDate","getCheckOutDate","getCarrierCode","getLengthOfStay");},getIndex:function(){return this.get("index");},getSecIndex:function(){return this.get("secIndex");},getSubSecIndex:function(){return this.get("subSecIndex");},getDealsRfrr:function(){return this.get("dealsRfrr");},getOriginCity:function(){return this.get("originCity");},getDestinationCity:function(){return this.get("destCity");},getPrice:function(){return Math.round(this.get("perPsgrPackagePrice"));},getTotalPrice:function(){return Math.round(this.get("perPsgrPackagePrice"));},getTripType:function(){return this.get("tripType");},getDealDeepLink:function(){var a=this.get("packageSearchUrl");if(a.indexOf("?")==-1){a=a+"?";}else{a=a+"&";}return a;},getDepartureAirport:function(){return this.get("originTla");},getDestinationAirport:function(){return this.get("destTla");},getCheckInDate:function(){return this.get("startDate");},getCheckOutDate:function(){return this.get("endDate");},getCarrierCode:function(){return this.get("flightDealCarrier");},getLengthOfStay:function(){return this.get("lengthOfStay");}});var GMTHotelCarModel=Backbone.Model.extend({initialize:function(){_.bindAll(this,"getIndex","getSecIndex","getSubSecIndex","getDealsRfrr","getDealDeepLink","getSimilarDeepLink","getHotelId","getHotelName","getTruncatedHotelName","getCheckInDate","getCheckOutDate","getTla","getCity","getHotelCity","getProvince","getCountry","getImageUrl","getDestinationImageUrl","getThumbnailUrl","getStarRating","getStarRatingClass","getGuestRating","getReviewTotal","getTotalPrice","getAveragePrice","getPrice","getCrossOutPrice","getPercentSavings","getNumberOfPeopleViewing","getPromotionDescription","getLengthOfStay");},getIndex:function(){return this.get("index");},getSecIndex:function(){return this.get("secIndex");},getSubSecIndex:function(){return this.get("subSecIndex");},getDealsRfrr:function(){return this.get("dealsRfrr");},getDealDeepLink:function(){var a=this.get("packageSearchUrl");if(a.indexOf("?")==-1){a=a+"?";}else{a=a+"&";}return a;},getSimilarDeepLink:function(){var a=this.get("hotelSearchResultUrl");if(a.indexOf("?")==-1){a=a+"?";}else{a=a+"&";}return a;},getHotelId:function(){return this.get("hotelId");},getHotelName:function(){return this.get("hotelName");},getTruncatedHotelName:function(){var a=this.get("hotelName");if(a.length>35){a=a.substring(0,35).split(" ").slice(0,-1).join(" ")+"...";}return a;},getCheckInDate:function(){return this.get("startDate");},getCheckOutDate:function(){return this.get("endDate");},getTla:function(){return this.get("tla");},getCity:function(){if(typeof this.get("city")!="undefined"){return this.get("city");}if(typeof this.get("shortName")!="undefined"){return this.get("shortName");}},getHotelCity:function(){return this.get("hotelCity");},getProvince:function(){return this.get("province");},getCountry:function(){return this.get("country");},getImageUrl:function(){var a=this.get("imageUrl");if(a){a=a.replace(/http(s)*:\/\/media.(travelocitycustomercare|expedia).com/g,"//images.trvl-media.com").replace("_t.jpg","_l.jpg").replace("http:","https:");}return a;},getDestinationImageUrl:function(){var b="//images.trvl-media.com/media/content/expuk/Images/deals/destinations/w456/",c="//images.trvl-media.com/media/content/expuk/Images/deals/destinations/w456/default.jpg",a=this.getHotelCity();if(typeof a=="string"&&a!=""){a=a.replace(/ /g,"");a=a.toLowerCase();return b+a+".jpg";}else{return c;}},getThumbnailUrl:function(){return this.get("imageUrl");},getStarRating:function(){return this.get("starRating");},getStarRatingClass:function(){var a=this.get("starRating");if(a>0){return a.replace(".","-");}},getGuestRating:function(){var a=this.get("guestRating");if(a>0){return a.toFixed(1);}},getReviewTotal:function(){return this.get("reviewTotal");},getTotalPrice:function(){return Math.round(this.get("totalPrice"));
},getAveragePrice:function(){return Math.round(this.get("averagePrice"));},getPrice:function(){return Math.round(this.get("price"));},getCrossOutPrice:function(){return this.get("crossOutPrice");},getPercentSavings:function(){return this.get("percentSavings");},getNumberOfPeopleViewing:function(){return this.get("numberViewing");},getPromotionDescription:function(){return this.get("promotionDescription");},getLengthOfStay:function(){return this.get("lengthOfStay");}});var GMTActivityModel=Backbone.Model.extend({initialize:function(){_.bindAll(this,"getIndex","getSecIndex","getSubSecIndex","getDealsRfrr","getDealDeepLink","getDestinationCity","getActivityPrice","getActivityTotalPrice","getDealDeepLink","getActivityImageLogo","getActivityTitle","getActivityDiscountPercentage","getActivityDuration","getActivitySupplierName","getActivityStartDate","getActivityEndDate","isfreeCancellable","getDiscount","getActivityDiscountValue","getActivityLargeImage");},getIndex:function(){return this.get("index");},getSecIndex:function(){return this.get("secIndex");},getSubSecIndex:function(){return this.get("subSecIndex");},getDealsRfrr:function(){return this.get("dealsRfrr");},getDestinationCity:function(){return this.get("destCity");},getActivityTitle:function(){return this.get("activityTitle");},getActivityPriceLabel:function(){return this.get("activityPriceLabel");},getActivityPrice:function(){return this.get("activityPrice");},getDealDeepLink:function(){var a=this.get("activitySearchUrl");if(a.indexOf("?")==-1){a=a+"?";}else{a=a+"&";}return a;},getActivityImageLogo:function(){var a=this.get("activityImageLogo");return a;},getActivityDiscountPercentage:function(){return this.get("activityDiscountPercentage");},getActivityTotalPrice:function(){return this.get("activityTotalPrice");},getActivityDuration:function(){return this.get("activityDuration");},getActivitySupplierName:function(){return this.get("activitySupplierName");},getActivityStartDate:function(){return this.get("activityStartDate");},getActivityEndDate:function(){return this.get("activityEndDate");},isfreeCancellable:function(){return this.get("freeCancellable");},getDiscount:function(){return this.get("discount");},getActivityDiscountValue:function(){return this.get("activityDiscountValue");},getActivityLargeImage:function(){return this.get("activityLargeImage");}});var GMTGroupedByDestinationModel=Backbone.Model.extend({initialize:function(){_.bindAll(this,"initialize","getHotelId","getCity","getSimilarDeepLink","getHotelCity","getDestinationImageUrl","getDestinationRank","getHotelTotalPrice","getHotelAveragePrice","getHotelPrice","getHotelCrossOutPriceValue","getPackageTotalPrice","getPackageCrossoutPricePerPerson","getHotelPercentSavings","getPackagePrice","getPackageDealDeepLink","getPackageLengthOfStay","getPackageCheckInDate","getPackageCheckOutDate","getHotelCheckInDate","getHotelCheckOutDate","getSource","hasPackage","hasHotel","hasFlight","getFlightPrice","getFlightTripStartDate","getFlightTripEndDate","getFlightDepartureAirport","getFlightDestinationAirport","getFlightSearchUrl","getTripType","getDealsRfrr","getIndex","getRegionId","getOriginCity","getOriginCountry","getOriginLongName","getOriginMetrocode","getOriginProvince","getOriginRegionID");},getHotelId:function(){return this.get("hotelId");},getCity:function(){if(typeof this.get("city")!="undefined"){return this.get("city");}else{return"";}},getPackageCheckInDate:function(){return this.get("packageStartDate");},getPackageCheckOutDate:function(){return this.get("packageEndDate");},getHotelCheckInDate:function(){return this.get("hotelStartDate");},getHotelCheckOutDate:function(){return this.get("hotelEndDate");},getFlightPrice:function(){return Math.round(this.get("flightPerPsgrBaseFarePlusTax"));},getFlightTripStartDate:function(){return this.get("flightStartDate");},getFlightTripEndDate:function(){return this.get("flightEndDate");},getTripType:function(){return this.get("flightTripType");},getFlightDepartureAirport:function(){return this.get("flightDepartureAirport");},getFlightDestinationAirport:function(){return this.get("flightDestinationAirport");},getFlightSearchUrl:function(){var a=unescape(this.get("flightSearchUrl"));if(a.indexOf("?")==-1){a=a+"?";}else{a=a+"&";}return a;},getSimilarDeepLink:function(){var a=this.get("hotelSearchResultUrl");if(a.indexOf("?")==-1){a=a+"?";}else{a=a+"&";}if(a.indexOf("www.expedia.cn")!=-1){a=a.replace("www.expedia.cn",window.location.hostname);}return a;},getHotelCity:function(){return this.get("hotelCity");},getDestinationImageUrl:function(){var c="//images.trvl-media.com/media/content/expuk/Images/deals/destinations/w456/",d="//images.trvl-media.com/media/content/expuk/Images/deals/destinations/w456/default.jpg",b=this.get("nonLocalizedCity");if(typeof b=="string"&&b!=""){if(b.indexOf("(")!=-1){var a=b.indexOf("(")-1;b=b.substring(0,a);}else{b=b.replace(/ /g,"");b=b.toLowerCase();}return c+b+"_a.jpg";}else{return d;}},getDestinationRank:function(){return this.get("rank");},getHotelTotalPrice:function(){return Math.round(this.get("hotelTotalPrice"));},getHotelAveragePrice:function(){return Math.round(this.get("hotelAveragePrice"));},getHotelPercentSavings:function(){return Math.floor(this.get("hotelPercentSavings"));},getHotelPrice:function(){return Math.round(this.get("hotelPrice"));},getHotelCrossOutPriceValue:function(){return Math.round(this.get("hotelCrossOutPriceValue"));},getPackageTotalPrice:function(){return Math.round(this.get("packageTotalPrice"));},getPackagePrice:function(){return Math.round(this.get("perPsgrPackagePrice"));},getPackageCrossoutPricePerPerson:function(){return Math.round(this.get("perPsgrPackagePrice")+this.get("packagePerPsgrSavings"));},getPackageDealDeepLink:function(){var a=unescape(this.get("packageSearchUrl"));if(a.indexOf("?")==-1){a=a+"?";}else{a=a+"&";}return a;},getPackageLengthOfStay:function(){return this.get("packageLengthOfStay");},getSource:function(){return this.get("source");},hasPackage:function(){return this.get("hasPackage");},hasHotel:function(){return this.get("hasHotel");},hasFlight:function(){return this.get("hasFlight");},getDealsRfrr:function(){return this.get("dealsRfrr");},getIndex:function(){return this.get("index");},getRegionId:function(){return this.get("regionID");},getOriginCity:function(){return this.get("originCity");},getOriginCountry:function(){return this.get("originCountry");},getOriginLongName:function(){return this.get("originLongName");},getOriginMetrocode:function(){return this.get("originMetrocode");},getOriginProvince:function(){return this.get("originProvince");},getOriginRegionID:function(){return this.get("originRegionID");}});var ThreePPWiz=function(a){var b=this;b.rfrr=a.rfrr;b.debug=(a.jsDebug=="true")?true:false;b.host=window.location.host;b.oldIE=$("html").hasClass("lt-ie9")?true:false;b.DOMC={};b.tpl={};b.dateFormat=a.dateFormat;b.numberOfRooms=parseInt(a.numberOfRooms);b.numberOfAdults=a.numberOfAdults;b.numberOfChildren=parseInt(a.numberOfChildren);b.defaultLob=a.defaultLob?a.defaultLob:"packages";b.nativeValidation=$("html").hasClass("formvalidation")?true:false;b.regionMappings={"100000":"35;434;350;345;56;832;616;351;614;353","100001":"854;2068;849;373;178;794;697;495;853;560","100002":"627;32;35;630;2507;4118","100003":"2090;4125;2251;2505;59;832;670;345;50;675;676;56","100004":"99;2521;434;652;648;646;373;644;651;647;542;4108;2511;643;526;2511;2281;2280;946","100005":"350;348;349;330;4144;2204;351;2500;4045;2202","100006":"558;387;549;391;547;527;383;491;535;399;552;403;15;396;6;7;616;395;402;8;823;9;393;540;392;401;546;655;2214;4020;2215;388;4023;2217;4022;4024;11;12;13;404;390;16;554;389;2516;14;4117","100007":"18;534;553;4104;733;382;734;4103;625;277;2152;2214","100008":"132;136;133;614;131;134;135;959","100009":"354;724;884;353;722;723;2273;352;725;2164;532;720;4119;721","100010":"2237;125;705;126;482","100011":"156;2068;2014;64;2013;61;62;2054;63;229;65;794;505;793;2253;4055","100012":"339;637;664;636;457;695;494;338;674;639;667;467;2246;2244;2529","100013":"595;2235","100014":"620;99;2276","100015":"891;2003;845;464;291;79;2046;80;81;297;2048;75;2047;536;818;296;295;76;2012;560;78;77;844;537;817;82;3005;4146;2513;2133;2278;2222;2159","100016":"3014;501;500;507;483;4010;504;480;877;301;2011;302;635;2231","100017":"103;539;102;2206","100018":"366;367;368;2149","100019":"321;325;322;323;327;846;4133;4128;4129;2535;4132;4131;4130;2257","100020":"592;311;871;470;528;2110","100021":"361;948","100022":"592;311;871;470;528;469;843;863;864;847;425;645;461;314;681;683;473;361;492;489;862;448;2110;2146;2570;2553;948;4150;2257;2144;321;325;322;323;327;846;4133;4129;4128;2535;4131;4132;4130;2527;2128;2551;1026;4122;4014","100023":"342","100024":"143;163;162;719;4145;4126;2562;2559","100025":"225;511;509;510;727;515;979;812;2136;2080;2163","100026":"174;358;359;2229","100027":"280;589;591;585;586;588;590;587","100028":"881;4109;878;883;873;882;876;875;879;2115","100029":"453;2541","100030":"4147;174;358;359;859;453;4116;938;139;593;454;4105;4112;866;881;4109;878;883;873;882;876;875;879;2115;2549;2075;2229;2541;2525","100031":"704;541;2241;282;2242","100032":"247;2226","100033":"4098;378;519;574;680;250;566;447;568;245;437;581;582;583;366;367;368;377;572;247;561;571;4110;251;578;249;746;747;2149;4143;2226;440","100034":"4121;4029;841;781;484;943;753;521;523;522;757;427;431;432;428;429;430;779;759;774;688;694;941;756;762;778;772;769;692;886;782;754;697;776;811;771;760;524;758;2560;775;777;773;755;752;780;761;763;770","100035":"767;768;792;809;814;896;790;766;815;765;791;810;2548;4121","100036":"4100;563;4114;441;443;701;438;704;541;2241;282;445;446;2208;2242;2569","100037":"376;787;4142;785;293;2546;4042;4017;4120;2556;2557;2543;450;788;286;374;375;784;783","100038":"2026;104;2058;2025;2069;106;2028;2078;107;112;2501;2019;2052;2051;2037;2050;2030;2060;113;2031;114;2072;4111;2061;2032;2033;2020;2071;2024;2035;115;2034;2062;264;2074;2063;116;127;117;2036;2008;105;2039;2053;3001;2022;2065;118;2029;2059;119;121;123;2038;4102;2002;2066;2070;2021;128;2067;4124;4046;2282","100039":"4190;950;951;952;953;954;2007;2006;955;956;2018;1003;2001;2005;2009;2004;2010;806;957;958;2282;2248","100040":"913;915;916;917;918;920;922;925;927;807;928;926;930;932;933;934;936","100041":"25;2040;2017;2055;2041;2043;200;2042;23;2057;1025;4127;24;1023;495;2056;2213;2514","100042":"855;856;854;2554","100043":"900;962;178;179;905;901;177;503","100044":"902;4099;490;2547;813;851;977;449","100045":"2016;849;2282;4025;4015;4140;2150;3008;4107;833;838;837;836;316;909;835;455;852;816;110;892;893;820;819;821;850;628;497;853;751;834","100046":"1026;4122;4124;4046;2282;4117;4126;4014;2149;4006;4010;4005;4001;4140;4000;4123;2090;4125;4118;4120;2281;2280;4121;4119;4045;2202","100047":"2075;2527;2545;2546;2165;2206;2128;2208;4037;4042;2213;2214;4020;2215;388;4023;2217;4022;4024;2551;2110;4027;2167;2513;2133;2278;2222;2159;2226;2146;2136;2548;2229;2231;2559;4025;2570;2235;2237;2562;2242;2553;2080;2541;2164;4017;2558;2246;2244;2529;4015;2150;2525;2253;2251;2505;2507;4055;948;2115;2556;2163;2549;2257;3008;4021;959;946;2557;2569;4029;4028;2273;2543;2144;2276;2204;2243","100048":"990;2550;2161;2085;2143;2166;2112;4016;2116;2120;2113;2536;2530;2114;2567;2162;2073;506;2157;2140;2102;2126;2103;4101;2141;4040;2100;2088;2239;2170;4106;2127;2094;2147;2528;2148;2121;2156;2108;2284;2160;2095;2098;2118;2101;2106;2107;2523;60;2104;2086;4041;2145;2093;2279;2099;2119;947;2153;2154;2531;4009;4056;2142;4115;2097;4002;2134","100049":"4065;4095;4090;4083;4070;4085;4097;4096;4084;4068;4088;4078;4076;4079;4080;4057;4059;4073;4074;4082;4113;4060;4061;4062;4064;4066;4067;4071;4072;4075;4077;4093;4089;4069;4086;4091;4058;4063;4081;4087;4092","100050":"4134;4135;4136;4138;4137","100051":"854;18;2068;915;106;112;855;849;503;2019;901;918;113;373;348;2020;902;692;674;178;794;521;820;264;76;697;2055;524;495;853;836;560;954;821;851;838;958;936","100052":"","100053":"","100054":"","100055":"676;2505;4125","100056":"35;2507;4118","100057":"639;2244","100058":"2090;4125;56;50;59","100059":"434;644;643","100060":"652;648;646;651;647"};
b.init();};ThreePPWiz.prototype.init=function(){var a=this;a.getDOMC();a.bindEvents();};ThreePPWiz.prototype.getDOMC=function(c){var b=this,a=$("#threepp-form-search");b.DOMC={wiz:a,wizSearchBtn:a.find(".threePPFrmSubmitBtn"),wizShowOptions:a.find("a.show-options"),wizThreeppInput:{tab:a.find("#tab-threepp"),section:a.find("#section-threepp"),to:a.find("#threepp-destination"),departDate:a.find("#threepp-from-date"),returnDate:a.find("#threepp-to-date"),opts:a.find("#threepp-options"),showOptions:a.find("#threepp-show-options")}};if(typeof c=="function"){c();}};ThreePPWiz.prototype.bindEvents=function(){var a=this;a.DOMC.wizShowOptions.off("touchstart click").on("touchstart click",function(c){c.preventDefault();var b=$(this);if(typeof b.attr("data-icon-html")!="string"){b.attr("data-icon-html",b.children(".icon").clone().wrap("<div/>").parent().html().replace(/"/g,"'"));}if(a.DOMC.wizThreeppInput.opts.is(":visible")){a.DOMC.wizThreeppInput.opts.hide();a.DOMC.wizShowOptions.html(b.attr("data-show-txt")+b.attr("data-icon-html"));a.DOMC.wizShowOptions.removeClass("rotate-icon");}else{a.DOMC.wizThreeppInput.opts.show();a.DOMC.wizShowOptions.html(b.attr("data-hide-txt")+b.attr("data-icon-html"));a.DOMC.wizShowOptions.addClass("rotate-icon");}});a.DOMC.wizSearchBtn.off("touchstart click").on("touchstart click",function(k){var b=$("fieldset:visible"),l="",p,m=$("#threepp-from-date").val(),j=$("#threepp-to-date").val(),o=$("select[name='threepp.origin']").find("option:selected").val(),n=$("select[name='threepp.destination']").find("option:selected").val(),h=$("select[name='threepp.duration']").find("option:selected").val(),g=$("select[name='threepp.rooms.0.adults']").find("option:selected").val(),f=$("select[name='threepp.rooms.0.children.0.age']").find("option:selected").val(),i=$("select[name='threepp.rooms.0.children.1.age']").find("option:selected").val(),c=$("select[name='threepp.rooms.0.children.2.age']").find("option:selected").val(),d=a.regionMappings[n]?a.regionMappings[n]:"";k.preventDefault();p=setTimeout(function(){l="http://booking.expedia.de/booking/exp/ibe/index.php?"+"GOTO=TTPauschalreisen&lnkloc=lmn_1&lnkcid=100&tab=lmn&showresult=1&StrWizTag=TT_HolidayHome&frbuch=&"+"KID=360010&"+"agent=&org_tla=&formular=2&sortierung=&detail=zielgebiet&rliste=2&zfilter=&backon=1&hostexp=&wzdf=&wzid=&"+"termin="+m+"&ruecktermin="+j+"&abflughafen="+o+"&dauer="+h+"&topRegionenCache="+n+"&topRegionen="+d+"&zimmer=-1&erwachsene="+g+"&alter1="+f+"&alter2="+i+"&alter3="+c+"&alter4=-1&alter5=-1&alter6=-1&alter7=-1&alter8=-1&hbfges=0&hbfanz=0&hbfempf=0&kategorie=-1&shotel=&typ=-1&preis=-1&verpflegung=-1&sportangebot=-1&marke=-1&"+"wizardSubmit.x=23&wizardSubmit.y=4";window.location.href=l;},200);});};(function(b,d){var c=false;if(typeof $(".loyalty-module").length!=="undefined"&&$(".loyalty-module").length>0){c=true;}else{if(typeof $("#loyalty-module").length!=="undefined"&&$("#loyalty-module").length>0){c=true;}}if(c){if(e(b)){b.GMT.LOYALTY=b.LOYALTY||{};b.GMT.LOYALTY.offer=a(b.jQuery);}else{b.LOYALTY=b.LOYALTY||{};b.LOYALTY.offer=a(b.jQuery);}}function a(i){function f(j){if(j){for(var k in j){this[k]=j[k];}}}f.prototype={"isRegistered":false,"hasErrors":true,"errorName":"","errorMessage":"Invalid response"};function h(j,k){i.ajax({type:"POST",data:{offerId:j},cache:false,url:"/loyalty/registerOffer",dataType:"json",success:function(l){k(new f(l));},error:function(){k(new f());}});}function g(j,k){i.ajax({type:"GET",data:{offerId:j},cache:false,url:"/loyalty/isRegisteredInOffer",dataType:"json",success:function(l){k(new f(l));},error:function(){k(new f());}});}return{registerInOffer:h,isRegisteredInOffer:g};}function e(f){return typeof f.GMT==="object"&&f.GMT;}})(window);var LOYALTY=(typeof GMT!=="undefined")?GMT.LOYALTY:window.LOYALTY;function LoyaltyRewardsModule(){var i={offerName:"",offerId:"",enrollInOffer:"",offersPerGroupAllowed:1,showClass:".enroll-success-message",hideClass:".cta-message",hideSuccess:".enroll-offer",hideCtaOnSuccess:false,showSuccessMessage:false,domModule:null,groupName:1,groupClassName:"",multipleOffersPerGroupAllowed:false},e=function(j){if(j.offerName&&j.offerId&&j.domModule&&(LOYALTY!==null&&typeof LOYALTY==="object")){i.offerName=j.offerName;i.offerId=j.offerId;i.domModule=j.domModule;i.multipleOffersPerGroupAllowed=j.multipleOffersPerGroupAllowed;i.groupName=j.groupName;i.groupClassName="."+j.groupClassName;if(j.hideClass){i.hideClass=j.hideClass;}if(j.hideCtaOnSuccess){i.hideCtaOnSuccess=Boolean(j.hideCtaOnSuccess);}if(j.showSuccessMessage){i.showSuccessMessage=Boolean(j.showSuccessMessage);}$(j.domModule).find("#enroll-offer").click(function(){f();});$(j.domModule).find(".enroll-offer").click(function(){f();});LOYALTY.offer.isRegisteredInOffer(i.offerId,b);}else{console.log("Module not enabled. Loyalty might not be loaded, or missing parameters.");}},f=function(){LOYALTY.offer.registerInOffer(i.offerId,h);},h=function(k){if(k.hasErrors){var m=window.location.pathname,n=window.location.search,j,l;if(n.indexOf("?")>-1){n=n+"&";}switch(k.errorName){case"USER_UNAUTHENTICATED":j="/user/login?selc=1&loyaltyRewardsEnrollSignin=true&uurl=";l=j+encodeURIComponent("qscr=redr&rurl="+m+n+"?offerName="+i.offerName);window.location.replace(l);break;case"USER_NOT_REWARDS_MEMBER":j="/user/login?loyaltyRewardsEnrollSignin=true&uurl=";l=j+encodeURIComponent("qscr=redr&rurl="+m+n+"?offerName="+i.offerName);window.location.replace(l);break;case"USER_CURRENTLY_REGISTERED":g(i.groupName);a(i.offerName);c(i.offerName);break;case"OFFER_REGISTER_FAILED":case"INVALID_USER_INPUT":case"SERVICE_ERROR":break;default:}}else{g(i.groupName);a(i.offerName);c(i.offerName);}},g=function(j){if(groupStatus.hasOwnProperty(j)&&groupStatus[j].hasOwnProperty("numberOffersRegistered")){groupStatus[j].numberOffersRegistered++;}},d=function(){$(".all-offers-met").removeClass("hidden");$(".show-all-groups-complete").removeClass("hidden");$(".hide-group").addClass("hidden");window.scrollTo(0,0);Object.keys(groupStatus).forEach(function(k){var j=groupStatus[k].offerName;$("."+j).removeClass("hidden");});},a=function(k){var j=true;if(groupStatus.hasOwnProperty(i.groupName)&&groupStatus[i.groupName].hasOwnProperty("numberOffersRegistered")){if(groupStatus[i.groupName].numberOffersRegistered>=groupStatus[i.groupName].maxNumberOffers){groupStatus[i.groupName].groupComplete=true;groupStatus[i.groupName].offerName=k;}Object.keys(groupStatus).forEach(function(l){if(groupStatus[l].groupComplete!==true){j=false;}});}if(j){d();}},c=function(k){var j="";if(groupStatus.hasOwnProperty(i.groupName)){j=groupStatus[i.groupName].offerName;}if(!i.multipleOffersPerGroupAllowed){$(i.groupClassName).each(function(m,o){var n=false,l=$(o).attr("data-offername");n=(l==k);if(i.showSuccessMessage){$(o).find(i.showClass).removeClass("hidden");}if(i.hideCtaOnSuccess){$(o).find(i.hideClass).addClass("hidden");$(o).find(i.hideSuccess).addClass("hidden");}if(n){$(o).find(".success-message-selected").removeClass("hidden");}else{$(o).find(".success-message-not-selected").removeClass("hidden");}});}else{if(i.showSuccessMessage){$(i.domModule).find(i.showClass).removeClass("hidden");}if(i.hideCtaOnSuccess){$(i.domModule).find(i.hideClass).addClass("hidden");$(i.domModule).find(i.hideSuccess).addClass("hidden");}}},b=function(j){if(j.hasErrors){switch(j.errorName){case"USER_UNAUTHENTICATED":case"REWARDS_NOT_ENABLED":case"USER_NOT_REWARDS_MEMBER":case"SERVICE_ERROR":break;default:}}else{if(j.isRegistered){g(i.groupName);a(i.offerName);c(i.offerName);}else{if(!j.isRegistered&&(window.location.search.indexOf(i.offerName)>-1)){f();}}}};return{init:e,options:i};}$(document).ready(function(){var b=[];var d=window.loyaltyModules=[];var c=window.groupStatus={};var a="#loyalty-module";if(typeof $(a).length!=="undefined"&&$(a).length==0){a=".loyalty-module";}$(a).each(function(k,e){d[k]=$(e);var h,j,l,o,p,g,m,n;if($(d[k]).attr("data-offerid")){h=d[k].attr("data-offerid");p=d[k].attr("data-collection_group")?d[k].attr("data-collection_group"):1;
n=(typeof d[k].attr("data-multiple_offers_per_group_allowed")!=="undefined"&&d[k].attr("data-multiple_offers_per_group_allowed")=="true");j=d[k].attr("data-offername")?d[k].attr("data-offername"):d[k].attr("data-offerid");l=d[k].attr("data-hide_cta_success")?d[k].attr("data-hide_cta_success"):false;o=d[k].attr("data-show_success_message")?d[k].attr("data-show_success_message"):false;g="offer-group-"+p;d[k].addClass(g);var f=new LoyaltyRewardsModule();c[p]={numberOffersRegistered:0,maxNumberOffers:1,groupComplete:false,offerName:null};f.init({offerId:h,offerName:j,hideCtaOnSuccess:l,showSuccessMessage:o,domModule:e,groupName:p,multipleOffersPerGroupAllowed:n,groupClassName:g});b.push(f);}else{console.log("Module missing data-offerid");}});window.LoadedLoyaltyModules=b;});require("isLoggedInGMT",function(a){if(!a.status){$("div.memberDeals").addClass("show");}});require(["jquery","dctk","isLoggedInGMT","coreGMT"],function(c,a,d,b){if(!d.status&&GMT.pageId!="rfd"&&GMT.options.isMobilePhone===false&&(GMT.brand.isExp||GMT.brand.isLM||GMT.brand.isWOT)){require(["gmtMemberSignup"],function(e){e.init();});}});require(["groui","uitk_domReady"],function(a,b){a.init();});GMT.Events.on("GMT.deals.init.queue",function(a){GMT.Events.on("GMT.deals.module.view.ready",function(b){if((GMT.pageId=="rfd"||GMT.pageId=="rfd-60")&&($("#rotatingAd").length>0)){if((!GMT.abacus.hasOwnProperty("ab10692"))||(GMT.abacus.hasOwnProperty("ab10692")&&(GMT.abacus.ab10692==0||GMT.abacus.ab10692==1))){require(["destinationRotator"],function(c){c.init(b);});}}if((GMT.pageId==="dailydeals"||GMT.utils.isTestActive("10624"))&&GMT.siteid!=="7"){require(["dealsFromScratchpad"],function(c){c.init(b);});}});});var gmtIsTestActive=GMT.utils.isTestActive;require(["coreGMT","progTools"],function(a,b){if((GMT.siteid==="3"&&GMT.locale==="en_GB"&&GMT.pageName==="page.Global-Merch.cat.beach")||(GMT.siteid==="1"&&GMT.locale==="en_US"&&GMT.pageName==="page.partner.ms-theme-beach")){require(["dctk"],function(c){c.onReady(function(){c.evaluateExperimentAndLog({id:13995,callback:function(d){if(typeof d.value!=="undefined"){if(d.value==1){window.location="/g/s2/beachcollection";}else{$("#wizard-footer, #siteContent, .header-wrapper, .site-content").css({"visibility":"visible","display":"block"});}}}});});});}if(GMT.pgm.brandcid!==""){b.track(GMT.pgm.brandcid);}});require(["jquery","dctk","coreGMT","GMT-Localized-Content"],function(b,c,e,d){function h(k){var j;b(k).each(function(){j=b(this).children();if(j.length<=0){b(this).addClass("collapse");}});}if(GMT.isDealsLP=="true"){var g=b("div#promo-deals-module-0-1-title-wrapper"),f=g.children();if(f.length<=0){g.append('<h2 id="promo-deals-module-0-1-title" class="uitk-header">'+d.destDealsHdr+"</h2>");}if(gmtIsTestActive("25012")){require(["ab25012"],function(j){j.init();});}else{var i=b("#promo-deals-module-0-0-Hotel"),a=i.attr("data-url");if(/dealsLPpreview=MOD/i.test(a)){i.addClass("hidden");}}}if(gmtIsTestActive("16061")&&GMT.abacus.ab16061=="1"){require(["ab16061"]);}});GMT.Events.on("GMT.deals.init.queue",function(a){GMT.Events.on("GMT.deals.module.view.ready",function(b){if(GMT.pageId=="flashsale"){require(["aftersale-deals"],function(c){c.init(b);});}});});
/*!  generated on 2018-05-14 10:34:42.098 PDT(-0700) in 68 ms  */

/*!  served in 15 ms  */
